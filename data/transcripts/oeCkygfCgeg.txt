has been working on so let me just say quickly a few words so bill joined the department and my good over a year ago you know he has two masters degrees actually one in computer science and one in biostatistics and he's a yoga graduate and so when yeah and so he was working with my banking master's degree and some time after that then he took a brief detour where he went to develop software for healthcare medical records electronic major medical records and then very fortunately for us he decided to come back to the University and he has been working on some of our site escape2 based tools and some statistical methods software development and he's going to talk today about that and also I want to mention that in addition to being in our department bill as a member of our metabolomic school regional metabolomics core center MRC squared and he is doing a very important job as part of that core as well thanks Ally perceived this introduction and welcome to everybody so see I'll be talking about Netscape which is a site escape application or network analysis and I should say up front that first of all I just want to get a quick idea how many field you site escaped before okay that's actually good so more than half probably how many people have used Netscape okay that's actually pretty good too so but for those of you haven't I'm gonna go pretty fast and I'm not really trying to go through everything because that escapes a pretty big program it was they went through many releases or quite a few releases before I came here and I hope they'll go through many more in the future but it's there are a lot of features so I can't possibly do more than just sort of hit surface things and if you're interested though please do by talk to me drop me an email ally will also be willing to talk to people and go into more depth on some of these things feel free to stop me anytime with questions I'm going so I'm going to try to get through a bunch of different topics here maybe it's the limbus we'll find out just a quick introduction to what side escape is for those who haven't seen it and then there are two main parts of Netscape the first part is sort of Netscape classic if you want to call it that which I define as anything before I got here but those primarily pathway based networks it's sort of a knowledge-based system and then the new features so that's available currently are the new features that we've been working on it's a lot of it is with correlation based networks which is more data driven and that is not yet available but if anyone's interested in getting a pre-release I would be happy to maybe in exchange for a little beta testing we're hoping to release it fairly soon and then after that I want to talk a little bit if I get the chance to get timed about the statistical method that we're developing along with some folks in the staff department and it's basically a way of calculating the the data that goes into the metscape correlation networks and then we also are along with that releasing a tool that allows people to sort of go from measurements that come out of mass spec or other machines all the way through analyzing the data creating correlation matrices and then visualizing the networks in that scape so sort of the old pipeline okay so site escape basically is an open source platform as you can see with a lot of different groups involved several universities and and corporations it's been around for probably I don't know 10 years at least maybe a little longer and they basically provide a lot of the world graphics and network capabilities just for a lot of different apps or plugins to do more specific disease related or met or network related functionality but it's basically like Euler interaction networks as they say this is just a quote from their website but also gene expression data and so it's it's evolving it's still it's still being released they just released a new version 3.2 yes within a week or two but the the Mason the basic idea is that it's a job application has a really pretty extensive API so Netscape and other applications are written in Java for that API and you I have just put up a couple of examples of other applications there are hundreds of these things Netscape and that disease are two the ones that we're developing okay so metscape um basically this is a sort of covering everything slide in a way just a quick overview of everything that goes on with Netscape there are the idea is to visualize and this is going to be starting with pathway based networks visualized networks of compounds reactions that have all those compounds and then enzymes that catalyze those reactions and genes that encode for the enzymes and there can be as you can see any combination of those very variety of different types of networks available and the input data can be three different types of data gene expression data without a Linux data which basically measurements of compounds that have a lights team said enrichment analysis a couple of utilities that do that a couple of programs so we call those concepts I'm not going to dwell on those very much today at all but basically that's that's the sort of the workflow and then I just wanted to make knowledge that people have been primarily working on on this course Allah was the first author on the paper the most recent version a couple of years ago quite a bit before that most of the idea is probably maybe all the ideas of Netscape are all his ideas originally and and she's really the driving force behind all of this stuff and then developers I'm hiding out in the corner here teri Weymouth has just tremendous most probably know Terry I think he's online watching today but Terry is it's the wealth of knowledge about architecture and systems design and he also I think it's probably written quite a lot of code for metscape over the years and Jim Hall is was the I guess the primary developer private prior to when I came here for Medscape for previous versions he's now actually working in San Diego for site escape so he's still and he was seen as really helpful and I got started and as they had a ton of questions about its the re architecture site escape he was very patient and then went Arcia I'm haven't actually met Glenn but I think I got his name right anyway but Glenn worked on a lot of the database access hibernate framework or or I'm accessing from basically restore information about when we build the the the networks we store a lot of that in the database and so that everything's you know its basic server structure ok so that's basically how we would use the program I think that's a reasonable way to to get an idea for what's going on and so basically the can't quite see the menus here but there's an apps menu and here there you go from from maps sorry we're Maps the metscape build network and you see you have two choices pathway based a correlation based those the two of types I've talked about so you start with a pathway base then you get to panel here and I'll go through just really quickly what some of those features are you can see we have a pathway based network and the first thing is to select input files if you want to you can also enter manually sorry if you want to you can answer man manually enter compounds or genes I won't cover that today but the primary wave to get a lot of data in is through the input files so there are when you see if you hit the select button I guess I'll do okay sorry so what you see is you'll have the opportunity to import three different files compounds phylogenies file and then the third type I mentioned briefly concepts file a concept is just a set of genes predetermined set of genes it could be pathway based or various other things and the file formats are all simple text-based formats but you can see you also get a chance to specify p-values and full changes with thresholds so you can sort of map your columns of the input files to the whatever you want to be paying attention to in those files same thing for genes and then I just wanted to mention that there is a tool our path that was developed by marine Sartor and some of her colleagues here that allows building of concepts so if you you can also go to that website and build concept yourself or if you haven't predefined to them you can use those really quick brief no need to plug in that's quick too short a power cord so alright thanks ok so the compound file basically the most important is the compound ID at the moment these are K bodies we don't do support pubchem IDs in the near future but cadogan's is the primary ID that we use now and then you can have if you want to you can have various experimental data alongside and these columns are freeform as I said you get a chance to map them later but they can be time series they can be anything you want really the gene input file is really even simpler everything's based on entre gene IDs you can also use gene standard gene symbols if you want to and then just basically significance from whatever experiment you've done at significance and old change those genes and so it says you lead if you want to you can just enter a few genes you can also enter just a whole thousands if you want to it really is it's completely up to you what you get go on with it and we'll talk about the but once you got your input files and you can see that these are compounds in genes that you've you've entered now come into the panel and then you have a choice of which type of network you want to build so for choices a compound reaction enzyme gene just has everything in it and then you can see that there are subsets of those so it just depends on your needs basically and once you've once you hit the bill Network button you get everybody knows the hairball right so so you can see here this is a big for big data files over 5,000 nodes over 7,500 edges it doesn't do a whole lot of good other than it's kind of impressive that cytoscape can handle networks this big and they did a really nice job with their graphics you can zoom these things back and forth really easily and fluently so it's nice to have that provided but basically in order to make you to really be anything useful with the network you probably want to go through a few more steps and eventually create a sub Network so I'll briefly go through how you would do that wave them numbers sorry can you do weighted Network I mean in what sense we did by what different ways to do it right but if I might gene-gene interactions or compound drug-gene interactions it could be what Prime am primarily metabolizes the drug for example women have a higher significance then you know seconder yep cytochrome p450 Jeana metabolize the dirt or something like that I mean I'm just sitting so so essentially I mean I'm not sure if this is answered your question but but in order I mean the G's you can enter the experimental data yourself so you can essentially weight the nodes by attaching p-values to them or significance we'll get to a little extra yeah we do a little bit of that graph no it's fine please it's good to get the questions yeah so let's see I guess I'll just go on to the zoom yeah so this yeah this does get a little closer view of but it's you can see it's still kind of a hair ball it really is still just a lot of a messy bunch of nodes there you can see that the sort of red reddish colored nodes or compounds the diamonds your reactions green ones or enzymes and the blue ones are genes and you can see some of them are bigger and smaller I mean that gets a little bit to the question if they if they're upregulated they're bigger downregulated ones are smaller and then these green outlines mean that they're significant according to the data that you they use input in the first place but again still you this is pretty hard to interpret visually with all this mess in the way so if you see down below here we have the pathways that we we get pathways from the database when we get the input files so that we you know basically this is a long list everything I don't know close to maybe 100 pathways and you can then subset your data by different pathways so for example you know I've selected a pathway for the urea cycle and terrible ism of a bunch of amino acids and you can see a little bit that there's some yellow here in the big in the hairball the yellow nodes are the selected nodes so those all those nodes are nodes that are associated with the pathway and you can also see off to this side here in the network panel that you now have 288 nodes and 333 edges selected so we've subset the network quite quite a lot at this point and then we can hit the create sub Network button which will then reduce down to a second it'll build an additional network with just those selected edges so now we've got again a much much closer up view of glutamine which has been down regulated which is significant here various other ones that are significant as well and if I wanted to get information about any of those compounds I could just double click click compounds or genes any of the nodes I double click on glutamine I get this information panel which has among other things links to a variety of databases if you want to learn more about that particular compound and also a nice little elec Euler representation of the compound there quite a little quite a bit of other other more information in there as well so that's basically the general workflow for Medscape for pathway based networks and as I said I skipped a lot there are ways to expand and collapse nodes and you can do some animation in time series things they're just a whole lot of other features in there but I hope that gives a basic fundamental idea of how to how to get started with some of these things and probably most of you who've used Netscape of them is already so the problem with pathway mapping it's certainly useful and we will keep it in the program or as long as people are using it but it's not perfect it doesn't we don't have complete knowledge so currently a lot of it looks like we're basically around half of the metabolites that are measured by biomass spec and other machines are mapped to pathways and there may be other pathways that we don't even know about they're basically a lot of these known unknown features as they're called which are features that are they will show up repeatedly and reliably on massive readouts but we just don't know what they are we have information about their molecular weights and a retention time is another useful piece of information that that scientists are using to try to understand what things might be but it still is a big partitioning problem basically if you have a molecular weight you still may have dozens of hundreds of possibilities for what the what the molecule might be and maybe it's not even on standard list who knows what it is so so the question is is there any other way to get at the information and help narrow down that long list of candidates and so our along with probably other people in the field came up with the idea of using correlation information and just basically making this a completely data-driven process so we don't have to know anything about the chemical behavior chemical nature of anything that we've been measured in order to do this we just have measurements coming out of a machine and then we build correlation networks base those measurements so here we've switched over to correlation based network as opposed to pathway based network and they're just a few other a fair number of the features really quickly so the first thing is again select an input file and you can see then I've been showing the drop-down for the column mapping so that's similar to what we had before and the in the pathway based network for you think whatever columns you happen to have mapped in the file you can you can select what you care about in this case it's a basically correlation coefficients B value in a Q value that just happens to be what's what's in our method but you could have whatever you like in there and it'll pick up those columns the format oh sorry one more thing when you input that file you get a list of compounds that are identified which are ones in yellow here in this dialog and then others that are not found in our databases those are in red in pathway based networks we would just exclude the ones that are not on the database because we have no way of leaking into other to add and reactions or enzymes of genes in this case for correlation networks we hold on to those and to stall them unknowns so anything that's in the database we'll consider a known anything it's not with an unknown and for the things that are known you get a list of possible matches in the database and you can select whichever ones you want fortunately well in the new version upcoming version once you've done this process once it'll remember it least your most recent choices they don't have to go through it every time but as you can see when you make choices and you get a keg ID that goes along with it you can you can click on the link if you want to to make sure that's the one you want and so on but but it gives you a chance to identify because input files people have it's one of the hardest things in the field I think to determine what are good names for compounds it sounds like something that should be easy but I think probably everybody here knows that it's just not people call things different things the range for the edges basically some of these networks are very large to start with and correlations can be non significant or not significant close to zero or they can be very strong and so right away it's important to have a way to filter the the edges in the network and just get down to the things that are most important to you so so there's a mechanism here for both on the negative income and positive ranges for for our correlation coefficients to adjust your arranges and then based on that you'll be told how many you're actually currently including in your network that you're going to build the moment we're including everything because we haven't filtered at all quick overview the input file that was used to get this to this point it's just simple five columns the the names of the two metabolites they're the correlation coefficient between them this is the this is actually the input format that we use for a method correlation coefficient p-value and Q value as I think I mentioned you wouldn't need these you could do just one column of data and you can basically do whatever your a particular method involves would try to be as flexible as we can but it is at least three columns with pairwise comparisons of some sort between the between the compounds for every pair of compounds it's also this is the column based form we also allow a matrix format but so it's just usually an Excel spreadsheet but the reason that that's not really adequate for our purposes is that it really only gives you a chance to do one measurement so you can't if you were to do P values and Q values as well you'd need three different worksheets it gets complicated in a hurry so we support this format if you only have one measure that you care about but we recommend the column based format and then back to the network once we push the magic build button we get one of these things it sort of reminds me of a spirograph when I was a kid don't know how many people remember that but yeah basically we draw every possible edge so every every pair of compounds has a correlation boost some of them are just very weak and so we initially if there's no filtering we draw everything the thin lines which is just about everything are the weaker correlations and then the thicker thicker edges are the stronger correlations they actually get thicker and they're done in several levels so you can sort of visually check out right away what's what is significant and what's not and then the edges are two different colors obviously the red edges are for positive correlations and the blue edges are for negative oh I should sorry so actually it's yes there's a story there and just one other quick note they'd be a sort of purple like Lavin or whatever colored nodes are the known compounds and the white nose unknown compounds things that weren't found in the database okay so what went wrong here well nothing actually went wrong here but as you can see we've got 9700 edges so this is a slightly larger Network it's only hundred forty nodes so if not even a large number of metabolites for most purposes so you cannot from the as many as a thousand or more but in this case 140 and if you decide you're going to draw all the edges well that's what you get so clearly that's the case where you'd want to filter and so in this case we're actually mapping based on Q value so that was recognized by the program as essentially measure of significance of the sliders changed instead of two sliders you've got just one slider the edges are now black because there's no positive or negative anymore but it basically if you now filter here I've got the slider set to 0.01 as the upper range now we get a much better much more readable network by subsetting as you can see now we have only 117 edges instead of 90 730 that we had starting out so much much more interpretable and I actually well one just quick thing and you can see there's a floating label here these guys are pretty small sometimes so this is just a tooltip if you don't already know would you get the name of it and again we we bring in sorry back up we bring in pathway information so pretty pretty of the known compounds we also bring in pathway information as we did with the pathway based networks the reason for that is you still may want to subset your data based on pathways so even though the edges aren't corresponding to those pathways in any well they may but they're not a priority corresponding to the pathways you still may want to have that information and use it so a couple of interesting stories start showing up right away and then based on the work that we've done so far and so we wanted to really briefly go into a couple things that we found and they're encouraging that methods actually get finding us things it's ability a little bit blurry here but these are sort of things fatty acids that have different size tails I believe that my biology background is not as strong as I'd like it to be but I believe that's the difference but anyway see 18 16 14 they're getting shorter and you can see they go all along 14 12 10 8 6 so they were corresponding they were correlated the way he'd expect them to be right down the line and then right at the end well there's just unknown all of a sudden well what's that doing there well we asked some colleagues what that might be and turns out it is actually just another c6 but untargeted assay they just didn't have an internal standard for it so they did not recognize it as anything that you said is not known so that's we didn't identify anything novel here but we did help them to realize that that when this shows up on their untargeted assays that is just that is c6 and at some point there this is in honor two in our core they're buying more and more compounds and they're getting more and more standards built up so so eventually you'll be able to go back and say that this was c6 presumably they want to do that make a notation whatever so we found that's that's something they came up right away another kind of thing that happens fairly often it's kind of a strange set up here where tyrosine shows up and then it's got three unknowns with it and they're all interrelated pretty strongly if you notice just based on the names that we had in the input file these this is essentially molecular weight number one maybe two point something they're all very similar and then RT is retention time also again very similar for all three turns out that those are also essentially what you get for tyrosine so these three are probably we don't know for certain but probably just duplicates a tyrosine so that helps the are the analysts filter out repeated duplicates so that they can basically said over saying well we have 200 compound 200 knowns and a thousand unknowns well maybe it's maybe the number of unknowns is actually quite a bit fewer than that and let's get help them identify some of those one cool thing that bill did here I don't know if you agree there's noticed that the edges actually waiter so the thickness of the edge is proportional to the strengths of the correlation of whatever is mapped to it which is sort of you know I can explain how you did that but I think it's a pretty clever right so yeah it seems to me yeah so so for people online that what I was mentioning is that the thickness of the edges corresponds to the strength of the correlations and so the thicker the edge of the stronger the correlation and you can't really tell much of a difference between these because we've already filtered down to two things where everything's significant so we basically it assigns the thickness based on the entire dataset so once something significant it you can't filter it into not being significant but that gives again a visual representation of what's going on so we're still working on more stories and in fact all of this week has gone through pretty much this dataset with 140 nodes and as I believe sounds like a story to tell about pretty much everything in the whole dataset based on this method so we haven't we still there's still confirmation and and we need other people look at things in order to make sure that we're what we're finding is right but but it's certainly gonna say barraging that we're finding things that are meaning all so far okay so so far everything I've mentioned is basically how to display correlation network so they don't have to be the flexible data a flexible input data there's no one method that was necessarily used to generate any of that stuff well so we thought well let's come up with something maybe we can internally do something and in fact the data sets I've shown it all all the generated with our internal method that we're we're still tweaking but we have it pretty well defined at this point and before I describe it I just want to mention that this is work with all involved George McFly TISS is a professor in the statistics department his recent recently graduated student Samantha Basu has done a lot of the the writing the our code and sort of I'm sure the nuts and bolts of the statistical part of the analysis Chuck grant is in charge of the MRC squared core at C Brown was also the director of the core have provided a lot of insight in terms of biology and biochemistry and have helped us identify some things when we're not sure anymore our knowledge has gone to the limits of what we can do so the basic idea is that ladyman measured metabolites i've sort of already touched on this but related metabolites may be correlated across different samples different blood plasma samples to samples whatever happens to be used in an experiment and the relationships may not be based on known pathways or shared pathways or chemical similarities or it's it's hard to say exactly what all the reasons to could be but we think that just by looking at data correlation data that we could probably determine meaningful relationships so one idea would be to use Pearson correlation coefficients simplest generally used coefficient just easy formula here and you can you can get direct versus indirect Association here but you know you do need more samples then you have the tab lights in order for that to work actually I think I I think that's not true I think I put that in one place sorry so ignore that last line on that one that's supposed to be on this slide if you run go a little further than Pearson and actually get down to the to the relationships in a more directed way there's a what we're calling a basic carbon partial correlation modeling approach partial correlations are obtained by basically taking any two metabolites say m1 and m2 progressing each one on all the remaining metabolites in the data set saving those residuals and then calculating a Pearson correlation between the residuals and that is at least in theory and in practice so far allows direct a much more direct comparison rather than a cluster of inter correlated compounds what you get is maybe a line going from one compound to a second to a third where that you know that those are pairwise relationships and they're not influenced by their sort of confounding relationship some other other inter correlated compounds but but in this case now this time I mean it you do need more samples than number of metabolites for the regression to work so we have to go a little fancier than this not everybody has a whole lot of samples so if you have fewer samples in metabolites I won't go through the whole the whole statistical part here especially since I'm running short on time or a the bottom line of this is that there's a graphical lasso method it's it's it assigns a penalty which effectively reduces the number of metabolites right my understanding is taking weaker correlations and forces into zero that's the gist of it it's way more complicated than that but I anyway that's that's the general idea so I won't spend a lot of time on that because I don't have much time but but um yes it is still pretty easy to implement it's not really complicated to do there are some issues the most important being that estimates are generally biased but there is a bias correction which is called the deg lasso method which is the D biased graphical lasso method and that's what we're using basically so that's so we basically give me up the user an option between the basic method in our tool of M and it's DG lasso method which we think is about the best approach it also works really well when in the case where and it's greater the still still behaves about as well as the basic method still it turns out that these Pearson correlations are really useful for filtering compounds for filtering nodes if you see think visually a heat map is the usual way that people visualize correlations and Pearson correlations will often give clusters of nodes that you can pick out right away and then if you they're sort of along the diagonal if you see a long part of the diagonal where there aren't any other inter correlations or there aren't very strong ones those are likely nodes that are not correlated with much of anything and you can just filter them out and so we've got that implemented basically if you choose a threshold correlation threshold based on Pearson correlations you can eliminate a number of compounds get rid of noise basically but you will still retain metabolites with the strongest partial correlations and there's actually a pretty good theoretical foundation for that but George McFly this has been working out so it's it seems to be intuitively true but also theoretically makes sense so we have the last part I wanted to sort of talk about the workflow basically of how we go from the data coming out of the machines all the way through to scape network and so this is a standalone java tool there's written that allows us to go through the whole process basically first put an input file which essentially just looks like whole bunch of samples for a whole bunch of compounds these are just measurements in this case this is these are log to transform and scaled to normalize the data we allow those options in our tool but those are very important things to be doing and most people know that to clean the data it's you don't just want to go with measurements that are all over the map for different compounds they won't won't be hay roll when you start using these methods on them so if you can see we do allow plug transform and auto scale you know not a comprehensive list of things but if you want to do that yourself in this case we've already done it also allowing for a couple of different file formats samples can be either in rows or columns and they can either be labeled or not so try to make a little more convenient but as I was mentioning we still want to use Pearson's correlations for filtering potentially we can if we want to just go straight to the partial correlations at this point but if we want to do some filtering we can do Pearson's correlations and then in particular if we hit the view heat map button it will bring up a quick heat map in this case small dataset amino-acids and you can just get a quick visual idea of what's going on here this is mentioning here a couple notes that don't look like they have anything off diagonal going on those can probably also probably come out quickly if you do any filtering but where they're stronger blocks of correlation leucine isoleucine valine those likely are going to stick around no matter how much they'll be the last ones to go so oh it should mention all of this the user doesn't have to know anything about our doesn't even have to know that our is running in the background this is all done on a server that's running our so basically the client they don't have to have our installer the machine they just have to be just give us a data files and then we do everything else on the server so I think that's pretty flexible now I filtered basically set the Pearson's correlation threshold somewhere just under 0.6 and that's not tremendously strong but you can see we've already we've already got down to 214 no 23 metabolites and then we can choose between the two methods I mentioned the other basic or the the DG lasso penalty method and then when we we finally hit the Run button over here and then the fun part here depending on how you want to do this if you want to you can always just do result in any of these cases and save results so if you just want to deal with the files you can do that but if you want to go through the whole step all the way to the visualization you can do that here so you can just say view Network and and you don't have to know what's I escaped you don't to know about Medscape if you have them installed basically it'll come up this patient you know there's some steps that have to happen here but if you have say escape and metscape already installed you will just get the network that will filter we have it filtering on Q values with a threshold set already at point one and there's your network if you don't have sight escape installed yet it'll prompt to you if you want to install it then when it gets through that it'll launch site escape if you don't have Netscape it'll ask if you want to install that so it tries to find things this is sort of it is actually something that Tim Hall did that site escape for some of their applications and he was happy enough to let me borrow it so I appreciated that but it's nice to be able to just push a button and be prompted and basically end up with a nice network and there's a live version of that scape now you can just do everything that I mentioned before the network and relate it any way you want to so you basically just gone from getting it a column based set of measurements from compounds all the way through to visualizing and having pathway information and so on so we hope that that is is useful and highlights I think that's pretty much it so thanks a lot and encourage any questions yeah not yet that's a good so the question is are there links to the reference to references for the methods that we've been used you mean the statistics yeah so they will be we hope we were working on manuscript this is all pre publication and pre-release so this is nothing has been there that's a good question we certainly will have information are there we an explanation of what we're doing and everything it's a good idea but we can be carefully put assuming that we are we the trick is we want to put we want to release at the same time that we submit the manuscript so it'll probably not have a link right away but then it becomes official it well and actually I would you be interested in seeing links to related references as well or just the one just will we end up writing up I think it's a good question because I think the message itself is going normal yes I mean well I mean this is really like another sort of correlation based analysis it's a really hot topic and a sort of closed field of metabolomics and everybody's very excited about it but I think what bill said is true that you know people so far have gone as far as like basic partial correlations all this graphical also stuff is quick nobles so I think the idea I mean there is some you know there are some difference that I know so far in some obscure you know journal proceedings or something you know so there's not a whole lot to refer to but it does come in all various places throughout this to tools our little question marks or whatever that all sort of you know explain and give more information and now that you know that this is a important method well fortunately Marcy passed out the signup sheet so no signing the non-disclosure agreement on your way out and we'll know if anyone has here any other questions either I went a whole lot to faster no okay great so yes okay so the question is what kind of bias can get from the graphical lasso and unfortunately I don't have I don't know the answer to that question myself George Michael itís our statistics professor would definitely be able to answer that in detail there I guess I can I can I think probably this the Friedman reference it goes into detail on that but if you want to drop off an email I can get back - yeah I I I do have a biostatistics degree but I have been only marginally involved in the statistics in this project so I'm sure it's known so yeah okay
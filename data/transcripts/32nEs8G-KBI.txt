welcome and um introduction this is the tools and technology seminar series and it's great to see people uh logging on for anybody who's new to this seminar series it is a basically just a venue to discuss tools technologies methodologies recently in development currently in development maybe not even developed by the speaker but just some tool or technology that's useful for the community and you're always looking for speakers so if anybody does want to present in the future to please contact me and i think that's everything i have so with that i'll let matt introduce himself and give this presentation great thank you marcie thanks aaron for the tech support too so i really appreciate the opportunity to come out and talk and for you to come and listen um i'm a new uh research faculty in the department of bioinformatics dcmb and um i got caught up in the working on stars kobe 2 as i think many of you have um so i'm going to tell you a little bit about some of the initial progress we've had in doing drug discovery for it and some of the methods and tools that we've developed along the way so i started last year in the department and the focus in my lab is in several different areas all around computational pharmacology so i do some protein therapeutic engineering this is the design of a bacterial enzyme to treat strokes and then also we do virtual screening so take libraries of compounds and and computationally dock them into the receptors to see if we can find drugs that may fit and then also experimental design where we're doing bayesian optimization of the the information gain in an experiment to try to find conditions that would improve the experiment but what i'm going to tell you about today is a work on developing high content pharmacology so here the endpoint is not just a yes or no or alive or dead or works or doesn't work but it's a rich array of endpoints so we've done some work with electrophysiology where you have spike trains for individual neurons but here i um this is based on a collaboration with the saxon lab where we're using high content microscopy to measure lots of features of individual cells so we're trying to understand at the cellular level how does treatments or different conditions affect the cell so we're still going to get dose responses but now we have lots of dose responses for lots of different effects okay so the unifying theme of my lab and how i like to think about problems is um it's cross-disciplinary between the biological sciences and math and computer science um and so often times it's helpful to have a common language for how to describe a problem so i like to think of it the sort of updated version of the scientific method where we have some natural process that we really care about and we can do pharmacology on it so we can perturb it with a drug or some sort of condition and measure some sort of response so this gives us information about the natural world but unfortunately this is often slow expensive dangerous and ethical like for instance we can't test drugs in people without having some sense that it might not be toxic so what we do is instead build models for this process that's happening in the natural world and then if we perturb and measure the response in the model then that gives us some inclination about what's going to happen in the natural world so this is often faster cheaper safer more ethical and this model can be take the form of like say a model organism like a mouse or a cell in a plate or even a computational model where we could say you know how does the how do we predict the response to happen and one of the areas that i find particularly fascinating is that oftentimes there's a hierarchy of models so instead of having um just one layer we're going down to mice we often have a whole sequence of models that are more and more reductive and so trying to find the the most productive system where we can very quickly test something and then move that up the hierarchy towards getting it into the clinic or understanding of the full process in general so moving up and down between different systems and trying to understand what we can learn about the natural process in that system and then into computational systems um oftentimes we think of computational models as being fully understood because we can you know reproduce them by setting the same random seed but oftentimes these computational models are um computationally expensive to run and difficult to control especially with say deep learning models so i'm trying to understand how the computational models work we can use the same idea of coming up with simple or statistical models to try to capture what's going on in the process so what we want is this uh to be represented so in the context of drug discovery um the main idea is that we're going to work our way up this hierarchy in realism with increasing costs so uh moving up from computational to the in the test tube to maybe in a slice this is mercy i'm just gonna interrupt for a second are we supposed to be seeing slides at the moment oh my goodness how are we not seeing signs we're not seeing slides oh my goodness okay thank you so much for stopping here very far without uh okay is it where are we do you see anything at all no okay let me try reconnecting are we still stopping sharing or starting sharing thank you for for stopping oh yeah now we're seeing your slides okay thank you yep we're not i'm present view at the moment but okay should be yep that's better okay perfect let me just go back real quick so we have protein therapeutics large scale virtual screening optimal design and high content pharmacology so this is the uh the natural uh observational model natural process that we care about and then uh this is where i had just left off so we're working our way up the hierarchy in the drug discovery so most of what i'm going to tell you about today is where we're putting drugs onto plates not just test tubes and try to understand how how the cells respond okay um so this work is um a really fantastic collaboration um johnny sexton um had the michigan drug discovery um and the internal medicine have this drug repurposing uh center so the idea is to use this high content microscopy to understand different diseases and his area of expertise is in liver injury but with the sars he really took the lead in trying to recommission the bsl3 facility um in the um in the building and then uh he has some graduate students and team and then also we we um we were really lucky to find that postdoc and christiana wallace's lab carmen rivalli had been uh trained in bsl3 and so she was at the start the the primary virologist that was going in and doing all the work so i had started to work with johnny to understand how to analyze these high content screening data sets and so we all worked as a really uh a fantastic collaboration in team uh since march just to really uh be very productive and trying to understand how we can use this technology to look at uh service code v2 so i just also want to mention that we had um support not only from from carmen and but also christiana um was instrumental in getting the bsl3 facility back up and working um she's an expert biologist in the microbiology department and uh teresa was uh deeply engaged in helping us frame the questions and and understand the experiments um from a really uh robust microbiology experience and then i also we had a number of key admin support uh both for the drug repurposing center uh with kevin weatherwax and and george forshire and i'm a research faculty so i'm in and brian atheist lab so he's given me a lot of support as well and then uh to make the whole thing happen we had a lab managers and giants group of tracy and carl so we have a pre-print of our initial paper up on the bio archive and it's currently under review at major communications so um you can read it and it will be out soon in publication okay so uh how does this work so when we get um an image of a well on a plate uh these are the cells we get nine frames per well and it's 386 wells per plate and so this is we can stain the cells with different dyes and then image them to um to find so this is a nuclear stain but we can also stain with for lipids and for the cytoplasm and for the virus so when we layer them all together we get a rich perspective of what what's going on uh within individual cells so there's you can see there's really a wide range of phenotypes and heterogeneity going on some cells are infected some cells are maybe infected and you know there's a range of different things going on some are more full of lipids than others for instance so our goal is to try to understand under what conditions are the cells being infected and how can we use drugs to try to understand how it's perturbing that process so the rapid assay development that that was done was to try to find a cell line that was permissive for sars kobe 2 infection so we screened vero e6 which is a monkey kidney cell line keco2 which is a carcinoma line in the gut and hoh7 cells which is another cancer cell line and um we were looking for what is the day's post infection that gives us the best um response and then also what is the um the multiplicity of infection that we get enough cells that are infected but not uh totally um non-physical so there's a number of these assay parameters that that we've developed that were developed um uh very quickly and we've continued to refine them so kiko twos are maybe our new favorite solomon um but any sense um part of the draw the job of of informatics is to uh very rapidly be able to and give back information about you know what is the um uh which uh are the degrees of freedom in the experiment that we can uh poke and prod in order to get more information out of the system okay so um just as a control or you know a test case rem deserver as you know is one of the few drugs that has shown some promise in the clinic and so uh the negative control this is uh infected but not treated and then when we put rem deserver on it at a quarter of a micromolar we see that virtually all of the um the virus is gone except for perhaps a few punctate spots which may be aborted infections or or misfolded viral protein so here we're using um the nuclear capsid stain for the viral protein but you could also picture staining for other other viral proteins as well okay um so the format for the screen that we developed was we take in a library of fda approved and clinical candidate compounds and in the primary screen we did five doses per compound which is 25 plates and what we were screening for was um we defined a classifier between that separated out the negative controls from the positive controls using a random forest and then we counted and then we were able to score each cell by segmenting it using cell profiler and then being able to predict or quantify if each cell is infected and then count the number of infected to total cells within each well um so what we get is a dose response curve you know with five points uh for each of the drugs and then uh from this we identified a 132 candidates that we wanted to follow up with for dose response so uh the way this dose response works is you know um you increase the the dose of the drug and then measure if it's killing the cells and then also if the percent of infected cells is going down so this is rendezvous which we knew to be effective um and additionally this is another example of um it's called s1ra and um it's a compound that's not in the clinic yet but it's known to be selective for the sigma receptor which i'll come back to later so just to give you a flavor for what these dose responses look like um what we get so if you're not familiar with pharmacology the the key parameter is the half maximal activity of the of the drug so what at what dose do we lead to half the response in this case the number percent infectivity so that that um that concentration is important for trying to understand um how we might be able to uh dose it in order to make it effective so as you increase the dose compounds tend to interact non-specifically with lots of other proteins in the body and so typically for you know a medicinal chemistry campaign having an activity of in the low nanomolar is ideal although there are exceptions or there's compounds with with more activity than that so it just it becomes a harder more challenging problem to to find the the mechanism of action and and also the off-target effects um as the selectivity or specificity of the target is not as potent okay so um i'll just go briefly through some of the biology around these um about two different uh classes of drugs that we're excited about um one is uh signal biggins and also i just want to point out that um that we aren't the only ones doing drug repurposing screens for um uh stars kobe 2. i think there's probably now a dozen or more screens of various sizes that that have been done and uh one that i was involved with um through ucsf where i did my postdoc was uh we also identified a number of compounds that had activity at sigma receptors so um how peridol and and hydroxycorquin you might um might be familiar with um but uh many of the antipsychotics and antihistamines um uh tend to be active at sigma receptors and so this whole class of drugs seems to be active um so this is a summary of a slide from a paper that that came out in um in april where we were looking at um this is so this is another lab uh and we're looking at both hydroxychloroquine and p28 and at different time points of infection so not not all of the sigmoidance are effective so dextromethane is a um is a uh you could take it for colds it's an antihistamine and so it seems to be not um either not infective or uh or not effective or slightly um worse so i think some care needs to be taken about trying to understand what is the mechanism that's going on here so just um to get at some of the structural activity relationships um we have a structural model for how these drugs fit into the binding site so this is in both in the sigma one receptor and uh these are uh corprostine and pentazine which is the compound that the sigma receptor was crystallized with so this is corporatine and clemstein so many of these drugs as i said hit lots of different targets um it seemed that least of the ones that we tested the common denominator was that they were hitting the sigma 1 receptor as well as the sigma 2 receptor which is um known to have a very similar uh um sense similar molecules so it's it's not in a log of the sigma receptor but they're often grouped together because of they recognize very similar okay so one consideration with these is that many of these drugs are known to also hit the um it's called the herg ion channel and um so many drugs have been pulled from the clinic because they can cause cardiac arrhythmias um so you perhaps have heard of some of the controversy around hydroxychloroquine and part of that is that if it's not working and it has this side effect of cardiac arrhythmia then if you give it to millions and millions of people then you know some fraction some you know non-trivial fraction of people will all have adverse reactions so hydroxycorquin is widely used for malaria and for arthritis and lupus and some other autoimmune disorders so obviously people do take it but just care needs to be taken okay so um going a little bit into the biology of the sigma run receptors and how this might might actually be functioning um it's a sigma receptor is a resonant er chaperone um in the membrane and it's involved in mediating our stress response uh so here are some of the drugs that may target it these are ones that are available either over the counter or hydroxyl and we got into this um through the um the ucsf collaboration because nsp6 which is one of the non-structural proteins in source code ii uh physically associates uh with the sigma 1 receptor in a proteomics ap mass back experiment um so uh the biology of the sigma 1 receptor is that um under uh stress such as with the um soros kobe 2 forming these double membrane vesicles out of the er um that this leads to the sigma receptor coming and chaperoning disassociating from an inactive state to chaperoning the i3pr which is a calcium channel which releases calcium adjacent to the mitochondria and so this stimulates a whole host of of um of stress response uh from from the mitochondria as well as um the ire-1 which is one of the main drivers of the unfolded protein response so dip is a chaperone in the er that chaperones many of the unfolded protein response components and when it disassociates sigma 1 partially soaks up a bit so it's unclear if what the causal relationship here is if the stress is causing the sigma 1 to disassociate and so cup bip which releases these factors or the the bip comes out and and attacks the sigma 1 receptor which activates these things in any sense um there's been a nice study that that compares thafsa gargan which is a known er stress inducer to the stress that's involved in uh the stars kobe 2 and so there's many similar similarities and some important differences between these different stresses so trying to understand how exactly is sars kobe 2 stressing out the um the er um perhaps through depleting um lipids um and how can that be uh targeted as a drug response pathway i think is is uh rapidly uh our understanding of it is rapidly improving so i just want to highlight up here that um two important pathways that seem to be important for downstream of the unfolded protein response is that il-6 pathway which you may have heard about is involved in so not necessarily in uh airway epithelial cells but in immune cells um when the il sex was released it can it can be released at such high levels that it causes a cytokine storm and has something like sepsis so some some of the people are are in grave critical health because of of the not necessarily the infection which is bad but because of the overactive immune response so toxilizumab and others were aimed to try to target the idle sex pathway and then um additionally the autophagy pathway um this is uh an important uh cellular process that's involved in in starvation so which involves uh taking in components from the cell and recycling them to allow the cell to continue to live as well as um cleaning up debris and uh and other things that are in the cell including pathogens so um escaping or modulating or somehow handling the autophagy pathway is an important hallmark for for viral protein or viruses in general so it it's often instructive to ask you know how is it interacting with autophagy is it stimulating it is it avoiding it you know how does it get in and out of this process so to take a look a little bit more at this autophagy pathway there are sort of two big arms of what's going on one is that the autophagolysosome forms by by forming this phagosome within the cellular environment and then it fuses with the lysosome and so the lysosome is this end product of endocytosis it goes in through vesicles through the early endocytosis the late endosome and it becomes increasingly acidic where it fuses with the lysosome and so many of these different parts the virus may want to upregulate to say access different components of the late endosome and get into the cell or and it may want to block or stimulate the fusion in order to to not get totally destroyed um so our understanding of this is is ongoing but uh there's some interesting connections with the sigma pathway and then it's shown that the sigma receptor is part of its chaperonin activity uh mediates the the fusion of the auto phagosome with the lysosome as the last stage of this so perhaps part of what the virus is doing is subverting this final fusion stage in order to sort of access the late endosome but not actually get destroyed so um this is a fascinating area of biology that i'm rapidly learning about and i'm sure there's there's many more experts on campus or maybe even on the call but here are some some links if you want to read more about them okay so the other pathway i mentioned was the il-6 and this is primarily mediated through the ire one so uh it looks like there's a nice uh characterization of paper in 2013 that says when the when you don't have the sigmoid receptor the ire one rapidly associates and starts signaling but then it gets degraded through um ubiquination so if the sigma chaperone is there then it can stabilize the ironing one and it leads to a long-term effect of the of the phosphorylation of ire one and then the downstream um in the immune response the unfolded protein response so there's this nice paper um last year in science translational medicine that looked at how the sigma receptor via the irene one mediates the inflammatory inflammation and sepsis in animals so they were um either using lps or fecal material and then monitored the survival with this challenge of stress um and they saw that um they did worse without the sigma one receptor so um they did a detailed characterization and found um fuvoxamine which is a ssri um is able to be a sigma one agonist and protects against this type of sepsis so there's a clinical trial now going on at the university of washington st louis where they've they've used this ssri from foxamine and it seems to have uh very preliminary um benefits for for helping um people so they got out to it as through this sort of antisepsis um but you know that the sigma compounds are doing doing many things so i just want to mention one more process that may or may not be involved and that is that as i mentioned getting into the cell and avoiding the autophagy pathway is a hallmark of viruses in fact different viruses tend to get into the early endosome and then into the cell at different stages and so interestingly enough um ebola and sars tend to wait until the very late endosome that the endolysosome stage it's thought that ebola gets there because it needs to access npc one which is a transports cholesterol uh from the endosome into the cell um but it's um uh the sort of the canonical word on the street is that stars is waiting to this very last in order to access cathepsins which proteolytically activate some of the spike or some of the um the proteins that allow the fusion with them with the membrane so it's interesting to think about you know are drugs that are targeting disruption of this late endosome between different viruses are they going to have similar effects or not and indeed there was a drug repurposing screen for ebola a few years ago and they found actually many of the same sigmoid compounds so sertraline and uh uh programmaring and others that seem to be um modulating this late endosomal process so this suggests that maybe it's either mediated through the sigma receptor or it's something else that's somehow targeting this this late endosomal process so in some ways that's not great because we want we'd rather have a more specific process but if we did understand if that was what was going on then that might give us a sense of you know what and what enzymes or what process needs to be identified within that that compartment that could be more selectively targeted so i think it um isn't the end of the story but it does open up sort of directions to focus our attention so one of the ways that it might be disrupting this late endosomal process is that these drugs just by chance um are often characterized not necessarily by their targets but by their their chemical properties so they're often called cationic amphiphilic drugs or cads and that's because they have a positive charge at one end and then a relatively greasy rest of the molecule and one of the unusual things about this is that um in acidic environments the positive charge can become protonated in which case it comes neutral and then it is unable to escape from that acidic environment so it's kind of a one-way street where it goes into an acidic environment and then can't get out and so it leads to this accumulation in the lysosome because it's at just the right um low ph so um [Music] chloroquine for instance is a as a well-known compound that that accumulates in the lysosome it has you know extremely long um resonance in the body so it's because it's getting taken up as well as several other compounds uh in the same class so one of the key things that happens when it when drugs accumulate in the lysosome is that they deactivate the lysosome and then that enzymes that are there stop working and so if you zoom into you know 1600 magnification or even you know um 6500 magnification you see these are very characteristic worlds inside of the lysosome and this is often called phospholipidosis because the um the phospho enzymes within the lysosome are unable to process the substrates and so they just accumulate and they form these these sort of concentric membranes inside so this seems like it would be quite toxic but um it seems that you know hydroxychloroquine for instance is well tolerated so it's um the cells are remarkably robust for this um this process and um i think there's some really interesting ideas about maybe the the sigma receptors are kind of a canary in the coal mine uh for this uh phospholipidosis process where they're extremely sensitive to this class of drugs in a very promiscuous way and then it stimulates a cellular processes to try to mitigate some of these um you know um uh processes so autophagy to sort of reuse the lipids that are there and and some of the other uh immune response that maybe leads to um apoptosis to sort of kill the cell if it's irredeemable so i'm it's unclear if um if these drugs are working just from a real physical chemical property or if it's targeting some of the multiple different um uh er stress response pathways so i think that's an open question that um we and as well as others are are actively looking at okay so the other class of drugs that um are a drug that i want to um draw your attention to is uh lactoferrin and this is a fascinating molecule it's um it binds iron it's in the transferrin uh family um it's found in costume of of uh primates and as well as tears and some other other fluids as well um but it it's been um used or thought you know explored in a variety of different ways and the you know the general narrative is that um um mothers produce uh this to protect uh newborns from infection before the immune system of the babies can be fully developed so it works in a variety of different ways but two ways that i want to highlight is that it seems to bind heparin sulfate proteoglycans and it's thought that before the virus actually interacts with the um ace2 receptor that it needs to somehow associate with the heparin sulfate proteoglycans on the surface of the receptor before it can get transferred there so it might actually be interacting with the virus itself or somehow disrupting this this process and there's some really interesting structural biology around the role of the proteoglycans both on the receptor and on the host side that's involved in mediating this process i know tempris2 is also here somewhere which is a protease that's cleaving not only aspects of the viral proteins but also the east too so i think trying to really map out this process is going to shed light on you know how lactoferrin might be disrupting it but additionally there's some sense that maybe either through the iron regulation or some other process once it gets into the cells it seems to be mediating the innate immune response and although the mechanisms are not fully worked out a number of people have looked at this for a number of years but one of the main advantages of it at least from a drug repurposing perspective is that you can go into the grocery store or on amazon and and buy it it's um generally recognized as safe dietary supplement we can get it from you know cow milk and purified from that and there's been a number of uh you know phase one and phase two clinical trials that shows that it's you know very safe you know giving it to um newborn infants um in the nicu so there's a very vulnerable population and they seem to be doing fine with it so i um it seems like a something that could be widely deployed very quickly and if it does have activity and then that would be interesting so sort of introduce you to the molecule and let me tell you about uh what we found um so first of all it has a lovely dose response activity um measuring you know what is the concentration is a little bit tricky because unlike a small molecule the concentration depends on the molecular weight um so this seems to be um quite potent for a protein and then also given our virology experience with carmen and christiana's expertise they were able to do a range of different more more classical uh virology experiments to measure you know how effective it is so this is not just looking for staining and viral proteins but also you know the log genome copies of how well can you have the reproduction after after you've treated with it um we also were interested in whether or not it needs to be bound to iron or not so that's the apo versus hollow or if transferrin which is also in the family works so it's not transparent it is specifically to lactoferrin which suggests it's not just some non-specific protein aspect of something specific to do with lactoferrin and it's it's nice to know that both the apo and the holo seem to work because it will take up iron once it gets gets access to it additionally we wanted to know if it was effective before it was the cells were infected or if it could work after if it only worked before that would suggest that it is primarily mediated the initial uh interaction but once it got into the cell there was no stopping it and although it was more effective uh before we did see that there was um still significant activity once it wasn't inside of the cell so 24 hours post infection so that suggests that there might be multiple mechanisms of action here and indeed i'm monitoring many of the downstream innate immune processes so inf beta viprin isg-115 mx1 and itfm3 many of these were upregulated in the presence of lactoferrin so this suggests that it is in some sense modulating the immune process inside of our cells in the h7 cells we tested and um uh lastly uh one of the things we wanted to know is whether or not we could um uh compete with the binding um in a uh in conditions that weren't conducive to actual infection so at um at four degrees um uh so very cold and what we see is that lactoferrin is able to um affect the initial binding interaction okay so um where do we go from here as far as drugs so one of the ideas is that we could take lactoferrin and combine it as a combination with either rem deservier or say hydroxychloroquine one of the challenges with rem desevere is that it needs to be given as an iv so you couldn't necessarily tell people to take rem de severe prophylactically because it's uh they would probably need to be in the hospital to do it um but hydroxychloroquine is a sort of a an example from this whole class of segment receptor compounds and although it's not synergistic per se it does seem that it's not antagonistic there is some some level of additive effect so you can measure that by increasing the dose of of one drug or increasing the dose of the other and asking you know does the ic50 tend to get better at some level of combination of the drugs so um if it was um antagonistic then ic50 would increase and if it was i um synergistic then the ic50 would decrease as you as you titrate in the other drug so um this is promising that that this might be a complementary pathway or complementary response um to the segment compounds as a therapeutic opportunity okay so i'm going to transition here to more computational methods and some of the modeling we did for this screen perhaps this might be a good place to stop for a sec if anybody has specific questions about the um the drug screening that we did so far okay um feel free to ask more later or not have me at any time so um going back to this idea of using science as models one of the ideas is that with these high content screening what we would like to be able to do is is is understand what's going on at this uh you know where we have this um fire hose of information about each cell so you know how do we take advantage of all that rich features in order to quantify and build models for it so i'm going to go through two tools that i've been working on one is more statistically oriented i'm calling it mp stats and the other is more of a machine learning organization um and so uh this is just kind of a an advertisement for some of the features uh for the statistical modeling for these experiments um the assay development stage for the source kobe 2 was done at a breakneck pace and um so it um it was an exercise in trying to you know use these tools um in real time so it wasn't necessarily a controlled uh you know very uh deliberative assay development process it was real learning on our feet so we're trying to um to make sense of um you know how to adjust the parameters very quickly so i'm going to go through just some examples from um a a methods chapter that we're working on to develop these tools so i'm not going to go into the biology of the screen but just just sort of highlight the types of questions we can ask for these methods so one of the things we might want to ask is you know how informative is a feature at discriminating the positive and negative controls so there's a range of different ways of doing this but one key statistic that's often used in screening is to look at the distribution of the cells under the positive condition and the distribution of cells under the negative condition and then ask how well separated are these in some you know metric or some feature or some score so um the way to quantify this is with the z prime which is some function of the standard deviations and the difference so just looking at individual features that are quantified from cell profiler here are the distributions for the positive controls and the negative controls and you can see there is some some separation right there's um you know some distribution difference but obviously it's not going to look uh super clean like this so if we if we compute the z prime score for each of the features we see that some features are necessarily more meaningful than others this was a screen for finding drugs that that acted like taxol in some sort of cancer model um so the idea is that we can take all these different features and somehow combine them together to reach sort of a more discriminative more holistic view of what's separating out the different conditions so indeed if we group together all the different features by the dye that they came from we can train these uh some sort of classifier to discriminate the cells based on these sets of features in this case we were using a relatively vanilla random forest classifier which seemed to be relatively robust and also um able to train it quickly and and compare across different conditions so if we have the in the features that are extracted from the different dyes so that in this case it was an actin hooked or tubulin dye or the combinations of them we see that there's a an increase in the z prime score so above 0.5 is generally what you would want for say a more traditional screen but then if you get up here you could see well actually it's um the part that's important is if you just have the tubulin and hooks and you don't necessarily need the actin stain and this sort of information is actually very valuable because when you're designing these morphological profiling experiments one of the considerations is that when you're trying to do fluorescence microscopy that they're each dye has an excitation spectrum so this is you shines light at it and it absorbs energy and then it has an emission spectrum where once it's absorbed the energy then it emits the energy back out that that is can be observed by the camera so what's really important is that when you have multiple dyes on a sample that the spectrum of the different dyes the emission and the excitation um are spectrally separated because you don't want one dye to be stimulating another dye and then getting fluorescence that way rather than actually having the dye uh you know fluoresce when it becomes in contact or activated as um both as a small molecule or maybe it's an antibody dye for instance or like luciferase or something like that so if you can exclude diets that are not necessarily meaningful like they don't increase the z prime score then that gives you more spectrum in order to add an additional die for maybe an additional uh cellular process that you might care about like for instance you might tag a very specific protein that you want to say how does this protein respond in conjunction with with you know the general cellular phenotypes like the size of the nucleus or the texture or you know how punctuated the staining is in the cytoplasm and things like that so so being able to sort of summarize you know um and be able to select uh meaningful dyes is a useful criteria and then another uh consideration is that because these experiments are so close to the phenotype they're often very sensitive to batch conditions so what we want to see is that across the experiments done at multiple days or across weeks or if there's multiple plates on the same day or if you have some sort of plate effects where the edge of the plate is different than that interior like maybe the temperature range was slightly different across the plate so it once you if you identify a batch effect that might might be meaningful you this allows you to design experiments that might be more uh generalizable so like for instance if you find that the edge of the plates are more sensitive than the middle you can exclude putting key samples on those parts or you could randomize the samples on the plate or if you see that there's real variability between plates then this might mean you might need to do several biological replicates across different days and then try to generalize between between those different experiments so that aim here is not necessarily to um correct in the um in the random for scores for these effects although that can be done it's really to guide the experimentalist in order to see what degrees of freedom they have in order to control their experiments so that way they can design experiments that are going to lead to better better more generalizable findings so here is sort of a scatter plot with under each one and then you can see if these scatter plots uh this is another view of it is um distributions um for uh for the individual uh treatments so um this uh framework uh is built in r it's on top of the grammar of graphics and this is really my go-to technology for for being able to make lots of small multiple plots and really map data to the visual spectrum so um i'm uh i use this every day and i i'm happy to talk with people about it if they want to come and chat okay so the other effect that can be important is um however the score is computed like for instance if we're trying to count the number of infected cells in the well is that there can be some very difficult to mitigate confounding effects so one of them that is important to check is that if you uh if your treatment kills cells then fewer of them will might look sick so the fraction of cells that are not sick might actually improve with a very toxic drug um so if you're trying to find something that's like a you know killing a cancer cell line for instance this could give you you know the exact opposite effect that you would want to see so it's important to sort of measure where you can um the confounding effects and see if they're not just uh statistically different between patches but if they're predictive of the score that you care about and if they're predictive then that suggests you might want to correct for them in kind of a causal inference way or design an experiment that mitigates these effects in some way so trying to understand these sort of statistical properties of the experiment is typically done for high throughput screens like for instance would be done in pharma regularly but they become sort of more more interesting i guess in the high content screening where we suddenly have measurements of lots of things and able to actually control for a range of different uh confounding uh dimensions i think there's some really interesting ideas of of trying to actually um use um machine learning to um more systematically correct for confounding experiments so trying to learn models for the um the confounding variables and then trying to factor that into say a deep learning predictive model so that's some of the directions that i'm interested in going soon okay and then finally the mp stance um gives you ways of fitting dose response models and other parametric forms for um for the the you know the parameter that you actually care about at the end of the day and um so many of these uh what we want to say is not just you know how you know what are the parameters what is ic50 but you know how well does it fit um is there uh other models that fit better um do we see um you know effects based on the dose and then also how confident are we in these decisions and this is um something i think is misunderstood with uh you know high-throughput experimentation is that there's this sense that we don't actually need to quantify uncertainty as you get to you know higher dimension you know higher throughput readouts but it's a bit like um saying you don't need algorithm um theory in order to work on bigger computers and in fact that the power of better algorithms improves um with better computers because of asymptotics in the same way that getting more uh more control of the uncertainty and the high-throughput experimentation leads to much more efficient usage of the of the plate real estate of how many replicates do you need and another criteria so really um i think there's a real uh room for for more detailed quantification of our uncertainty and especially in trying to design experiments that are really um trying to reduce our uncertainty in places that we really care about okay i'm gonna um transition now from statistics into um some of the machine learning and some of the um ways of of capturing the whole distribution of the of of all the cells so um it's instructive to think about uh you know the shape of the data that we have coming in so here we have this big feature matrix of a cell index by a feature index and the cell index might have some sort of different treatment conditions or plate ids and other metadata associated with it and the feature index might have you know which diet came from you know what type of is it a nuclear feature is a cytoplasmic feature and so on and so the sense is you know how are we supposed to understand this really big feature matrix and so one thing you could think of doing is um not only do we have the individual features but we have all the individual functions of all the features so um you could just picture like a linear regression we have you know all the individual predictors but we also have all the you know pairs of predictors so higher order ones and then you can think of you know very non-linear features um so you can get into you know deep learning uh feature representation learning and things like that so this this matrix is actually really quite large and and you know one natural way to sort of expand the future representation is just to say you know um what are the cells that are both adjacent to the cell on the plate or you know adjacent to the cell in the neighborhood of the feature space of whatever feature space base space you're looking at so within this big large feature matrix um now we're trying to understand the structure of what's going on here and many other bioinformatics um fields are wrestling with this idea of of this huge single cell by by feature matrix so i know uh certainly within the department there's a big emphasis on single cell trans economics and in there the feature index is not necessarily morphological features it's um you know the expression uh in some sense of of individual genes so in those experiments the dimensions might be you know um you know 20 000 genes but maybe a couple hundred that are you know highly variable across the experiment um by you know in some cases hundreds of thousands and you know i think they're turning it into millions of cells uh for you know the largest um transcriptomic experiments but you know run the mill ones are in the you know 10 to 50 to 100 000 range so here what we've got is you know 100 or a couple hundred uh morphological features and just um based on the follow-up dose response screen so not the the 25 plates we ended up with you know tens of millions of of individual cells so this becomes um you know i think pushing the state of the art in terms of you know how do we how do we handle future matrices this size is perhaps only um um uh handled at you know web scale types of questions of social media and things like that so i think you know there's some really um this is really interesting domain for uh for applying these sort of general general methods for trying to understand these big big um big matrices but um just the flavor of how i like to think about this is that really there's two complementary problems that we want to try to solve here the first is that we want to try to cluster the cells so find groups of cells that are all behaving in similar way so this might be ones that um you know have uh maybe there's mixes of cell types or mixes of or morphologies and then additionally if we can identify a subset of cells that say are permissive to infection like we were only noticing that maybe five ten percent of cells were being infected if we could somehow identify what which ones were even close to being infected then we could condition on on on those features and then we would get a much more sensitive measure of how the drug is affecting this this really the subset of permissive uh phenotypes so you could also picture this as important and you know other sort of treatment effects where if let's say you have a homogenated tissue and you're really interested in how it's affecting immune cells that if you could somehow identify the immune cells up front then you could really uh zero in on on how the uh how it's affecting those so the complementary effect is that in addition to uh clustering cells we also want to cluster you know what are the features that are really identifying distinct morphological features of of the cell so this leads to the sort of feature space clustering and here what we want to do is identify features that are really characteristic or represent um distinct biological processes and this opens up the possibility of having these be endpoints for comparing them with other methods like for instance if we are able to identify properties of the cell that are undergoing mitosis then that might be a way that we could sort of filter or merge with with other datasets but typically you can't do either of these independently and it's useful to sort of go back and forth between future engineering and um and distribution engineering okay so um um about the time that i was um doing the statistical modeling with johnny about this um design of experiments from some of the virtual screening experiments that we were doing on another project we had you know hundreds of millions of of make on demand compounds and we wanted to know how are these compounds um you know are there areas of chemical space that are more likely to interact with the receptor than not and can that focus our energy on on which ones are actually even a virtual screen into the receptor so you know we would want to find the docking pose within a given receptor and it takes some sort of computational simulation to put the compound in there so if we could somehow focus on a subset of chemical space then we can spend more time on each compound to really evaluate it closely so we i had a lot of fun learning how to do this embeddings and and figuring out how to do these large scale new map embeddings many people use t-sne in other ways but so i took some of these methods that i had developed here and we said you know what what can we do with them for this morphological profiling so just uh from this experiment um with the 17 million cells the um the dose response plates um i just want to just because this is a tools and tech talk i want to go through some of the um the you know details of how this might work so um we were running it on uh ec2 instance on amazon it's got this massive um you know 300 plus kicks of memory and we were primarily using pyro as the data exchange format in out of the s3 buckets so for pre-processing um it was really helpful to talk to josh walsh he gave me some pointers and you know how people typically do it for single cell rna seq and what we did is um do a low variance um filter for features pre-plate standardized because we did see some plate effects and then we did this seeing somewhat nonsensical thing of doing um principal component analysis where we keep all the dimensions so full rank and what this tends to do is is pull out individual features that are dimensions uh as a linear transformation that are capturing different aspects in the data so if we have co-linear features then this somehow spreads them out and helps the umap to try to converge more quickly so we couldn't actually fit all these cells and all these features um into memory so what i did first is embed two million cells um using uh these parameters for the umap which took about eight hours per run and then um we re-embed the full set um in batches uh one at a time so once we had the projection onto the two-dimensional surface then we could uh put all those cells onto them so i assume you all have at least heard of u-map embeddings the stochastic neighbor embeddings of some sort but the basic idea is that we have these high dimensional uh representations we're trying to project it down and we want to not just use principal component analysis but we want to use some sort of non-linear uh projection to maintain cell uh some sort of notion of distance and uh there needs to be some sort of um resolution at which the distance is measured so either the very fine grain distance or sort of the global picture and you map for for a variety of reasons has um relatively good default parameters for um for coming up with um with embeddings that look um somewhat sensible and then finally we used um pi viz and jupiter notebooks with holovis and data shader for visualization so i'm going to go through some of the controls that we looked at so we could look at um you know how do the embeddings change across plates you know are there differences and we do see differences in bedding so some some of what they're what the embeddings is learning is the difference between the plates so we have to sort of be careful of that and make sure that we're interpreting things appropriately additionally uh the embedding process is random so if we start with different random seeds we get different embeddings um although you can still see that there's this large cluster in the middle and then there's i think if you squint you can find many similarities between these different ones so we're relatively happy with the reproducibility as far as the random seeds come and then to look at these we identified regions of interest and from that we were able to go in and look at the cellular phenotypes from cells in those regions and also how their distributions change across drugs so we use cluster 15 as a reference and then we're able to compare other clusters and say which features are important for discriminating with cluster 15 and how do drugs affect it so this was a cell division cluster we found this very punctuated cluster on the side and then additionally we found that cluster three and four which are over here as well as one and two are are primarily the infected cluster and indeed drugs that are effective at blocking the level of conductivity also reduce the density in those clusters so if you look at the treated and untreated and no virus controls the negative and positive controls you see that this large cluster really disappears in the no virus so that suggests that those are the infected cells so if we took i took this cluster and then re-embedded that so it's 2.4 million cells and we get a new embedding and now we can ask you know how are the drugs affecting the different cells you know are there different ways of processes along the infection process so looking at individual features across here one of the things that we see is that most of these cells down here are the ones that are actually infected and the ones that are up here are just adjacent to infected cells so the red points here are ones that are coming from here and there's eight and two are on ones that come from clusters that are down in this region okay um and then if we pull out individual cells we can see that there's different phenotypes for the actual cellular morphologies and this gives us hypotheses for for you know mechanisms of action at these particular points we understand something about cell biology based on steering in a lot of cell pictures and then it gives us a real intuition about you know which processes are involved is it um the phospholipidosis for instance um so just uh one way to quantify this is to look at the relative distribution of of different clusters of different drugs and so we see ones that target the cellular entry process sr1a and the z-a-f-m-k have a different distribution across these different clusters as the um as you increase the dose of the drug compared to ones that may be mod um modulating the viral replication process you know the rna transcriptional translational okay so um i'm i'm just about out of time um thank you for your attention um i'm happy to stick around and answer questions but um thank you very much for for uh coming out okay i i appreciate your attention if you're still here thank you very much thank you matt for your seminar good talk okay see you next time
okay uh first uh thanks to AR and mercy and the department gave me this opportunity to talk about the work from our lab and uh my name is Kai and uh I'm a second year post do here uh in Marine solds Lab and uh originally I'm from China and I've been us since 2014 and I got my PhD from uh mam University Ohio Oxford Ohio and I moved to Michigan uh early 2019 and uh my research work is uh mainly focusing on um it's in a coll collaboration with Dr D Dina dooi uh who is a professor in uh School of Public Health uh work I'm my research work is mainly working on target to consult which is related to the apically uh modification of environmental uh exposures and today uh the topic I'm uh giving it uh work that is published uh I think it's early this year and uh I just use a title from the paper that we published and the title is uh testing proximity of genomic regions to transcriptions St sites and the enhancers complement uh uh Gene and enrichment testing and uh this paper is published on uh from T in genetics and uh he okay so the background here is uh gen set enrichment methods are commonly developed to determine the passway associated with genome wi s data like a chips data and aex data and uh but most U GSC method were developed for Artic data which is not adjusted for the various length of genes or regulation regulatory space between them and um they are not like U developed for uh uh GSC testing with large set of Peaks and there are some methods that are developed for U do the GS testing of Peaks but they are mainly focusing on the relationship between the paks and the TSS but in reality uh not all the paks are like related really related to TSS in here because we we use a lot of chipstick data so I just State transr factors here so not all the transal factors are tend to bind to the TSS some of them are tend to B to enhancers so the question is that so whether a TF is Bing to the the the enriched gen set it's whether the TF is because the the TF is sping to closer to a TSS or an enhancer or both or either of them and to our knowledge there's no method like like developed to answer this question so uh that's why we U developed this uh method called proxy R it stands for a proximity regulation and uh this method is like a kind of straightforward so there are like a many three steps so the first step it's uh we measure the distance between the Peaks and the the clest TSS or the enhancers and then we normalize the distance based on the G looks length for the distance between Peaks to the TSS and the average distance to enhancer uh to the peak the distance between Peaks to the enhancers and then we test whether the peaks in a gene site are significantly closer to a TSS or enhancer than expected by chance and we use uh W cin rank some test so for the materials and methods uh so the data set we use here uh uh we downloaded 19 human chipstick data set from encode and uh there are 35 TFS in those 90 chipstick data set uh over three cell lines and the Gen set we used is uh from the go. DB Bell conductor package and package and uh we only use the the bi biological process go go terms and we not use all of them we only use gen set with larger than 15 and smaller than 2,000 genes of the go BP terms because uh if because if a gene set have uh is like a very small Gene set we have like a very little statistical power and if the gene set is too large will be hard to have meaningful biological interpretation so that's why we only choose the gene set with those numbers of genes and uh in total they will have like 5185 gobp gen sets and so for the first step it's uh is measuring the peak distance to the nearest TSS or enhancer so for here uh so the regulatory uh proximity was defined the distance in B pair between the peak's Middle Point to the clist TSS or the middle point of the chisa enhancer region and the TSS location we used from those two uh bioconductor packages and the enhancer regions are defined by the union of the DHS sites and also processed by incode and uh so the uh disto and the non-promoter elements were defined as those like like 5 KB away from the TSS like the figure shows here so uh so in here we call the enhancer but it's not only uh it also like include other other elements like uh silencers and insulators but we all call them enhancers all the distal and non-promoted elements like a in this region they will we will use them as like an enhancer in here so we will measure the peak to the distance of those regions and the peak to the corresponding TSS to test whether the related Gene of these Peaks is like a the gene set is enriched it's like a more closer to the enhancer or to the TSS and uh uh so for measuring the the distance between Peaks to the enhancers or TSS so first step is we need to uh assign the Pak to genes to do the gene set enrichement test so first is we we need to measure the distance and then we need to like assign the P to the genes then do the test so so first is like uh because for here we want to test whether the the the gene set is closer to TSS or uh closer to enhancer so uh for the TSS part we use we Pi we we assign the paks to the uh near to the Gen by the looks definition is like near is the ptss so this looks definition is is from the chip chaping reach package it's a paper that the L lab previously published so in here it's like the Gen Locus definition is something like here so those points here it's a middle point between two adjacent TSS so in that way uh for this blue jean in this figure here those two peaks will be assigned to the blue jeans because they are like located in the gene Locus in this Gene Locus and this Peaks uh is like a located within the yellow Gene so will be assign to the yellow Gene and uh yeah so here is a definition of the gene lookus length so the length of the region on the genome such that a peak bonding in the region is line to that Target Gene which means for example so for this yellow gen so the gene looks length it's like a the length of of this yellow bar here and uh for measuring the distance between the peak to the nearly TSS uh we we found out that as a jeans with a longer Locus length the the the Peaks will be like a far away from the Gen TSS so that's why we need to do uh the normalization for the Gen looks length so we found that the Gen looks length is a potential confounding uh variables to this problem so how do we do the normalization uh it's something like this so This figure is like a a uh like a example here so uh we will like uh normalize the distance uh of the of the peak distance to the TSS like in this way so first we will combine all the 19 chips data together and then we fitted a cubic smoothing spine line like something like this and uh so the in this figure the x axis is the Gen looks length and the y axis is the log distance to the uh TSS so so the the the the fitted line here we provides expected global average binding distance for each gen so the adjusted distance to TSS equals to the the distance of T the original uh distance between the two the TSS minus by the log of the values from this line here so in that way after normalization uh PS that are closer to a TSS that insed based on the on this line on the value on this line will contribute to a sign ific promoter proximity for our gen site and uh similar to the normalization for the distance to the TSS we also like normalize the distance to the enhancers but it's kind of a a little different from the TSS so for the enhancers also uh it's like if the enhancers uh it's like they are far away from each other so in that way so the paks the distance of the Peaks we like far away from from the the enhancers but the but another thing is like uh this like distance is also related to the distribution of enhancers uh of each looks definition like uh in this figure shows here so so so the density of the enhancer P gen is like a kind of a confounding variables for this problem uh so for example so when we do the do this analization what we did is it's similar to the the previous one so the we also fitted a line based on the all 90 chips data set and the x-axis here it's the average distance to enhancer for each G and the Y AIS here it's the distance to enhancer so the adjusted the distance to enhancer will be like the distance to the enhancer the the to the nearest enhancer minus by the values from this line here and for example when we so x-axis here is like for each for this peak will be assigned to this Gene and within this Gene Locus Locus there are three uh enhancers so we so we will like calculate the average distance of this Gene and the distance to the uh enhancers it's like it will be in the x-axis here and uh uh the Y AIS here is like the the clest uh the distance to the clest enhancers which is like this one here so so then we can like adjusted the the distance uh by this value minus by this value and uh yes so in in that way so it's like we will like normalize the distance to the the paks to the enhancers and after that um for example if for if we have a TF we have chips data set here so we will like calculate the distance of all the paks to the promoters and the enhancers to the TSS and to the enhancers and then we will assign those uh PS to the genes and then like then we will have like a like a this so after that it will be like a normal GSC testing um testing method so we will have like a gene set of interest and the other gen set will be like used as a background gen set then the the the thing that we test is test whether the paks in the in this Gene set are significantly closer to the TSS or inhancer and uh and uh in order to uh make sure that uh our method is is good is a good way uh to to answer the questions so we uh we use different three different ways to test the type one error rate and the first one is way like array assigning the every PS to a random Gene and in the second way it's like a we reassigned uh every Peak to a random Gene but all the genes were ranked by the lucus death lucus length and bend into 100 genes so it's like a randomly gen set and with uh those genes are like a similar Locus l so it's like a this is for the uh this to the TSS and also the Third Way is like we uh reassign each pig to a random Gene but all the genes were ranked by the expected distance to enhance and bend the genes into a set of 100 so those uh three like randomly a s was using was used to uh test as the type one error rates and so the results so for here it's uh a workflow for the pro rag so our method is like a complementary approach for normal JS test so in that way it's like a uh so the user will like put the input will be like a genome region of in in sorry so input will be the damic region of Interest so we be like the chips data results like a lot of Peaks and regions of the G and then in parallel so we will uh run the pro R which is in this way here so it's measure the distance to TSS or enhancer and in parallel in other way is like we assign the P to genes to do like a normal gen set enrichment test use a same gen set database and so then we will do the prox U proximity test and the enrichment test and then combine the result from them together because in here we will test actually we will Tex twice so one for TSS one for enhancer and so when we combine those two result together we will have like a figure like here so uh in here is like a here is the promoter result which is like the to test whether the gene the gene set is significantly closer to the prer TSS for the enhan result is like whether the to test whether the Gen set is reached that by the they are closer to enhancers and uh so for here the Y AIS here it's the uh result from the proximity test and the xais here it's a result from the Gen and enrichment test so in that way we can see that if the Gen set located in here which is like uh with a which is like a closer to the promoter and also enriched if it's in here it's like a uh far away because this is enhanced results if look here which is that they are far away from the promoter they are far away from the enhancer and also so from the for the uh TP one error rate and the false positive rate so we use like the three different um three different n data set to do this test and uh for the for the P value like smaller than point5 C off we expected the tyon error rate approximately to five% and um so here this one is for the um for the results of to test the uh distance to the TSS this is to the to enhancer so is it looks like it's not like exactly uh equals 2.5 but it's very close and for here also we choose a P value smaller than 0.01 so we expected the T Point error rate is about 0.1% and this also it those result like very close to the value that we expected so after that uh so we want to see uh how our uh method per from uh on real data set so we like use our method to process all the 0 chipsi data set to see how they looks like and uh so for here U so this is like the uh so majority of the 98 chip sign set shows a strong negative correlation which is looks like this so for those two figures uh so the xaxis here is a promoter results and the Y AIS here is enhancer results so a lot of uh chipstick data set that we used in in this research it shows a strong negative correlation which mean that uh the some of them will like very close to promoter some of them will like very close to enhancer but some of but a small amount of the DAT chips data set it looks like this so it's it's not like a clear patterns so then we want to to like a then we did a hierarchic clustering to see is there any like a different regulatory patterns of those TFS so when we uh do this um so here is a results um and we uh here's a results and how can we uh do the hoking clustering it's basically uh we divided the uh those two figures like into different four regions so we just count the numbers of the Dos in the four regions so one so each uh chips data set will be represent as eight numbers and for example for for this one so this is a promoter results and U so the x axis here it's a gsse P value and the y axis here is a proximity P value so if uh so we so if the doubt is like in this way with a larger number on xaxis we'll be like more enriched if like a a Lar lger number on the y axis will be like closer to this region and so when we count those numbers we just count the how many dots was in this four regions and the black dots here are not significant one so we didn't count them in we just count the significant results for both the gsse uh gsse uh test and the proximity test uh so here is a result of the all the 90 uh chipstick data set hering clossing results and uh it showed that there are like a three uh different groups so the first group it's like the blue groups here so those uh TFS they shows a pattern that they are more tend to be closer to promoters and the second uh group is the like the purple group here so there's like only 11 of the data set shows in this group and those groups they are like more like a those TFS are like more tend to finding closer to enhancers and uh the remaining like a 302 group data set is like they didn't show like a clear patterns so for example so for this one this is one uh one uh Result One data set from the uh blue group which is like a show a clear pattern that those Gene set are enriched by the TF that are binding close to the promoters so in the promoter results there is a clear uh positive correlations which is the do are raing here they are like enriched and also closed to promoter but in the enhancer corresponding enhancer results so they are also like enriched but they are like far from far away from enhancers so in the purple groups uh it's like the pattern is look at this so they have uh like a a clear negative correlations in the promoter results which is those like a genap they are uh enriched but they are far away from the promoters but in the corresponding enhancer results uh they are also like enriched but they are like a closer in this region which mean they are closer to the enhancer and for the third group so those uh the result looks like those two figures so in the promoter uh results and the enhancer results there's no clear pattern to show like a positive correlation or negative correlations but those are like a they're not clear they didn't show like a clear uh bonding proximities and uh okay one second this is Mercy there's a question in the chat and so I just want to make sure before you get too far along uh the question is how are true positives defined for benchmarking oh for the true positive um we actually we uh we collect a lot of the uh chipstick data from let me remember sorry we we collect a lot of chipstick data from uh uh from I think it's from let me I think we collected from the bio conductor packages and uh to do the test uh I can show that figure later because that figure is in supplementary figure uh okay uh so uh for here uh after we finish like the uh GA three different pattering uh so we want to to identify a no association with promoter enhancer ban to to to to see that okay so the result we found is like a real real result uh so so for the promoter uh uh bindings here so we selected this uh transcrip factor it's called 65 in this St line and this uh TF is involved in the determination and maintenance of the r now formation and it's is also well known to bind to promoter regions of R gen so the a figure here it's the distribution of distance from Peaks to nearest TSS of this data set so we can see a clear Peak here so which represent that U the distance at those like a paks is like a very uh closer to the TSS and uh here is a promoter results of this data set and here's enhancer uh results so we can see a lot of uh gen that they are in here but in the enhancer uh results like flip over in this region so which mean that uh those gen that are like more tend to be B to the TSS and the far away from inhance and uh in details we selected two like gen set from those figures so gen set one and gen set two and in here uh so the Gen set one this uh graph is the distance to the near TSS so we can see in this Gene set which is like this gen set in here there's a clear Peak that is like in here which is like a closer to the TSS and uh in g 2 here uh we can see so inergy is also because it's located in here so we can still we can see a peak in here which is like a far away from the TSS but the clearly the big pitch is here it's also like a near the so in the enhancer results uh also it's like the the G the the first gen set will be in this this in here and this one will be here and we can see so for G set one for the the distance to n enhancer which like like a clearly Peak here which is like a forward from and for the Gen 2 which is also like a clear Peak here also have a small P here because this one we have small P here so this is is example that is uh known that those TF this TF is like a closer binding to the promoters and for the enhancer bindings we selected this uh transform Factor uh which is uh the n rsf in this cell line so this uh TF is known to silence neural genes in non neural cells and act as a transal repressor or enhancer of Target genes so those are those this trans Factor are often reg from the enhancer regions so similar to that one so the distribution of distance from P to near TSS we can see a a peak in here which is like a far away from the TSS and here it's a promoter result here is an enhancer results so we can see we also like selected two uh two Gene sets to to show the the distance to the nearest TS so we can see the this G one Gen 2 They al both of them shows like a clear Peaks that are far away from the tsf and uh in the enhancer result it's like a both of them are like in distri region and we can see there's a clear Peak that is in here and here which is like they are closer to the uh to the enhancers so uh so after that uh so we want to see so if the those TFS they have like a clear patterns in different sine so how are they like how the regular patterns in the different selin so we we selected this also this NSF uh transp factors to see how the recation patterns in different s lines because in here we have like three different s lines so in this key 562 and GM s lines so uh like it's like this one this one all the like significant go terms identified by both ping R and appro R were found like they are closer to enhancers but in this L is like a totally different scenario so almost all go terms are closer to promoters so which is like a very interesting because because in different s lines the same TF may have performed like totally different types of the uh regulatory patterns so so the summary U of of This research is like we uh developed U this uh gen genomic region proximity test called prox that can be used as a complimentary method for the normal J test and uh it can be used with various types of genomic regions including chipsi data Tex data DM some others and uh and it's able to find gen C with region that b significant closer or farther from promoters here and this method it's uh a available at the chip seeking chaping reach B conductor package and uh and uh here's our lab and uh thank you and I will like to answer any questions okay for so first uh okay let me answer the first question for the true positive uh okay uh for the true positive uh um what we used uh oh because there's no like golden standard data set that clearly shows that all the uh so show that this uh transmitter factor it's it's like a closer to uh Promoter on enhancer so we used uh the go BP terms from the or ghs uh B conductor packages and we tested let me open the uh supplemental figure hey appal oh yes so so for here uh to support the idea uh of this method so we compared the percentage of the gene the promoter C with chipstick uh in assign go terms and not in the uh and not and the PS that not in the assign GOP terms for the TF and U uh so all of those TFS are from the this b b conductor packages and uh that so this figure show that uh this this figure show that that uh most of the chipsi data said uh in this paper it shows a higher percentage of gen in the TF assigned goal terms with PS in a promoter region then the Gen are not in the TF assigned goal assign the go terms so basically we we use terms uh from this packages to do the to define the benchmarking stuff it this okay uh the second question this interesting this pattern fit what's going about here each like to all c c Mak the for enance and promoter oh for part two uh let me for p two uh let me see where's two oh for Port two uh I think it's one is here one is here one is here yeah all of them it's uh for Port two it's like all of uh them in the three different cell they they are located in this region which mean that they all of them they have like a pattern like in this like like this and uh how do that fit with 3D proximity between oh that's actually that's that that's a problem because in in this paper we assume that the the peak like will like uh regulate the nearest genes that's why we we tested the near L TS and the near enhancer but uh we didn't count any like a 3D uh proximities in here I think that's that's a limitation for this method great are there any other questions at this time all right so I don't see any other questions um in the chat box and doesn't sound like anyone else is uh unmuting themselves so at this point uh I will say thank you K I think we can uh stop the recording okay thank you
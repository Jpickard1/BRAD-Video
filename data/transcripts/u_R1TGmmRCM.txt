but there's a sign in sheet going around do you please sign it also just to let you know there are a couple of dates in April where the talks have been rescheduled one has been rescheduled to later in May and the other one will be has been rescheduled for the fall so that I'll come out in the email that I send out next week but just to be aware there are a couple of April dates for on the seminar soon will be cancelled um so they say today is going to talk to us about formulating multiscale hybrid models to describe us this infection okay thank you very much thank you for allowing me to talk today sure that's the best so like Marcy just said I'm gonna talk to you a little bit about multi scale hybrid models so not really one topic lots of different topics and then I'll talk to you about how we integrate and connect these different models to address multi scale biological questions so first before I get into the modeling bits a little bit of detail or background about tuberculosis it's a global health problem there's about 9 million new cases about 1.5 million deaths every year and it's belief that one out of every three people meaning that you have the bacteria in your lungs but you're don't have any symptoms so this is just a wh O's map of TB incidents and you can see that it's not very equally distributed lots of high incidences in sub-saharan Africa and in Eastern Europe so quickly about the disease it's caused by infection with Mycobacterium tuberculosis you inhale the bacteria and it seeds in their lungs it's mainly a pulmonary disease but it can spread to other parts of the body and symptoms include coughing weight loss fever and night sweats so just going through the typical infection progression a certain percentage of people will actually clear the infection we're not sure what the steps or the progression is to be able to do that but we do know that it happens about five to ten percent of people will progressed to active TB disease but the majority of people will develop this latent intonation if you are lately infected there's about a 10% lifetime risk of developing active TB or what they call reactivation TB but this percentage increases to about 10 percent yearly risk if you're HIV positive although the majority of people will spend their whole lives call it kind of culminated by this bacteria without ever developing disease and so like I said the bacteria seed in your lungs and then they form these things called granulomas and they're very structured immunological kind of tumor like structures they have an AC and which is a necrotic tissue on the inside it's surrounded by macrophages and then the like a lymphocyte cough mixed with macrophages around the outside these structures are very variable they're dynamic and they're very heterogeneous and so this is where the bacteria lives during infection quickly about tuberculosis treatment a lot of the problems that arise with TB treatment is because of the long treatment requirement typical treatment consists of six months you take four antibiotics in two months and two more antibiotics for four months and so compare this to your typical antibiotic regimen that takes you ten days this is a very long treatment and so this long treatment leads to people not taking their drugs I take the drug for a couple of weeks I start to feel better and then they stop and so that list this led to the whu-oh implementing dots which means that you go to the clinic somebody watch you take your dogs every day or as I do here in Michigan the nurse will actually come to your home and watch you take your drugs there but so that helps the compliance problem overall TV has pretty good treatment success eighty six percent which is a good percentage but because of the magnitude of the infected population that still leaves about a million people without successful treatment every year and as you can see again there's a lot of variation by region based on the treatment successes so if we think a little bit about the scales of M TB infection it goes from molecular scales where cytokines and chemokines interact with host cells all the way up to population scale where people interact and infect each other and so questions that arise from these multiple scales is why do we need such long treatment regiments why is T V so different than other pulmonary infections and also we know a lot about these molecular mechanisms and so the question is which one of these mechanisms are driving infection outcomes at the population or at the host scale and these kinds of questions are very difficult to answer in experimental models non-human primates are really the only animal model that reproduces the human-like ecology for TB and in vitro data captures little bits of information on individual molecular cellular scales but it doesn't give you a good overall idea and these lower scale mechanisms are very hard to study in vivo because you need enough sample to be able to analyze them and so it makes it an ideal problem for computational methods to tackle and so quickly an outline what I'm gonna talk about today I'm gonna talk about choosing model types to match your biological system so the scale where you are as well as matching the questions you want to answer so you add as much detail do you need to be able to answer the question you want and then I'm just going to talk about a few different model types and then talk about them kind of with TB as an example which is what we work on and then finally just sensitivity analysis which is an analysis tool for you to determine how sensitive your whatwhat outputs are to different parameters so first I'm gonna start with Asia based models and how we use them to describe TB granuloma formation and so the question we had here was which cellular level interactions drive the tissue scale outcomes so what cellular mechanisms aren't hopeful to form these instruct these in the in structures called granulomas and so forth deciding which model we're going to use we need a model that allows individual host cells to act on their own and for us to then look at collective effects that they have at the tissue scale he also need to be able to capture the variability in the biological system because all these granulomas are different we need to have a stochastic component and as well from biological data we know that the structural aspect of these granulomas are very important and so we need a model of it to capture that so the one that kind of kicks all these boxes is agent face models and so it works kind of connects this cellular and the tissue scale questions okay so a brief over love agent based models they typically have three components you have your environment your agents and rules and so your agents are individual computational entities and rules are kind of based on their individual desires and beliefs and you define that based on the system you're gonna look at these agents then interact with the environment and make certain decisions about the action they're going to take their decisions are often based used using probabilities and random number generators and there's a lot of software packages available that has the structure for building these agent based models available like that logo where you can define your individual agents but the structure for building these models is there and it has a lot of applications in animal behavior and human behavior but also in cellular behavior which is what we're gonna look at so this is our agent based model we call it grand sim for granuloma simulation our environment is a representative of lung tissue and it's just a square two-dimensional grid where the agents move around and interact our agents are bunch of different immune cells macrophages in various stages of infection and activation t-cells and the bacteria and the rules are cellular interactions that is based in biology on in vitro data and so forth and so we seed the simulation grid with a single infected macrophage in the center and then let the simulation run on its own and let the granuloma evolve and so we get these kinds of granuloma formations emergent behavior of the system and along the way we also calibrate to non-human primate data so we have collaborators that have the primate model TV and they measure see if you person or a number of bacteria per granuloma and so we use that data to calibrate our model too so here is a little movie showing the granuloma this is really zoomed in and so here is the outline of our simulated granuloma the green cells are resting macrophages the blue ones are activated here's a little pocket of infected macrophages and this white stuff in the middle is the casein that our product issue that I talked about so this granuloma is about 40 days old hopefully you can see it go you can see the infected the infection kind of moving around the granuloma as well as the KCM expanding and getting more necrotic and so the kinds of questions we can ask that this model is for example related to TNF alpha and to use ptosis so one of the mechanisms built into the model is TNF alpha in the granuloma causes host cells to have octaves to die and so since we have a computational model we can knock out individual mechanisms and see what kind of tissues that leaf exit has and so here if you knock out that you never do ptosis you get lots of cell infiltrates you skip lots of activated cells in blue and if you knock out that TNF and TNF secretion as well as apoptosis then you get a more contained granuloma so this shows that the TNF induced apoptosis helps control inflammation and so this is an example of how a cellular mechanism as tissue level effects and the model can I can identify those and so next we're gonna move to OD YZ which most everybody should be familiar with and we use that to describe receptor ligand dynamics in our granuloma and so going back to TNF alpha it's an inflammatory cytokine it's been implicated in TB disease severity and you've also identified class I just showed you it's an important factor in the granuloma development and so our next question is which molecular mechanisms drive TNF alpha dynamics so now we know this molecule is important we want to ask four questions and so we need to add more detail and for this model choice we know that we need a model that can track a lot of species and we know that we can assume that locally the components are well mixed so every cell is in a great compartment and so it has access to the molecules in that great compartment which we can assume is well mixed and so therefore we chose a know de model from this and here's just a schematic of the tnf-alpha dynamics as you can see it's very complex there's two different receptors membrane bound and solubility and if there's a lot going on and so we built this of the e model and so every set of differential equations represents one single cell and so now we have to put connect this early model to the ABM model and here's just an example of information exchange between the models so here's our simulation grid there's a host cell agent right there and it has this system of OD es operating inside of every agent and so for every single agent in our simulation grid you've solved their own leads for their specific properties and location we determine the properties like for instance IRB with which represents tnf-alpha and then make agent based decisions on their local environment and so these OTE sends information to the agent which makes it effects a decision and then has a certain behavior on some of the predictions that came out of this is there's an internalization rate for each of these receptors and what this model was able to show is that the internalization rate is a major driver of TNF dynamics and so if you see here is increasing internalization gives you increasing number of bacteria and you see that down here too you see lots of inflammation if there's no no internalization and lots of bacteria if there's high internalization so we were able to answer molecular scale questions using this multi scale grants and so finally we use partial differential equations to calculate molecule diffusion and distribution on the grid the question here is what are the spatial distributions and does it could contribute to the infection outcome we needed a model of spatial and temporal dimensions and that contracted distributions in a district ice create that represents a continuous distribution of molecules and so now we have three components we have an agent base and ordinary differential and a partial differential equation model and so the PD es track the distribution of molecules which feeds into the OD es which gives your agent a decision a decision which plays out on the cellular scale an agent movements again affect their their Oh de states which secretes or the grades molecules which again updates the molecular distribution on the grid so there's a continuous feedback between all of these models and so the predictions using the PD es is that we'd see the sharp gradients for TNF more diffuse gradients for antibiotic in the granuloma because these molecules are much smaller and so in and he's a lot a lot more clean and so next I'll talk about the sensitivity analysis tool which should be called LHS grcc and so basically you have your model that has n parameters and our outputs and you want to know how sensitive are the different outputs to each one of the parameters what you can do is vary each parameter so sample parameter one parameter number one might have a completely different effect for different values of the other n minus one parameters and so really you need to vary all these parameters at once and so what we do is we use that in hypercube sampling or LHS which is a method to thoroughly and equally sample the parameter ranges we vary all these parameters at once and they calculate their partial rank correlation coefficients with each one of the outputs and so that way you get an idea of the parameters influence on the output in the context of all of the alcohol all of the other parameters as well and so here is a fun table to not look at so this is just a sensitivity analysis of the model that I just showed you for antibiotic treatment so here we have a bunch of different parameters and here we have treatment outcomes like total bacteria at time two clearance and so we see that the host parameters are important for untreated granulomas but they continue to be important and treated granulomas saying that the host continues to play a role even during treatment so next we're gonna move to a little bit more detailed model of the bacterium itself and so just a little bit of background on the bacterium it grows inside macrophages it can slow or stop its growth when it's stressed under hypoxic conditions or low pH and those are conditions that we know exist in the granuloma when they slow their growth they start to accumulate lipid inclusions which is just a fatty acid kind of bubbles that accumulate inside the bacteria they change their metabolism when they're inside host cells so there's a metabolism it's a light exchange between the host cell and bacteria we know that fatty acids are a major carbon source and host cells and we also know from a recent single-cell experiments that there's a lot of heterogeneity in in the bacterial population so these are all things that we want to build into our agent base model to be able to probe the roles of all of these different hoodie's on the tissues go out comes to the granuloma so that's kind of what I just said we want to look at the nutrient environment the granuloma and how it affects bacterial phenotypes and so the model choice here kind of has two components first of all we want to capture the bacterial variation so we need to build bacteria into the model as agents whereas before they were continuous variables represented on the grid and some of the second part we want a model that has metabolic detail and few parameters because if you think about a metabolic Network you guys know that there's a lot of metabolites and reactions and we don't want to have to fit parameters for all of those and so flux balance models are wait capture a big metabolic network without all of the rate parameters so we'll do the individual bacteria first and then the flux balance model so first tracking individual bacteria now we built the the bacteria as agents and defined their rules if your nutrient conditions are good enough then you get bigger if your size is bigger than a division threshold then turn it to bacteria if it's lower than cell threshold you die and if you're near a host cell you can be Bankside chips with a certain proper course we also do a bacteria at the bacterial agents certain properties for example we give them a biomass be able to track how big they are we track how much lipid inclusions they have because these lipid inclusions can act as carbon sources under carbon start conditions and so now we need this model to translate these properties into growth rates and that's what the flux balance is for and so a quick overview of flux balance models is first of all you need to define the metabolic Network which that is a feat in its own and luckily other people have done it and so for MTB we end up with about 700 reactions and metabolites and the next tip is to put your metabolic network into a soy kiama tree matrix as well as your constraints and our constraints here are oxygen levels fatty acid levels pretty much available nutrients and then finally you define your objective function for most FBA cases people use biomass as an objective function and that just says the bacteria will grow as fast as it can always which we know is not the case for TB and so what we do is we make a linear combination of biomass and lipid inclusion production saying that under high oxygen conditions the bug will grow as fast as it can but when the oxygen starts to drop the bug will start to deprioritize biomass production and start producing lipid bodies instead and so the final step is just to use linear programming to find the optimal flux the maximum flux through your made of all like network into your objective function and so this is just to show that we include the nutrients on the simulation we have oxygen gradients and fatty acids fatty acids are deposited when host cells die because we know that the casein kind of consists of dead cell debris and so the information exchange between the agent based model on the flux balance model for every bacterium we take its nutrient and phenotype information and feed it into the flux balance model which then does the optimization and predicts a growth rate and lipid accumulation rate and so we do this for every bacterium in the model which is computationally even though FBA or fbm in the scheme of metabolic models is fast this is a lot of computation to do and you have thousands of bacteria in tens of thousands of time steps it takes a lot of time so what we do instead is make look-up tables and so we use the five inputs and the six outputs of the flux balance model and we build big look-up tables using the NVA and we build this table once and so now every time we want to determine how fast the table is growing we just go to the lookup table and use multi dimensional interpolation to estimate the growth rates and so the spinal model has the host component it has nutrients built in and it has pathogen detail built in so now what can we do with it the nice thing about this is that we have information for individual bacteria so we can look at distributions and variations between bacteria and so what I'm showing here is the distribution and relative frequency of bacteria according to their generation times or the time between their last divisions and so longer generation times means slower growth and as you can see for later days during infection the generation times keep getting longer and longer so Inspectorate progressively slowing their growth although you do get a pretty wide range of generation times and so we can also ask what are the instantaneous growth rates that drive these generation times because what generations like could be function of many different growth rates throughout the bacterial life time and so we see a wide range of growth rates even at early time points where the generation times are short there are some bacteria that are not growing very quickly and so that's so they actually observe other observed cases of my factory dividing them fastly things that three days between yeah well the D B's typical generation times about 18 to 24 hours which is really slow already by bacterial standards but yes they do see there was one study it's really hard to measure growth rates in vivo because you just can't get enough sample to do those kinds of estimations but these are all with it previously seen growth rates and so if these are the kind of growth distributions that we're seeing we can also go on step further and say okay well what are the nutrient conditions driving these kinds of growth factors because you can get a slow growing bug a bunch of different reasons and so now what we can do here is just an example granuloma at different time points as its evolving we can take bacteria from all of these time points pull them together and then cluster them based on their available nutrient conditions so we're saying of all these bacteria what kind of nutrient conditions are they seeing and so if we cluster them this way we see that here in oxygen there's a big division based on available oxygen and then we could take it one step further and start to characterize these clusters that we just made these color codes are just showing the different clusters and so here's the panel that I just showed you for clustering and then this is another panel just to heat in that panel showing characterization of these clusters and so the first thing if you want a nine point remember I put four time points together is that the time points really cluster pretty close together except for they 100 and 200 and so that suggests that the major nutrients change azar happening over time rather than spatially we can also look at some specific growth characteristics so we look at their effective growth rate in the early time point there's two groups one that grows pretty quickly and another one that grows slowly and if we look back at the available treants we see that this slow growth is due to limited carbon sources and so if I go back a little bit you can see that there's high bacterial loads in the center of that granuloma and so there's big bacterial expansion without a supply of carbon sources from Xhosa cell death at that early time point and so that's why these bacteria are growing slowly we can also see the switch from effective growth rate from growth to lipid inclusion production somewhere between a 60 and 100 and that is due to the hypoxia stress response under the low oxygen conditions and so the other thing we can do is take these clusters that I've color-coded here and map them back to locations in the granuloma and so this dark blue cluster the slow growing one that I just show you can see that they're all in the center the granuloma where there's high competition for nutrient nutrients and you can see again that the clusters the colors changed more over time you don't see a lot of variation within a single granuloma again saying that the major changes are over time so just kind of to summarize the the bacterial part of this there's a range of nutrient conditions over space and time with the major changes happening over time and there can be multiple kinds of slow growing bacteria and so just kind of an overall summary we need hybrid and multi scale models to be able to capture biological systems that happen at different scales it needs to be hybrid because that way you can match the model type to the questions you want to ask and get the most information and it needs to be multi scale because biology has multi scale and so I just like to thank my lab members and our collaborators that did a lot of the flux balance models at Johns Hopkins I'd be happy to take any questions [Applause] that's something that we're planning to look at is so for these kinds of growth distributions can we connect the bacterial distribution to some with a granuloma characteristic and so we would do another sensitivity analysis for that in which we would clear your most parameters and they look at the different bacterial outcomes and so then your parameters would be things like TNF secretion rates or rates of apoptosis and stuff like that and then we can track yeah I mean there's so much data in here that it's always hard to get a good handle on it so at the bottom level you would generate a lookup table he's gonna cascade that and you fill that in and like the next level can you also do a generator look-up tables they just want to take note you can finish li pre pre calculate a lot of the ranges of things yes and that's something that Denise and Jennifer my advisors talked a lot about they call them tunable resolution is you turn the detail on and off as you need it so for the Eau de tnf model that I showed you the question there was about T and F receptor dynamics and so you need to have all that detail but you can also fit a much simpler obe model that essentially immortal reduction for that whole system so when I want to look at bacterial dynamics I don't necessarily need to know how the teen it happens I just need to know that it happens so I can turn that eat a law okay or strain it and so it's not a lookup table but it's kind of similar it's a course great strategy such a seraph curiosity about the bacteria the you mentioned that it has a lot of heterogeneity does it come from a higher education rate or is it the rate replicates and maybe incorporates other or DNA or something better so you're reading an important question that there's phenotypic and unit is a big variable right in MTV and what I showed here is all phenotypic so it's just regulatory responses to the nutrient environment we haven't added the mutational aspect to it it's something that we hope to look at because different lineages of TV have different mutation rates and so they think that that is a big factor in drug resistance development because the higher mutation rate strains would develop resistance at a higher right so this is all phenotypic there's no genus of activities but it's an important thing to look at so this so does this kind of behavior that you looked at does it work well with the person to prescribe the intervention that you described because you said there are four antibiotics and then there's a switch after four months so is that in relation with any change drastic changes you are seeing so the way that the treatment regimens are designed is very very empirical and so that switch is based on early bactericidal activity studies that people did earlier assuming that most of the bacteria will be killed in those patients and then you just need a continuation phase to kill off those last few months so know the treatment is not based on any sort of bacterial analysis as people just don't know but some of the antibiotic results that I showed you is we're trying to build more and more antibiotics into the model so we can try to address these questions what would be a bit original what are the bacteria that are surviving for six months why do you need such a long thank you very much
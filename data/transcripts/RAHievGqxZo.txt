drug response in cellular populations as you're all very capable reading upon the screen I thought I'd say it anyway take away Thanks so it's my microphone working now in the room can you hear me in the back first oh great great the first time I remember wearing a microphone I had to teach this class and it was a multi segment class I'm the one across several hours and so there was a break in the middle I got to the end of my first lecture gotta use the bathroom I would turn off to the bathroom and then I came back and I noticed like everybody seemed to be like looking at the ground not really looking me in the eye so then I got the lecturing in the neck part of the lecture and like he'd hit me all of a sudden I was like wait a second I come on microphone I when I went to the bathroom didn't I got and everybody busted out laughing and they still don't respect me now so I'm gonna tell you about some work on the multi drug response in bacteria so I'm gonna start out by telling you that antibiotic resistance is a big problem I don't think anybody's going to argue with that too much you can look up various statistics and and various Public Health Organization's have said you know it's a huge problem CDC ranked at the number one public health threat in 2014 you can see a lot of things your leader just two examples from a quick google search these are actually about pediatric infections I had a sila son now who's one I tend to think a lot in terms of pediatric stuff even though that's that's the extent of my pediatric training but but I tend to think about it so these things can be a pork really bad for for children but I assume everybody will take that and then believe me on that and so the question is how do we solve this you know very big problem and and what I would characterize is sort of the typical way to do it is you characterize even the molecular events that underlie resistance so this is an example of an enzyme it's called beta lactamase it inactivates beta lactams which are a common type of antibiotic who's been very well characterized do you have structure here this is from Wikipedia so it's not only characterized it's disseminated now and then maybe you know once you know that you can come up with a new drug that say blocks this ends on or maybe you can add a second antibiotic because you have some resistant cells so you had a second drug to which the cells are not resistant and so this is absolutely essential right we have to have this characterization well the problem is this a really uphill battle the reason it's an uphill battle as many of you know is that bacteria are extremely agile genetically those escalated they're about 20,000 resistance mechanisms across all species of bacteria okay so whenever you use a new drug bacteria very quickly come up with a way to get around that drug furthermore I would say let's say we characterize all of these 20,000 resistance mechanisms and let's say we even had a drug for all of them it's not perfectly clear what we do at that point right if you hand me an infection what do I do I just give them as many drugs as I can at once it's not perfectly clear so so my lab takes a little bit of a different approach so I'm a statistical physicist by training familiar with statistical physics basically what often happens if you have systems that have many many degrees of freedom so a classic example with molecules these molecules interact in some way so say spins of a magnet water molecules molecules of a liquid various different things or other gas molecules interact in some way so these degrees of freedom are coupled in some way and then you put them all together the behavior of the system as a whole is is often very counterintuitive it doesn't reflect necessarily the individual molecular or specific mechanisms at the microscopic level okay so you can see this emergent behavior it's called so this is I call it statistical physics but but there's a very closely related field of complex systems in general now where these types of questions are being addressed so I think we should you know look at these infections as something like a statistical physicist would so now instead of molecules interacting we have bacterial cells or we potentially have drugs and by doing this I hope to shift sort of the focus from the list of parts the molecular mechanisms that are involved in resistance so it's an example of a new flux pump that pumps out drugs this is a very common one in coli - the interactions between cells in a population so it's just a population of in terracotta michaelis at one of the first pictures we took with our microscope I had to put in here somebody and so the question is you know how do these parts sit together so we're not so what done just a list of parts about how do those parts sit together and ultimately in terms when you're dealing with cells how do they give rise to community behavior to behavior of an infection as a whole now our hope with this and this is admittedly optimistic but I want to tell you what we're what we're dreaming of our hope here is that now if we have a population of cells we don't have to rely purely on solutions that target molecular mechanisms within individual cells we can potentially instead look also at solutions that target the ecosystem the target the way these cells interact and so that's sort of our goal that's our hope that's our dream I guess and and you know we hope that the dis can lead to things like new uses for old drugs all right well maybe a drug isn't so great at killing a particular cell but maybe it disrupts the ecosystem in a particular way well maybe this can motivate entirely new classes of drugs maybe you could say you need to mess with you know this particular interaction between these two types of cells to do that you can cause it you know it's sort of a big collapse this is just sort of the big picture of the way we're trying to think about things in my lab now what I'm gonna tell you about today is one example of how I think statistical physics type thinking can get you somewhere so I'm gonna tell you about a really surprising experimental results we had to use statistical physics to to basically analyze the data that led to this result but in practice this result is raising a lot of questions so this is this is work that I did while it's a postdoc at Harvard so it's now almost two years ago I mean I had several collaborate Satoshi she's a microbiologist who was in my lab at Harvard Eduardo Sontag some of you may know him he's a mathematician at Rutgers he's super super smart really nice Chris Wood is kind of the weak link he's my younger brother he's a faculty member at Duke and then Philippe Liddell was my was my advisor as a postdoc um so I'm gonna I'm gonna start out by saying we don't we still don't know the answer to this which is one reason I chose to talk about this today so I'm gonna give you this sort of surprising result and then I'm gonna hope that by the end of the talk you guys will solve it and hopefully have a theory paper written up so the question is one that's very simple it's how do combinations of drugs affect cell growth so in our case the drugs are antibiotic I keep forgetting a habit the drugs are antibiotic the system that we're looking at as a population of cells typically bacteria so we'll see coli staph aureus a few different types here then the output the thing we're measuring is something that's very simple to measure its population growth so it's just you know the the increase in the population over time and the exponential rate at which it grows so you might ask this is sort of like the interest level you know why would you study drug interactions or why would you study drug combination well say they're definitely clinically important in some situations now tuberculosis cancer malaria HIV or some of the classic examples it's thought that drug combinations may be sort of the clue or may hold additional sort of provide additional leverage for combating resistance but there's a big problem with drug combinations and that problem is that a complete molecular or mechanistic description of every system is certainly not known right and as a result you have to in order to really get a good idea of a drug combination you essentially have to empirically test it so there there are possibly exceptions but you can imagine this is a difficult problem because if I even gave you three drugs and I said okay you can pick all the different combinations of these three drugs at different dosages then you would see that the number of combinations can be quite big even for three and in fact if you were to do this for a larger number of drug you would find that the number of experiments you need to do to characterize a multi drug combination is going to go up exponentially with the number of drugs okay and potentially with the number of so this is a combinatorial explosion that's very hard to get around huh if you know the problem you should go for the drug sure so are you so you're saying if you want to kill something you should you should use that and try to find but you still have to sample a very large space accommodated potentially right right absolutely not absolutely absolutely and so you have to take into account both the potential interactions that would lead to side effects negative consequences and and so in this case we're you know this is very simplified in vitro systems but what I'm gonna hope to convince you of it's that it's not as complicated that we might think it is and maybe the same thing could apply to side effect we don't only equip them okay so so the question is can we be predictive can we somehow beat this exponential explosion and so this something's very easy to measure so I was a theoretical physicist by training I did my PhD in theory I'm mystical for the theory and even I could do these experiments so so this is something that's easy to measure so basically the idea is you take drugs something like antibiotics you add them to liquid cultures right so that's an example in a test tube and practice we do them in 96 well plate till you get higher throughput we did add a little bit of stuff we had a commercial plate reader and and a robotics interface and then we could customize programs really wrote in you know various various different languages so basically could do maybe 400 cultures at a time and for each of these cultures you get a growth curve that looks something like this so everybody that's working on microbiology lab has probably done a growth curve by hand something looks something like this so it says optical density as a function of time so optical density is is proportional to the number of cells and an experiment so this is on a semi-log plot so essentially the slope of this line right here give you the growth as a function of whatever drugs are in your experiment but very very easy to do and you can do it in high throughput and the data is relatively easy to analyze so it's not a hard experiment and so the question is well why it's why is it so difficult to tell what's happening when you add these drugs together and so I'll start by just the simplest possible example let's say I had a drug I applied to a cell population I measured that populations growth I'll call it g1 let's say this is a normalized number between 0 & 1 okay so one is in the absence of drug really no growth at all so you could do the same thing with drug to call that GP so what's gonna happen now when I put the two drugs together anybody have a guess now okay what's that the cells are gonna die probably the simplest possible thing you might think of is you can multiply these two things together so for example if this growth were point five so growth is inhibited by fifty percent this is point five and when you put them together maybe you'd expect total growth of twenty five this is called bliss independence is something that developed in 1952 then used extensively as a null model for what might happen when you put two drugs together and what's independent is great for really simple systems so I played around with a lot of enzymatic models where you you know you take an enzyme and you consider or you consider some enzyme cascade and you consider a drug to be an inhibitor of that enzyme and then you can use a second inhibitor of a second enzyme in the Cascade and you can see what happens when you put the two things together on say the flux due to network and for really simple systems you can derive list independence under the that's right that's like as opposed to systemic multi absolutely absolutely this is this is that or say that we didn't do these experiments but could apply potentially to things like HIV where you have multi component therapies but there's all targeting the box but anything where you're targeting yeah so this is great if you are playing around by hand with you know simple network models you can derive this at work great as soon as your network gets more complicated it doesn't work anymore right and it especially doesn't work when you're applying this to a population of cells or at least it doesn't work if Austin doesn't work it actually is not so bad in a lot of cases and that's because the drugs do you know what we call interact so there's two types of interaction at least for the purposes of this talk one is antagonism where the drugs counteract each other right so the total effect is weaker than you would think one is synergy where the drug strengthened each other so you put - maybe we capping anti microbials together and it completely wipes out the population so this is an example so if you see me give a talk before I almost always include this in the clock this is a very first experiment I ever did so this is a two dimensional heat map of growth as a function of to draw on the y-axis is salicylate which is actually something like aspirin turns out it kills bacteria so to a fitness that's coming in I was like that is the same thing as an antibiotic obviously it's not but again this marker on the y-axis is chloramphenicol this is an antibiotic also one that you can at least orally give to humans in these women and and this is gross of e.coli in the presence of these two drugs and what you'll notice here even in a simple example you see kind of kind of cool behavior so what you'll notice is if you just walk along this axis you say no chloramphenicol and I'm just gonna slowly increase the amount of salicylate or aspirin what happens is the growth decreases monotonically right and this point right here I would say gives us an estimate of the air of letting a theorist do your experiments for you but there are much better experiments that show this is a monotonic decrease you can do the same thing around the vertical axis and when you do that now you're just increasing concentration of chloramphenicol it's an antibiotic of course it kills the cells so again growth is monotonically decreasing nothing surprising but if you look higher on the axis you start to see something interesting so if I start with a nonzero amount of chloramphenicol and I add salicylate you see an initial increase in growth and then a decrease and again this particular experiments not great but you could fill this data points in very easily and this is actually a known effect so in this particular case these drugs are very strongly antagonistic it's called suppression one actually suppresses the effect of the other in this case the reason this happens is salicylate causes an upregulation of efflux pumps in e.coli if Lutz pumps sort of indiscriminately pump out a lot of different small molecules including chloramphenicol so if your concentration of chloramphenicol when you start a sufficiently toxic then adding something that is also toxic but allows you to get rid of toxic substance one is actually beneficial and so again this is a particular case that's well understood what I want you to take home from this is that there's fundamentally new chemistry or new biology that happens when you put the drugs together and so what that means is if you're trying to understand something that has a combinatorial explosion like this you need to understand every possibility right and there potentially different and there's been a lot of great work on trying to characterize the specific drugs the specific molecular mechanisms that might lead to interaction okay so we come from a little bit of a different perspective I when I was first looking at this problem I thought of it a little bit like a statistical physicist might what do you want to know you want to know what happens when you get lots and lots of drugs right you don't care about the relevance at first you're just you're just thinking and what we decided to do is not focus on specific drug interactions but happen asked what happens is the number of interactions or the number of drugs in a puppy in a combination increases and can we see something here that might give us some underlying simplicity that's not obvious it's an example let's say we have three drugs we might say let's know that let's say that we know the effects of the drugs individually and maybe we know the effects of the drug in pairs so we know what I'll call g13 the effects of or the growth of cells and the presence of drugs 1 + 3 G 1 2 + G 2 3 and the question is can I say anything about what will happen when I put all these drugs together right and if I can't that means are some type of three body interaction that happens when all the drugs are there something fundamentally new that's going on when all three drugs are there then when they're not all there and so the question is can we measure this can we find out first of all how do pairwise interactions add up to begin with and then number two are there three body interaction all other higher-order interactions and how big are they we've got to come up with some system for measuring this and this is where you made an analogy with theoretical statistics so this is a really beautiful paper from somebody in Japan SHINee GMR's so some of you may know him if you come from mathematical statistics he developed this entire framework called inflammation geometry from basically looking at the curvature of the space of Prem across probability distributions and it's it's brilliant work it's quite difficult to get through because it's it's challenging but it's really beautiful so he had this paper and the idea this paper was just to decompose dependencies among random variables into dependencies that are purely triplet purely doublet purely for body odd body so we're like okay this is similar sort of right I mean there's a large number of variables and there's and we want to see how much of the randomness of those variables comes from pairs of the variables or cubes of the variable therefore [Music] that's right that's right that's right that's right all right well you just ignore them approximate that is a two-body at a set of two body interactions to be done with it so there was another paper more on the physicists side but this is very much from the mathematical statistics community this is from the neuroscience or physics community from Bialik's lab at Princeton and this did something similar they defined something called multi-information which is an analogue of like a connected correlation function if you're from statistical physics but basically they're using information theory and they're decomposing information carried by in random variables into information carried by smaller subsets of Oh grand imperative pairs to you something like that and she said okay you know there's there's this whole sort of community out there that does does things like this so the question is can we somehow map interactions between drugs to statistical dependencies between random variables because if we can then we can sort of dip into this community and use techniques for trying to estimate how these things might look and so here's how we do did this we said okay let's assume that there's some stochastic variable I'm gonna call it X I X I depends on the concentration of drug i it's governed by some unknown probability distribution and I'm gonna stress here it's a formal tool it's not directly necessarily directly accessible by experiment certainly not by the experiments we were doing now here's why it's convenient we can connect it to experiment by postulating that the effects of an in drug combination the growth in the presence of in drug is an in-body moment of this unknown probability distribution so what we're doing here is by construction drug interactions are associated with correlations between random variables all right so we've set up a statistical framework where are measured drug interactions correspond to correlations between random variables we don't know what those variables are and we don't necessarily care but now within this framework we can try to estimate other moments the problem now becomes we need to estimate this probability distribution that's unknown distribution I'll call P from the data or to say this in another way we need to or we need to estimate higher order moments the effects of a large drug in terms of lower order moments the effects of smaller drug combinations okay and there are several ways to do this so the first way to do this if we knew more about the system more about the details is we could make some physical assumption right if we knew what these random variables were we had a physical model that would be ideal we don't have that but maybe we could say well the variables are Gaussian because of the central limit theorem we could make an argument like that maybe right another way to do it is we could use some type of statistical method and the one we're gonna use is called maximum entropy so many of you are at least some of you are probably familiar with maximum entropy and it was introduced at least to my knowledge and a series of papers from the 1950s by a guy named James these are beautiful papers where he read rides all of statistical mechanics from this idea so the idea of maximum entropy if you incorporate the known information or the constraints these are provided typically by data but you incorporate nothing else other than that you you want to find the probability distribution that is as random as possible but it is subject to whatever constraints your your data give you and so like I said in in the case of James you can drive all statistical mechanics by putting constraints on say the energy of the system which is a moment of a probability distribution and you end up getting back to multipling distributions it's a beautiful way to do a lot you know if I gave you an example I said okay I'm gonna give you the mean and a variance of a one-dimensional continuous random variable I say what's the distribution and you say well I can't answer that there's many distributions that could have this mean in this theory right there's not just one answer but what you could do is you could you can maximize the entropy of that distribution subject to constraints on the mean and the variance that I gave you all right switch with the problem in calculus of variations and what you would find when you did your typical blog on multipliers is that the distribution that's maximally in topic but has the mean and variance that I gave you as a Gaussian distribution there's something kind of satisfied right you could do the same thing on some finite you know some some finite set of numbers on the real line or something and you get a uniform distribution in that so and so all of your sort of famous families of distributions pop up from doing this that can be just a mean it comes out to be an exponential distribution okay so the idea of what we're going to try to do we're going to try to take data which are our two drug effects we know the effects of the drugs impair we're going to associate those with correlations between random variables we're going to then try to estimate the distribution that governs those random variables we're going to do that using maximal entropy once we have this distribution we can then predict the effects of a larger drug combination there's no free parameters here all right we measure the effects of the drugs in pairs and then we predict something that that experiment never saw we predict what happens when we put these drugs together okay and the question then is how well does this pairwise approximation predict the data if it does a really good job that suggests that higher order interactions are small if it does a poor job that suggests that higher order interactions are potentially really important yeah absolutely absolutely absolutely absolutely yeah oh absolutely so after actually when I I gave a similar talk when when I was at for one of my visits to Michigan and I don't know if you know machine he was previously a faculty member in biophysics and we got to talking about the same technique and he used it by basically he estimated using a limited number of correlations he could measure in particular type of NMR measurements he could he could predict you know higher order angles or something yeah yeah yeah yes no no you want the distribution that includes no statistical structure other than what you've been training to be alright so you want to maximize the entropy you want to you want to blow up the randomness of the distribution otherwise it's just gonna come to a delta function at you're yet your mean pretty simple uh-huh well okay yeah so this is this is outside of the the branch of control I see a little bit what you're coming to it what we're doing here is we have a limited number of measurements we have some distribution that that governs those measurements and we're trying to say okay if we're constrained by those measurements what can we say about that distribution so we're maximizing the entropy as a most unbiased if you want estimator of what that distribution might look like yes absolutely absolutely it's more on the parameter estimation then absolutely it's not a controllability problem at all right well you're right there's a whole different a whole different problem okay so we started and we took three drugs that all had very similar binding sites so the specific drugs are not particularly important here but we use basically three protein synthesis inhibitors that all targeted the ribosomes our thinking was let's try to let's try to find something where all the drug targets are at least somewhat similar and there's some evidence in the literature that at least in pairs these drugs give some type of interaction so let's try to force a three body interaction on this so we have linka myosin targets the 50s subunit erythromycin also targets a 50s subunit a slightly different way known to be competitive Glinka myosin by the way and then doxycycline so again these are all protein since this inhibitor this targets a 30s subunit of the ribosome so they all slowed down protein synthesis they all have binding sites or at least you know roughly the same within the cell so we thought okay if we're gonna see a three body interaction this might be a good candidate and so yes what happens we combine all these together how large are these three body effects and so one thing that was known and that we measured and confirmed is that in pairs these drugs interacting actually very strongly so one in two linka myosin erythromycin are very antagonistic when you put them in pairs linka myosin and doxycycline are very antagonistic and erythromycin and doxycycline are very synergistic opacity what's gonna happen when I put all these three together a little bit hard to say right but it turns out it's very easy to imagine right so this is just an example of the the 2d or the plane through two dimension or the three-dimensional drug space these are just growth planes so you know we tried to just measure random playing so we got pretty pictures and then we tried to randomly sample the space and in some relatively naive way to get to get an idea of what this looks like over different dosage concentrations and then now we can compare to our predictions that we made without putting the drugs together that we made only based on what happens when the drugs are impaired so we calculate predictions using data from the pairwise drug interactions and to our surprise it actually did quite well right so this is a this is a plot of our experimental growth measurements these are the predictions all right so this so you want things to fall along this line so systematically there are no major error on the earth we saw with typically within the bounds of our experimental error these are actually like 50% confidence intervals so it actually does really well when you extend it out further and then if you were to just look at one of these planes you see that it captures even the sort of non-trivial behavior where you have to say a curvature there growth we were very surprised by this because we thought okay we put these three drugs together that all interact in pairs and we thought they would interact even further when we put them all together because they have similar binding sites so in terms of gross units you can quantify this in various different ways including one way with information theory that's based on maximum entropy distributions I think maybe a simpler way to think about it a lot of people are just in terms of relative growth unit to its point zero pesos very small and so we were surprised like I said and so then we said okay well what you have to do next is you have to see how general are three body interaction so now we've just got to take a huge list of drugs and we got to start doing combination right and so we wanted to try to think what we were hoping for is welcomed maybe we can classify which of these drug combinations have three body effects and which don't and they do that'll give us some insight into maybe it'll break down by mechanism is there some I there's some idea out there that pairwise interactions between drugs depend on mechanism of action for this great paper actually where if you take a bunch of pairwise interactions from antibiotics and cluster them with an algorithm that knows nothing about the mechanisms of the antibiotics it only knows how they interact with others and and the constraint on your algorithm is that you want Class A of drugs however they're classified to interact with Class B of drugs in the same way so all drugs from Class A interact the same with all drugs from Class B and so you create classes of drugs when you do that they cluster by known mechanisms of action which is kind of interesting maybe we'd see something like this when we did more drug so we did 125 different three drug and for drug combinations but now this took me a long time this took a long time 19 different drugs and about 1500 different dosage combinations was remarkable as every single pot he saw outstanding fit this was our worst data set of any mini one experiment so you can see even here there's no systematic variation right I mean there's certainly some points that are outside of it and what we saw was you know excellent agreement so it depends you know you can quantify this in various different ways just a very naive way is to take something like an R squared value you can measure the average three body interaction in terms of growth youths and it's less than 2% or you can measure with an information theory method but I'm not going to go over it also tells you that in terms of bits so I'll briefly say the way you do that is you calculate also the maximum entropy distribution that includes three body interactions so that distribution is going to give you all the correct answers and then you compare how well that distribution does or the entropy of that distribution versus the entropy of the one you estimated from the pairs and you can see how much of that entropy is due to higher order effects and when you do that it also gives you a small so there are not emergent phenomenon here so this was very surprising to us so so yeah so what this suggested to us all right what the suggestion of course we have to make a huge claim it's drug interactions are encoded at the pairwise level so at least for a large collection of antibiotics this seemed to be true now what this means in practice is you don't need mechanistic information about every higher order combination of drugs you do need to know how they interact in pairs I so far there's nothing we can do to predict that but if you know that there's no mechanistic information beyond that yeah yeah lady said maybe so yeah right and we mixed all different I forgot to mention we mix drug from all different classes right right right we never found experimentally never yeah I mean you know these 2% or whatever yeah yeah nothing and now my contrast if I would assume they were independent and used the bliss independence to try to predict it way off now I mean occasionally it'll be close right but some of them actually are independent but by typically they're way off so we were very surprised by this and then we said well what we've got some other organisms lying around so we've got to try this and other things direct we tried it and staph aureus because this is a you know a more clinically relevant species maybe than e.coli and we saw the same type of thing and then I said hey like my kind of dumb younger brother does cancer stuff so I can at least I can contact him and we can do it with cancer to it so we tried it there with breast cancer and with melanoma and we saw the same types of things and we didn't look at the cancer case in a lot of detail and we haven't followed up on my that would be that might allow us to systematically look at this so I didn't talk about this but I'm not going to talk about that but you know it looks like it applies at least across species now what I had on here before before I get to this is we did some in silico experiments and and what I did is I just set up a network that was it had 15 reactions you know so Nats I tried to build in the feedback loop all the sort of qualitative feature you might see in real pathway so they were like there were reactions that came together with like a NAND gate something like you know you needed all three of them to be on there were others that came in all these different things and then I just you know you have 15 interactions so you can have 15 different inhibitors and we sampled that for you know a day or something that came back it was beautiful same type of thing there were some outliers vote but you know that's another thing that we're kind of looking into so I have an undergrad in the lab now who's very he's a math student very interested in network theory so we're trying to see when yeah so we're trying to take it to them at the very simplest level of just a complex network with a bunch of connections and you take out those connections and you define perturbations you know how under what conditions are these perturbations you know do they add up in this way exactly exactly and we find some and there are obvious cases where it wouldn't work so imagine that I had the case I mentioned where you had three pathways so this is one that we found that was really obvious once we saw it you have three pathways and all three of them are required for growth drug one targets pathway one drug two pathway two drug three pathway three you do these in pairs you're not gonna see any big effect right you just need one of these three pathways for growth you do them all three together you're gonna see a huge effect that type of architecture or at least doesn't seem to be very prevalent in in the you know if you want to think about it in the space of networks that are targeted by antibiotics right we'd like to formalize that a lot more though okay so this is something that's even more remarkable this is a markable experimentally this is not remarkable mathematically so what we found is that even across all these species the quantitative relationship between the pairwise effects and the in drug effects is always the same so if I give you the pairwise effects and the single drug effects and I say okay how do they give you a three body interaction it always fell it's something like this all right so the three body interactions involve the pairwise interactions a single interaction now if you guys come from statistics you will recognize this this is wicks theorem if you're from quantum field theory or if it's theorem from statistics it governs the moment distribution of Gaussian variables now we use maximum entropy and we basically give it the mean and the variance of a multi-dimensional Gaussian so it's not shocking that we get back its realest theorem because our distribution while not technically Gaussian has a lot of qualities that are similar to it so mathematically hmm not obvious that we would get this relationship not shocking biologically to me this is there's very surprising that the effects of drugs individually right we know if we have a drug that works on cell type a and we applied to cell fight B there is no guarantee it's gonna work at all and furthermore the effects of the drugs in pairs are gonna depend really exquisitely on the cell pipe right we're playing it to a cancer cell versa bacterial cell and the drug chemistry but the way these pairwise interactions add up to give you a higher order interaction needs to be completely independent of cell type and completely independent of drug type not just qualitatively look quantitatively so this is crazy right yeah and so it turns out that around the same time or afterwards several DS several labs have found similar things through different methods and and they're not always the point of the paper but if you look at their data you can see that they're seeing similar effects so a couple couple of these are in bacteria is from Rio Long's lab is a really great systems bio birthing from Israel you know this is from a nature medicine paper from 2013 I think they looked at HIV so in this case they were looking at promoters in bacteria so now they're not looking at growth rate they're looking at the individual promoter and they find that in that case you can also predict it at least for a large class of promoters there were some that you couldn't predict it from in other words you can predict how the promoter responds to a drug combination from the way the comodo responds to a smaller combination yeah it's entirely possible or at least a common network motif or collection that's true that's true yeah sure sure sure and this was you know again just in a very simple liquid culture so there's much more complexity but we're really happy to see that okay people can predict they threes from pairs in other systems taste like I said HIV this one was and this was predicting protein dynamics from drug combinations in cancer cells okay so again this wasn't the growth rate of the cell but it was the dynamics of a particular protein these were actually con series this one and this one were time series of protein dynamics or promoter dynamics and they found that you could predict the entire time series from these pairs okay so we think this is very cool we don't know why okay you know why yep you know 15 minutes or so time to work it out and let me know yeah but what are those features here in my lab you can figure that out you should figure it out in fact if anybody's going into it here I'd prefer to be somebody from my lab okay so just a practical application we were following up somewhat on this we're more interested in why this happened and they're trying to test that but but we are using it a little bit to try to find cell selective drug cocktails okay so I have a really good graduate student from bioinformatics and master student as well he's here we working on this in antara caucus Michaela so we have some resistant strains and some sensitive strains and we find that the interactions between pairs of drugs change between the two strains and so the geometry of this higher order space is very unclear we're trying to find cases where the geometry morphs in such a way that you can get selectivity for the wild-type cells in the presence of drug or a drug combination I think we have some promising lead but we don't have anything yet we're also doing it in a couple lung cancer and breast cancer cells and and you've started it with staph aureus let's believe my little bit wiser just to give you an idea though let's say we had 20 drugs and we want to do eight dosage each so there's 10 to the 18th different combinations we would need to measure let's say I hired a really good postdoc who could do 400 measurements a day and it's gonna take the person about 10 to the 12 years to finish this experiment which is which is you know really hard to find so this is no good let me give you the idea what like 10 to the 12 years there's like 10 to the 18th atoms on earth there's something I mean 10 to the 12 is on the order of the number of cells in your whole body this is too many years for a grand now if you do this with pairwise approximations you need about 10,000 measurements you can do it in about one to two months just in principle if you're getting 400 measurements a day there's a pretty big simplification all right so pairwise scaling goes quadratically with the number of drugs not exponentially it's a really big savings how am i doing on time here about 10 minutes okay so so we're following up on this in a lot of different ways in my lab so I'm gonna tell you just briefly about some of the stuff we're working on now excuse me so I think we're just scratching the surface I think these types of ideas and and studying these simple these systems in this way is at least to us it's very exciting now the measurements I told you about they're pretty limited right we have growth curves that only measure the steady-state growth rate basically here and what happens is after some time you reach the carrying capacity of your environment your experiments basically over that right so it turns out that a lot of your experiments kind of wasted and this is fine for getting a first-order approximation for how drug happened or how drugs act but what about dynamics you know I mean in a real life biological an area you're gonna had cells are experiencing really dynamic environments right and so we found inspiration in several papers from the Kashani lab from Shoni lab at Harvard med school in Van Hooten Darden lab at MIT these are both businesses turned biologists though yes Taylor thinking similar way and they built basically fancy types of chemo stats you know that's if you can control with the computer and so that's what we did so we grow our cultures in these small culture vials extremely simple because work that's put together by Jason the grad student in my lab you grow the cells in these small culture vials we went to the machine shop and we had them house this basically multi cup holder all right we have 15 of these cup holders each cup holder on the side can take an LED and a detector which we bought it RadioShack a little bit of electronics hook it up to a computer now you can measure light scattering right you can correlate this with absorbance with 15 of these so we can do it in you know not hot well we have 15 we only have 4 set up right now so we're trying to set up more them and you can pump in and out up to four drugs or nutrients or whatever you want and you can do this over time dynamically and then we can control it all at a computer with you know some relay cards and data acquisition cards it's very very simple there's some few electric circuits then what they were very simple put together so it's a simple setup but it's it's pretty powerful you think so this is just an example of one of our first calibration experiments so we let first we let the coli grow so just the red growth curve so now instead of having to take a measurement say by hand every twenty minutes we take I don't know ten measurements a second and take the median of those and we can let it go for overnight okay so so you get these you know of course very nice growth curves another thing we can do is by the way this is just a calibration plot of the voltage we measure in our circuit versus the optical density the cells so there's a linear correlation the other thing we can do is we can hold the cell population at a given density and we can do that by turning on pumps to pump in fresh media okay so if we want to hold the the cells that say an optical density of point two we can do that right and we can do that by turning these pumps on and off and then we can look at how often the pumps turned on and off and we can infer the growth rate over time okay so we like this because we think we can mimic more realistic infection dynamics and we can hopefully eventually start to ask clinically relevant questions we're far from that now with very much basic scientists and and so like one question that we looked at right away is what will the cell density play in antibiotic efficacy so there's something called the inoculum effect that people may be aware of the idea that drug efficacy is going to depend on the starting number of cells in a population okay so this is a well-known effect one thing about this effect though is it's a little bit difficult to interpret because if I asked you well how does it depend on cell density you can't say for sure because the way people do the experiments which are often very clever is they will take a population of cells and they will measure the mi see the minimum inhibitory concentration of drug that will inhibit growth of those cells well to do that growth has to go beyond some threshold right and then you could say there's growth or there's no growth as a result the density is changing throughout the experiment so this certainly implies a density dependence it says that yes something about the cells starting in a higher population versus the lower population can give you different efficacy doesn't give you a direct measure of on the other hand with something like this you can get that direct measure pretty easily so we can hold the cells at any given optical density this is a case where we held them at a high optical density the case we held them at a low optical density and we expose them to the exact same amount of drug in both cases the vaccine concentration this is a doxycycline these are in terracotta the ko is by the way so you can tell just by looking that something different is happening here all right when we hold these cells here you can look at the pump status then and you can see at the high density case the pumps are coming on a lot that means the cells are growing faster in the low density case the pumps don't come on much at all and you can do this as a function of cell density and this was an original curve we have updated data that's better than this but I didn't change the slide and you see I'm at least in this case is sort of very strong increase in growth rate as a function of cell dense they were very strong decrease in antibiotic efficacy this is the optical density versus time curve and all this note that we're staying in this exponential region all right so it's not like we're getting up here in the in the saturated region so this is cool we think because once we have this direct measure of growth or drug efficacy as a function of density now we can say well how would this affect an optimal drug dosing schedule what actual effect would this have and well we can't mimic clinical situations we can certainly do this mathematically so to quantify this rigorously we use optimal control theory so in this case we're scheduling drugs we're deciding when and how much drug to use at a given time we're not doing things like flying rockets which is where you might see optimal control one of the common many of you probably know optimal control those that don't one of the common problems is you know you have to get from here to the moon and you have a steering wheel on your rocket ship and you have to do the gas pedal in the brake and you have to decide how to apply the gas and the brake and how to steer it to minimize fuel but still man on so it's basically a way of it's an optimization where that involves a dynamical system essentially so we do this in this case we do it numerically because these are really nonlinear models and and what you can see at least I did it's did a quick calculation with this effect right here which again this is early data I'm not convinced this is exactly what it is but you can find that if you do the optimal control and you compare it to the case where you didn't know about this density dependence is there any savings you could get since these are both mathematically optimal we can say something rigorously about it and in this case you can see you can get a basically the same effect at about half the dose of drug use you could say drug or you could reduce the cell number with the same desc okay so it's important to know about these density dependent effects at least in an optimal sense if you want the optimal treatment and so the point here is that interactions matter right these cells aren't living by themselves another thing of this very quickly mention is we're trying to figure out ways to measure population dynamics when you have collections of cells alright so collections of phenotypes so so far I just had a homogeneous population let's say I had a mixed population involved sensitive cells in resistant cells and maybe it didn't just have one resistance I had multiple types of resistant cells do you can make arguments for the probability of things like this popping up and they are certainly relevant in some situations and you can imagine that these things will interact in different ways so for example this has been shown recently by a group at MIT some cells make an enzyme that deactivates the drug like beta lactamase that I've talked about at the beginning they the lactamase though doesn't just benefit the cell who's making it it's a community good that benefits everyone because it breaks down the drug the toxicity and the environment Goes Down and so potentially there are collective effects that arise from that and there's a really nice paper it came out and in its molecular systems biology it's a couple months ago where they looked at this exact problem and they showed that if you have an inhibitor of this enzyme you would think that would reduce the resistance in the population and at some concentrations it does because it gets rid of the resistance mechanism but if you pick the wrong concentration it actually can make the population stronger more resisted the reason it's more resistance because you can't have a cheater anymore you can't have a self who doesn't make the enzyme but benefits from his neighbors making it the very interesting effects here we're looking at a similar effect with E flex pumps where we think in this case this is a public bad the cells are making a flex pumps they pump out drugs there's an excluded volume effect so if you have high enough density of cells you potentially have a more toxic environment in the presence of E flat bump cells than not we're building that medical models and trying to measure this with with several experimental techniques one of them that I don't have time to really talk about but but I want to briefly mention is a way that we come up with to study mixed populations so this is ongoing work the idea is very simple that's work that Brennan in my labs done so Brennan's here look very hard to measure population dynamics if there are many cell types right I mean it's easy to measure it if we just want to know the total number of cells we just look it might scatter them we know how many of each cell type there are sure we can use fluorescence if there's a few cell types what happens if there's five a pen now it gets hard so basically what we're doing is we developed an assay that involved next-generation sequencing and and this dynamics assay the idea is we put in each cell type a short ten to twenty nucleotide segments of DNA that we're gonna call a barcode so this is something that labels that cell type ground that barcode we have a consensus sequence for which we can design PCR primers and therefore pull out that barcodes those barcodes from any given population and then we use a few tricks so that we can pool lots of these experiments together so specifically we label the PCR primers with an additional barcode we send this off for next-generation sequencing we're actually hoping to send our first batch of data this week there next week actually try it out we've done some of some tests with Sanger sequencing and looks like it's working but that's that's a very slow way to do it because we have to do each sequencing run individually but the idea here is we can do this at many different time points and we can reconstruct population dynamics of an arbitrarily large number of cells and in fact we have huge overkill on sequencing power here for what we're doing so it's nice hopefully next time I give a talk here we'll show you some of this data this is made up okay so in summary what I want you to bring home from this is it looks like at least you know in our hands pairwise interactions are sufficient to predict three and four drug interactions we didn't look much higher than that there were experimental errors that came into play that she's made it hard to make predictions beyond that which suggests that biochemistry or cell biology of these drugs is in some in some magical way encoded at the pairwise level right these that's what we like to say let me get box and what's really remarkable though in all seriousness is that the accumulation of these pairwise effects seems to be independent of the cell and so of course we're gonna say or of course it's true that you we have to have the biochemical and molecular biology now in no way saying that that's not necessary that's absolutely essential but it's cool that some aspects of this multi drug response seem to be independent of detailed molecular mechanisms okay and that does have a hint of what I remember seeing once upon a time statistical physics the big part of statistical physics is independence of molecular detail I think it raises a lot of new questions like I said we don't know the answer to them so the police feel free to chat anytime so my collaborators for the the pairwise work with again Philippe the whole lab there was great Eduardo like if there's a fantastic mathematician he's really fun to work with my brother Chris Satoshi was a microbiologist and then everybody in my lab right now in particular Jason built the instrument that you saw Jeff is now working on it with them and doing some density-dependent measurements and Brendan's working on there or actually sorry Brendan and Brian are working on my sequencing thanks guys that's great it's wonderful it's fun to see biophysics again too on the statistical physics analogy I mean one of the things that statistical mechanics gives us is kind of you know it's an ensemble of different kinds of you know behaviors if you will you know in one of the things that I'm wondering about is you know you might have different kinds of behavior it's different you know ways that different drugs interact with subpopulation shiney ensemble sure they're opposed to just treating it as a population of looking at the ensemble and I'm wondering if there's a way because with the antibiotic resistance isn't it just a few bucks absolutely that'd do it maybe on the edge and and even even before we get to resistance just the phenotypic differences in the response to drugs could give you a lot of popular population heterogeneity so what we're measuring could could very well be a bimodal population of growth rates and we're seeing as you know something approximating an exponential growth you know we're not we're not looking a lot at that we do a little we're starting to do some microscopy with biofilms and we want to see you know similar types of things with biofilms so that will be a little more single-cell level although we tend to look at the plan now is we're looking a little bigger length scales than single cells to try to see sort of large correlation structures and the biofilms and how those are affected by drugs so then again we get into something that reminds us of statistical physics because we have correlation functions we can measure very rigorously we can try to associate that with drugs and then pull on all the machinery from physics and say okay can we simplify this to a really is this sort of like when the case of the drug this came out to be an icing model the drugs interact like an icing model that has pairs right and you can do it with spins even so we redid the whole calculation with spins and then you can do time-dependent perturbation theory and show that it's realist Arum is going to not pound open it but I'm independent relation theory show is what's theorems gonna hold in the limit of small coupling which we saw it's cool because you know you see something experimentally that's obviously much more complicated but we can map it hopefully and you know in the best cases to a really simple model so I have two questions so the pairwise interaction sometimes depart from a single simple information of a single drug yes often very often that could that be predictive of which likely to have higher order interaction so if that's a good question so we haven't looked at that specifically now what I can say is if you do the same analysis but you try to predict pairwise interactions from single interactions you get back bliss independence you get back the the old model that's you talkin we haven't looked specifically at that question my second question is quantitatively about the power if higher order departs from independence it's your experimental set up do you have enough data point or can you say how much the departure detected yes and and it was within it was within our experimental measurements we had we had a small number of data points that we could not statistically say whether they were unlikely by chance or they were actually deviations from three body interaction so that's why we put the number at somewhere around two or three percent that you know we didn't have essentially the power to to make make statements about those good very good question so wondering if you think it's really the it's a fundamental limit on the complexity biological systems that you can predict the third order effects or this is more kind of an artifact of antibiotics and their mechanism of killing you're familiar with Jim Collins work that one of they have all these different parent targets rather all I tell himself through some common reactive oxygen species damage and although that becoming controversial idea I wonder if you did the same sort of thing by making targeted genetic perturbations that have using antibiotic you would see the same sort of predictability really good questions so at first we thought this was so the question is is this something that's specific to the way antibiotics work or maybe growth pathway since antibiotics tend to target those is it something about the structure of those or is it something that applies maybe the individual genetic components or something now they're two of the the studies I mentioned one in bacteria promoters and one with the cancer cells in protein did it at a more individual level and they were not using antibiotics although they were they were using in fact in one case they weren't even using drugs they use nutrients in some cases they use various perturbations our first thought was that it did have something to do probably with the architecture of the networks that tend to be targeted by antibiotics we wanted to formalize that in some way I'm now starting to think maybe it's more general also that you know the undergrad at my lab Saira that he worked on this he he either really remarkable guy he's a freshman very very excited and he'd built a simulator and at some point he started doing something that was totally different basically but he had the simulator and he could perturb it I was like wanted to try to protect with pairs of these perturbations and it worked remarkably well use this exactly we claimed it we don't know what's going on it's starting to feel like it's trying to feel like a bug in the code somewhere you know for a long time I was like how does this keep working all right well thanks Kevin all right [Music]
[Laughter] all right welcome everyone to technology seminar series a sign-in sheet went around hopefully you all signed it so I'm actually going to let peter farrelly now introduce our speaker today thanks so speaking today is rich in Gia she is a graduate student in my lab so rich in got her bachelor's from Sun yat-sen University in China and had done undergraduate research both on the wet lab side of things working with some cell lines and also had some bioinformatics experience and I met her at one of the bioinformatics kickoff events where she saw one of my talks and asked about doing a rotation in my lab sat down started doing fantastic work right away she was a master's student at the time and recently transitioned into the bound from ethics PhD program so we're really happy to have her in the lab and she's going to be talking today about some work she's been doing on finding some interesting regulatory connections Nicole I by mining high-throughput sequencing data and other and microarray data as well thank you Peter and Thank You Marci yep thank everybody for coming to my talk today so I'm going to talk to you guys about my lab project that I have been working on it's about identifying regulatory logic in a curated collection of e.coli expression data set so I would like to start with introducing something about you coli and it'll I essentially have like about 4,300 genes in the genome they're all well categorized and have a very good established numbering system of it and unlike many systems you guys may have been working with 90% of the e coli genome is actually coding so there's a little like there's very little waste in there wasting your genome and also it has no nucleus no splicing and they have short doubling time and very like large population can happen in a very short time so also very interesting is that I basically live and die by the transcriptional regulation because everything happened so fast so especially given there's no splicing and very like limited post translational regulation going on so it's a very interesting phrase that I would like to recite that they live and die by their transcriptional regulation so that's so much about you coli I would like to start with an example of like how cells like e.coli can get prepared for environmental changes based on current cues so here we are seeing like since here po3 is sitting the alkalizing high oxygen environment and PDS volatilizing very low oxygen environment so when oxygen going down we can expect that the one authorizing high oxygen environment is going down which is po3 and the one is using low oxygen environment would be going up that's kind of what we expected but with we are not treating it with like down down shift of oxygen but instead with the up strip of shift of temperature we can still see very similar highly correlated happening that the one that is dealing with high oxygen environment is going down and the one dealing with low oxygen environment is going up as if the cell is preparing it for like a low oxygen environment in equalise case this makes sense because when the temperature goes up usually means that you just got swallowed by someone so you're going to be hit by bio salt low pH low oxygen and all kind of adverse environment stresses so this is like what I call I make sense of the structured environment that you has been living with living and so the takeaway from this slide is like it's regulating more than this to deal with the current stress just like it's regulating the gene States related with oxygen when it is hit by actually a temperature change and here we would like to extend this example a little bit if we put all the environment events on a timeline as the green boxes here and we can have an environmental events for example in the previous example that would be going down off the oxygen and then we have some cues happening ahead of the events on the same timeline and in the previous example we can find an example as temperature going up as the cube so the classic we love how ecoli alkali responds to it is a homeostatic way so that means that a response when they actually got hit by the stress itself if we project the environment as the red dash boxes here we can see there's a little lag here and there's a new framework for e.coli string regulation is the anticipated regulation that suggests that you collide to start regulating and prepare for the environmental changes once it gets hit by the cue instead of the environment so we're projected here we can see the leg is slightly better and evil is actually preparing for this kind of environmental changes notice here that given that cue and environment are probably highly correlated but they are not perfectly like predicting the environment change so there will be chances there and it's anticipated way of responding is actually not the optimal and here we want to ask the question is that can we identify and predict stresses stress pairs that will show anticipate array behavior using mostly computational work in my project so I will start with Fitness status at days from the cell resource paper from Nicolas etc and they basically the that is how their experiment is set up there is a clear mutant collection library of the coli and they're basically like finding this knockout mutants in e.coli and put and plate it using little using rural fox on to the place and grow it under certain stress environment and see how big it girls and record the Kona size and score it quantitatively using kind of a more defined score into a finished score and that will give us a heat map she map of mutants versus stress about their on their fitness scores Nicholas do the stress of like 324 different environmental and chemical stress including a lot of like environmental changes chemicals and a lot of them miss antibiotics and one example of the data would look like this at the bottom is if we take 45 degree Celsius this example will see a score a finish score for a deletion of the gene so we might think about like if we can actually think about if a gene is helpful or hurtful using this data because when let's go back to our like previous example if a Jew is helpful we can predict for example the high oxygen the low oxygen gene would be very helpful in this low oxygen kind of environment and it will be played it on the plate and hit it with low oxygen stress we can predict that the one knockout with the low oxygen during gene would be going worse and the one knockout with the high oxygen during gene would be growing better or at least neutral so we can find out that helpful to enzyme treat those with a negative finish score because knocking out the helpful gene will make it doing worse in the stress environments everybody clear on that and besides this finish data set we find as a resource we can set out on Geo which is genius pretest to expression on of us to see if there is any other gene retching expression data set is publicly available and what we want this life vanilla playing mg 1655 or similar baseline stress are strings of e.coli with no genetic modification and it stood with stress or challenges what we find there is that there are about 780 eco light data set on Geo and for them out of the most recent 400 of them 43 of them is falling into our category I will be very interesting to see what happened to the rest of 300 I'm expecting maybe slightly more than that given that this kind of study is done a bit earlier so out of this data says that we can see half of them are done in two color microarray and about over 1/4 is done in one color microarray less than one color is stealing our ASIC and one example would be one it like how the data would look like after the analyse would kind of look like this that we have a stress condition and we have the list of the genes and we have the log to full change of it and in analyzing the metadata of the curated data we have on hand we find that it has the collection has a high diversity in both the biological and the technical side of it biological speaking of course there is a diversity in the category that people want to treat eco light with walk there to treated one dataset has some microgravity like stress so that is some thinking yes they are often more than one stress condition yes yep so there is like one data set that has several samples in there that has several that can have several different conditions in it for example one dataset might study four different antibiotics and put them in one day does that seem like four different samples yes most of the data sets come with their own control for two color microarray they usually have two controls one of the colors for one color mercury they usually have a untreated sample as in their data set because that makes sense yeah there is something that we want to study in the metadata and for example the time point when the collected data the OD value or like log phase or stationary phase varies and I actually have the idea of analyzing it with lot of phase and stationary data and see how much it changes and like for example if you are not doing a photo shot most of them are collected 37 degrees and there is something guys in consents and like media sometimes changes but most of the time you can find good documentation in the paper to find out that you talked about that yep and like many of them are environment stress such as cold shock oxygen and maybe microgravity and and many of them also study the antibiotics effects and yep so the two strings we are looking for is mg 1655 and PW 2 yeah and those are the two strains there using the knockdown mutant tastes like similar enough and it's like the baseline of the studies and technically speaking yep we have a very colorful part right here because people use different platform to do their microarray data processing and rn6 data processing you can see a huge chunk of it is coming from every matrix and the other the second winner is a Agilent platform but otherwise many of them use their own platform the coring their universities and things like that so many of them has like only one dataset is coming from one specific platform so that adds to the difficulty of analyzing and normalizing the data so how do we connect the resource data together now that we have a resource paper that has - data and a lot of like gene expression data says from GE oh and we can use gene expression X approaches so a way to think about it is that in the finished data we identify helpful and hurtful genes and in the deal expression data that we can find upregulated and downregulated genes so that gives us four combinations and if you are regulating helpful juice or dumb regulating hurtful genes that will give us a kind of behavior just like more fish jumping over and land pretty well because he already knows what to do and if you are done regulating helpful genes and up regulating her food of proteins you're actually sensitizing yourself because it will probably do worse in the upcoming Fitness conditions just like neo doing that for the first time ethically fail so so is everything like easy to think about it in the first place because we can find a Jing one and accordingly in the finished state that Delta Jing once finished score so days for one gene there and we are trying to do it for multiple genes like four thousand of them and we identify we define something as anticipation index that is you can think about it as a way of correlation there are multiple ways of doing it like mutual information Spearman correlation and we also define our own delta score and ofc ofc score and for mutual information we are basically looking at the inherent dependence of the data like how good how much information they can tell us between like the gene expression data to the finish data how much we can learn from the expression to the fitness situation and I'm pretty sure that like basically everyone is pretty familiar with Spearman correlation and though the score is a very naive but turn out to be very interestingly effective thing that we do especially the number of helpful Jesus and the different and it's different with the number of the hurtful jeans and outfit LFC score is a little bit more complicated we are just design but basically is the finished score over a threat over a certain threshold and it's product with lot fo change with the inspiration score over the trestle what's their rich finish score the finish score is what they study in the paper they basically yeah the basic idea modifies these more using the size of their colony yep and so by doing that we can like from these two vectors drive a anticipation index that is anticipated or sensitizing doing depending on the sign of it and there is one condition in your example that would be an aerobic resist like 45 degree from the fitness data but from Nicholas finish data they have three thousand two hundred three hundred to twenty four different stress so we can expand it column wise studying at the finished score from the same dataset and then explain a row wise using like getting more experiment data that we find on geo so that will give us a human look of the representation of the data basically what we are doing of data analysis so we have a vector of gene here a very often here we then color it using the final correlation anticipatory anticipation index that we find and then we do it column wise adding more Fitness data finished conditions under the same expression conditions and we period row-wise and more different expression conditions and if we look at it from this side it will be a humor so that is the conceptual part of like how the data is analyzed and technically how it is done for example like if we start with RNA seek data if you find injeel you'll find rockhounds and maybe a PKM depending on how people feel about updating their data so that is something that we need to do is so we basically first do the gene annotation to be numbers as we introduced before because I has a well annotated system of like gene annotation so we are going to make it as like applicable universally as possible so we to the gene annotation to be numbers and Fira annotated entries and then we figure out the low counts that possibly noise and for the raw data we are going to calculate the fpkm of them and then we fill out a and is if there is any and we do a Content normalization using the file conductor Lima package and then we do the replica Fuhrer figure out gene set for example be among three replicates of this set of very low relative ability rate we are going to figure those guys out and we collapse the replicase replica samples or gems into one of one of each of them for example they might have three phonological replicate for some stress conditioning sm dataset and we are going to collapse and finally we calculate a lot to for change of test versus reference and for the microarray data like things got a little bit more complicated because data like there are very many variation of technology that you can actually do microarray so for expression or the majority of what I'm doing with now and we will do with telling array a little bit later but actual pine light pipe lighter and we can have one channel and or and our two channel of expression array and four to channel ones we can have test test test versus reference of sometimes people are cautious enough to do a dye swab basically they swap the test and reference using different dyes and we need to do with them separately and we first find it in their table from the geodata to a very like isaac counts kind of table that we are familiar with and then we do the same gene annotation and do a signal signal further this analogous to the country during our ASIC that purpose is to figure out noise and then we also do come on the continent ization of our samples and replicates failure and collapse the replicate and then we will also have the lot to fo change of test versus reference as our final output so yep finally you can hit a matrix nope yep it's the matrix entering a little bit too fast and here's a example result from what I have now so you can see that this is a matrix this is a key map so in the color scale of the color legend is for the anomalous anticipation index the red one means the anticipatory and the blue one means sensitizing and we have it spread experiment data days from Geo as the rose and we have to finish conditions as the columns so let's zoom in a little bit to see what is Scindia and what we can interpret from it so interestingly we can see that there are like for example the five samples we selected here from geo data set the first one is anaerobic has a very red box here and they said so it's actually a stress conditioning stepped in oh my son in this specific case it makes sense because it's saying basically saying that and the real big condition if your pre treating Nikolai with anaerobic condition you can perform better in step two no my same treatment what it makes sense is that step to my son step to know myself requires active transportation into the cells to actually get to actually affect the growth of the cells and basically you need ATP to do that and basically you need a little bit conditions to provide enough energy to do that so in this case we're very cycle to see that actually makes sense and we can also see that in the role because of sensitizing for high ph which is like more basic kind of environment that's what we introduced before in the example and aerobic condition can Oh sometimes well like many of the times is coupled with low pH environment so it kind of makes sense to and in other part of the matrix there are also other things that we really want to mix that off and studied well up studies or like more data my name so that is the matrix now we are exiting the matrix as we see like there are four or five different ways that we can score anticipation index so one thing that I am working on with Peter and like we really like your guys input on is how to select a good anticipation index so we are thinking about evaluating the way that we score anticipation index using the shift of analog conditions yep so basically what we are picturing is that we define analog conditions as the same stress for expression and finish for example in Nicolas dataset you might have anaerobic conditions and some people on Gio might also have done this study similar and we are thinking that most of the time maybe not always that sells that I hate by anaerobic condition would be regulating it so that is survived better in anaerobic condition so we are like basically you are not trying to cure yourself when you hit by a certain stress well most of the time so we are thinking that if in this logic you have generally higher anticipation index than the overall anticipation index which means you see awry words what rightward shift of the analogue anticipation index over the overall anticipation index I have been saying anticipation so many times that I cannot pronounce it anymore yep so that's what I like a cartoon version of the data would look like and we would like to study the shift and you can think it is a ship of the pig so that's basically studying the mode but after plotting the day that we figure out that is probably not the best way because like even using statistics is probably not the best way to study if there is a rightward shift so we add more lines so we create a static map of percentile of 5 to 95 percentile of the both the overall and anticipatory index the analog anticipatory index and see if the analog one is generally better which means higher than the overall ones this is kind of like the output would look like so the blue one is like yes the analog one is performing better having a higher anticipatory anticipation index than the overall one and we can see that interestingly mode is actually not doing all that well and we are looking for us to like narrow down and fine-tune our stress assess to under all this life threats okras that we have to see if we can find a one that is actually like making a scoring so that's quick also the byproduct in this process that is besides building the matrix of gene expression conditions to the fitness we can also have a matrix of gene condition and the gene expression basically we have like we'll have stress escrows and jinx as the columns we have basically studied all the geo data sets de is available and build a huge matrix off like the landscape of its gene expression under certain stress and we are thinking about doing PCA or non metric data scaling on it to see if we can find a component a certain scale of a certain stress is dominating that could probably indicate a certain vector of the genes is dominating in response to a certain stress for example if we see a cluster of anaerobic in a corner of it in a corner of PCA plot or the non data matrix scaling plot we can think that on this axis there is something about regulating its response and aerobic conditions so here is all I got today is about 40 minutes not too bad kind of quick not quick and I would like to thank my lab for it and a special thanks to Marci that gave me this opportunity to plant here and also I would like to say in my department yep that's all I would like to take any questions random questions are welcome the dashed line is for animal condition the solid line is for overall conditions the color line is specific stress conditions anticipatory index specifically large portion of conditions yes correlation smaller than zero on the left side yep we are like looking for like we were thinking that there could be a rightward shift so you can think that a proportion of the proportion of the overall anticipation index a center shift this way so that's why it is here so it's like slightly worse because that's to a first approximation like not expressing the gene already tells you that the cells are under many conditions not giving an optimal gene expression profile for that condition if they were they just wouldn't be expressing those things at all under that condition so we know that some of the responses are so I think that that's part of what you see probably also are scoring metric is currently some alcohol that's what we're trying to fix but it should be expected that sometimes the cells that particular condition that's probably due to some combination of a couple factors first of all if they haven't convinced those two that condition to it second to may be bet hedging going on where they are preparing for some other anyway so you should expect that some of these scores are negative just because they're not always oh I guess I can your question now sorry for misunderstanding dad yeah and we also do noisy transformations to make sure that your see both positive and negative scores and we just assigned so the positive ones are helping and the negative ones are hurting so the next big scores are desensitizing scores yep just to make your pasty a little harder nonlinear correlations because there's a really good thought I mean yes scoring yeah yeah that would be interesting too thanks for making me fish it harder but that's fun anything else yep yep you got it like I have tried doing PCA on that but the current difficulty is that you can understand that every data set it's not studying in the same set of genes although they are on microarray so I find out that PCA plot is highly like confounding with the data set that we are finding it so far because they because we're not categorizing by the biological differences we are more terrorizing by the technical differences of like for example they're studying the first hundred years or the last 100 years so they have similar missing genes they got cluster together and that is the biggest difficulty we have been looking at so that's why we are trying to do non-metric data scaling that's not so sensitive to message inks but like given good normalization and we also have been thinking about like using lasso or like confidence interval kind of method to in like permeate the genes that we are not observing the missing genes so that will also add to our power to do PCA on it and figure out a pathways yeah these groups go back to like some reference culture when they start all these experiments or are they using things inside the lab that have been passed through ten generations of graduate students these are almost always very closely descended from the sequence culture so there's a there's one stock Center that almost everybody gets their stuff from they're getting it pretty fresh you know it's all start out we all start out so you're know no more than a couple overnights away from that culture in those cases now I've enjoyed the overnight cultures now there are four examples variations that have shown up across the different coffees of say MT 1655 but because we can sequence them so easily we know that like there are seven mutations between like the two extremes that we've seen in the variations but that's not too bad we know what they are we know to watch for those but in general but very very closely related all the lab is doing this kind of work in yes they do it so it is considered horrible practice for us to perpetuate a culture the way you would if you were doing the melyandd cell culture or something like that because you would accumulate a lot of notation so the first thing you do when you guest rating you grow it once and you freeze more than you need in ten lifetimes so you're always going back to that exact same stock culture and so the entire community is very careful to maintain that how much annuity as much as possible which is part of what makes a secret system to work with that Nick and why it's actually possible to consider doing these kinds of comparisons so that's it conditions and see whether your custom makes sense yes you mean the experiment conditions right that one oh this one so if you like your customer of conditions sense basically there would be the equivalent of course during the him every yeah if you are talking about clustering the conditions that we have seen in him some of them make sense for example like different anaerobic conditions got close together but like some of them is still like due to have scoring methods power in like analyzing missing data some of them is still highly confounding with the dais at their from so we might see like samples from the same date is that close to together why many of them like it's close to by the stress itself so that's one thing we need to improve in our anticipatory anticipation indexes to do or for missing data yeah like if you have to say that MO sailing and oxacillin wouldn't make sense because they're both penicillin you will expect if you're you treated with mo saline you will start dealing with mo sailing right away so you're basically dealing with a wide spectrum kind of suing but then you treat it with oxacillin which is a narrow spectrum penicillin you kind of expect that now that they are ready start to deal with penicillin they probably won't do so bad but this case is actually sensitizing so this is an interesting thing yep so are you actually doing going back to experiments or your I have been touching bench like doing a little bit of well that but most of my work now is still on the dry bench
girl alright so today we have a little unique we have actually someone who's with us remotely we have Damien Furman who I believe is a former graduate student here is now at Yale that Craig at Yale so he's going to talk to us about lease before - all right so first I want to say thanks for having me and my unfortunate feature of my talks is that I tend to talk fast to get to the end of it so if you hear me going too fast someone speak up slow down because I can't see you guys in this presentation you have the dubious pleasure having to see me though so so anyway I as a as a mentioning title of my talk is going to be about Lucifer - which is a tool we made for at U of M before I left that's why I kept your event here and it's a tool for post-translational modifications assignment in mass spec data I wanted a bit of a caveat here I originally wrote a program published a paper on something called Lucifer Lucifer one and that was a program that specifically focused on fossil site localization we wrote it in CPP and we C C++ and we rook and I also wrote it to work with the transparent pipeline output which is protecting all files out of that grew Lucifer - and the primary difference is that you know we remove the restriction that had to be phosphorylated data and now it'll work with any PTM you can think of and also the software's written in Java instead of TPC so we can run any operating system and the last one is that you don't have to use the TPP it'll take output from anybody so although the talk is entitled Lucifer to the date I'm gonna present is about Lucifer one because that's what we tested both versions on and conveniently it it illustrates our points so without further ado first a quick overview about what I hope to cover so I don't know what you know the audience makeup is if you guys are all RNA seek people or not or any pretty omics people so a bit about protein phosphorylation mass spectrometry very omics and bioinformatics of it then talking about the phosphoprotein mix challenge some previous work done in this field and then what lucifer brings to it so can you hear me yeah it's good welcome back even from the distance and you have to make you turn out here at faculty and students so it should been shot and tell us a couple sentence about your position like now or you honor for the ender what an introduction okay I currently work for dr. Steven Klein Steen in the pathology informatics program here at Yale his research focus is on computational immunology projects that specifically I work with are on influenza immune response and we're trying to you we're looking at microarray data and flow cytometry data to try and decipher the characteristics that make some people unable to acquire immunity given the influenza vaccine and that's the primary focus can we can we build can we can we use big data to try and determine what characteristics these people have that prevent them from being immune to the virus and if any as a side project or a long-term project perhaps we can develop or identify the characteristics that would make for a one-time flu vaccine instead having to change it every year great very good thanks for sharing that okay good so as I mentioned earlier this is a quick recap of what why protein phosphorylation is important the phosphate group gets attached to proteins and when it does it acts as a regulatory mechanism for many proteins some proteins become active or inactive based upon the presence or absence of the five of a phosphate group in certain positions on amino acid sequence if you just take a quick look at Unipro there's over five five hundred thousand potential phosphorylation sites if you just look at protein sequences in humans Dave also reports 25,000 phosphorylation events on various proteins and their isoforms one of the key proteins in this in this business is kinase is these are enzymes that add phosphate groups and dignity of the importance there are estimated to be about 500 protein kinase is encoded in the human genome and they're a major target for pharmaceutical research we know this because deregulation of kinase is often lead to many diseases in humans and for that reason lots of cancer therapeutics targets our kinase inhibitors I think something around 25 fda-approved drugs are kinase inhibitors so phosphoryl protein phosphorylation is important to understand in the studies so and now I want to quick give a quick overview on mass spectrometry I know it's a bioinformatics talk so I'm gonna try and go quick over this the basic idea is you have some biological sample you have to separate it out once you get your proteins you digest them with trypsin and the peptide fragments are injected to a mass spectrometer mass spectrometer first identifies peptides based upon that the most intense peak which corresponds to along the x axis to their mass this is the ms1 phase this peak is selected for further fragmentation where we try and identify what the sequences of that peak and that's in the ms2 or ms/ms stage and in now the bioinformatics starts in so the mass spectrometer spits out this ms/ms spectrum but you don't know from the get-go you don't know what peptide sequences belongs to and if you're really patient and really good you can sit here and manually figure out the distances between the peaks and then you can figure out what amino acid sequence corresponds to this fortunately bioinformatics ins have invented computer software which are called protein search engines which can match these this spectrum to any candidate peptide sequence so long as the peptide sequence is between same mass tolerance of what the original peptide was these search engines all work pretty much the same way you give it a kick list of candidates and they tries to match it and the peptide sequence with the best score is what it spits out and we call the best match peptide to spectrum matter of PSM and that's the gist of the proteomic site though I'm excited proteomics now there is a Czech Strich allenge when you're dealing phosphoprotein makes oh here again is the MS one followed by the MS 2 phase where you fragment the peptide ions and you get what is called the ionizer this is the peptide sequence it gets fragmented along the back chain and you get B's peptide fragments the ones on this side of the space are called the B ions these are the Y ions and if this was a phosphorylate peptide when it entered the ms2 the phosphate group gets kicked off because it's pretty label and this produces what's called a neutral loss peak in the spectrum which is represented here this huge peak in the spectrum the presence of this peak causes is so intense that often the other signal Peaks which you use to identify the peptide become very low intensity relative to in or become grass and not only does it make difficult to identify the sequence but more more importantly you have a hard time identifying where the phosphate group originally was so this is called the fossil site localization problem and most search engines have a hard time correctly localizing the phosphate group on these peptides here's an example this is the spectrum that goes with this peptide is doubly phosphorylated and here you have the neutral law speak you can imagine it's pretty difficult to look at this and figure out the correct site for phosphorylation and so you know manually you could do this but when you have thousands of spectra that's a daunting task so buying format assists have come to the rescue and come up with with different ways of dealing with this there are as of right now there's a ton of different ways of doing it but these are the probably the most popular and most effective in the literature the phosphorus cycle auscultation tools can be pretty much broken up into one of two categories spectrum based methods and search engine score based methods and I will talk more care more about these two categories in a moment these are the these are the current tools in literature prior to Lucifer so I'm gonna talk about the first one is the spectrum based methods and I'm going to talk about a square as an example primarily because a square was the first and the other two methods in this category phosphorescent Andromeda are really just different versions of the a score algorithm and the a score approach so a score came out of giggy's group and Harvard and the Yahoo algorithm is pretty simple so let's say you have this peptide sequence and the red spots represent a fossil serine in this permutation of phospho threonine in this permutation and you want to figure out well which of these is it so if you have the spectrum what a score does is it breaks the spectrum up into bins of 100 M over Z windows and within each bin it takes the top and most intense Peaks within each window and tries to match them to the fossil permutations so if you can imagine here's the spectrum you break it up you get the overlay the b and y ions and try and match them and each permutation is scored using a binomial probability accumulated by known probability and you do this it early increasing the number of peaks you allow within each bin and eventually you hit a peak in the in the peak depth meaning you've you've come to a number of peaks within the window that's optimal and gives you a maximum score the algorithm then chooses this peak depth and then computes the score scores the peptide this pipe recommendation at did this depth and compares it to the other the next best match so in this in this example they present the depth was found to be about 6 so they score the permit they try and match all the peptides I am pregnant ions for this permutation they're able to find 5 and in the next best permutation which is just one down here they were they were not able to match any of them so the final score is the difference between the two of them and like I said phosphorescent and drama to do pretty much the same thing they just have different either they use with different windows or the different value at their final score the second method the search engine scores and there's only really two of them the MD score the mascot Delta score from ku stirs group and the slip score yeah where the slip corner is a site localization of peptides and these methods directly use the database results that you get and and use these to interpret the local use these to come up with their localization scores so how they work is they simply take the difference between the top two permutations for a peptide and this diff the difference between the two is the Delta score and this is considered to be the confidence in the assignment so the larger the Delta score the more confident you are in the assignment of made in the top score so if you have these three possible permutations for the sequence and this site is the correct one let's say the search engine says this is the best score the next best score is this one so the Delta score is 5 and so you would say that's how confident you are on the assignment made in this case in this permutation so we what I did is I took the best of both worlds I tried to take this bar from the spectrum world of a score and the mascot Delta score and I published program we called Lucifer here so Lucifer provides phosphorus light assignments but it also provides a false localization rate for the assignments it makes here is a layman's overview of how Lucifer works I'm going to go more into the details in a moment but this gives you an overview in case you wanna in case you find the next slide more difficult so here you have let's say the search engine output this is pep XML files and these are the actual spectrum files and these are the two things that Lucifer needs to work so once the data once you have both of these you feed them into the program and it you first filter out PSM matches peptide spectrum matches that you don't want to score because they're just low low scores or bad quality there's no point in scoring bad data you're not going to use it anyway once you've done that the next step is Lucifer selects the high-scoring PSM and prefer model parameter acquisition and it does this in a charge dependent manner once it has these these parameters quired it goes back and scores all of the PSM using these parameters alright that's the gist of how the program works the parameters it acquires are the intensity of the peaks and the M over Z accuracy of the matched Peaks right so this is the more detailed approach so as I mentioned the first thing we do is we learn the features of the data from these distributions so one of them is log one of them is the intensity of the peaks both the match Peaks which are in red and the random Peaks are the unmatched piece of blue here in addition we Matt we compute the mass accuracy of the max and unmatched Peaks so here again red is the match Peaks and blue is the random with this information we go through and scored each phospholipid I promise I knit a raw score so here's our here's an example again let's the peptide sequence and we take the these are the raw scores and signed to each of them so let's assume this is the spectrum we got for this peptide sequence I what we do is we identified the peaks that we can match for the top two permutations so in blue I don't know if you can see that it's blue but these Peaks are the matched Peaks for the blue permutation with the phospho 3 inning and the red peaks which I doubt you can see here's one is the other one are the peaks or that are unique to the fossil serine permutation what Lucifer does is it matches all the peaks at can you don't worry if you can't see this also more closing the in look in the next slide matches all the piece of kin for each permutation sums up their scores and then their difference between the top two permutations is called delta score and we use this delta score to estimate the false localization rate so oops so here's that table up close again here's the blue the blue Peaks and the red Peaks and what you see here in bold are the peaks that are unique to this permutation and you can see here is the intensity for those Peaks and there's distance and by distance I mean the mask Emilie's the accuracy which is the distance the difference between the the observed M over Z value for this ion and its theoretical M over Z value these two values are used to compute a log-odds score which is reported here as the ion score and the cumulative sum of all these match values is the final raw score for this permutation the same thing is done for the other permutation the faso series and if you don't have it if you don't see a batch peak its value here it's because you didn't match it or it doesn't belong to this this permutation and the same thing is performed in the end you take the difference and that's called the la the masker the lucifer delta score so once we have the delta score you we have the software has also made an assignment of the the phosphorylation site the problem is that this output is still only a prediction okay there's no guarantee that the site that lucifer reports and the top-scoring permutation is correct and this is true for all of the tools so we had to come up with a way this estimating the confidence we can have in the site assignments that lucifer may and for this we developed the false we use a false localization rate which is measurement of the percentage of incorrect matches or incorrect localizations at a given score threshold so FL r FL r is nothing new it's a pretty common feature of in proteomics usually it's called false discovery rate for and there in that context is used for trying to determine how accurate the assignment between the particular peptide sequence and the spectrum it's was assigned to so we've just extended that same idea to the possible site local different tools try to do is in different ways and dromeda for example which is like a spectrum based method similar to a scarf it just accepts the FDR that's used for peptide sequences and interprets that to be the error rate for the localization the slip score by Chalky's group is a little more interesting they they allow not only phosphorylation of serine threonine and tyrosine they also include for the search engine protein search engine to phosphorylate prolene and glutamic acid these are two residues that don't normally undergo phosphorylation and so whenever they observe these cases they knew it was a bogus hit and they could use it to estimate these false localization rate none of these two methods are particularly good the Andromeda Strain the Andromeda method primarily because you you know it works for decoy peptides that doesn't mean it's the same model for site for site localization the slip score although it works the problem is you have to incorporate the these search these parameters into the initial search and you can ask any mass spectrometer a spectrometer or quarry omics person you know the more amino acids you say are modified the longer the search takes and nobody wants to wait for data so Lucifer takes a different approach so for a given peptide that has K sty modifications reported in it the Lucifer will generate a new peptide sequence with k9o sty modifications which are decoy matches and we score these decoy matches using the same algorithm as if there were a real ones all right explain that what is it not it can be any let any amino acid that isn't already modified by some other modification like you know oxidation or carboxymethyl ation if it doesn't have some other modification it's a candidate to be artificially or synthetically phosphorylated for the purposes estimating the false localization rate maybe this example help so I'm gonna show you to PSN matches because and therefore the same peptide sequence but you have to imagine the case one is for one PSM in case two is for a different p sm they just happen to belong to the same amino acid sequence and so here we have the three possible valid phosphorylation events for this sequence this has this T's this as this T's okay the decoy permutations are all the other residues in the sequence so what Lucifer does is it first scores these guys and immediately following that it puts the phosphate group on this residue and tries to score the theoretical product and it does it for each of these and records their scores okay then it still goes but it still goes back and scores only the top two computes the delta score from the top two hits which in this case happen to be these two cases the raw score for the top hit and the second-best hit now in case two this is again is gonna be the same sequence but it's a different spectrum that was matched in this case again the top scoring for me take the the real permutations are up here and the decoys are below but you notice that the raw scores are overall lower which means probably fewer good Peaks were matched but regardless in this iteration the top scoring permutation is a decoy right if you're phosphorylating if using phosphorylation because valine does not undergo phosphorylation at least not not not naturally and so what lucifer does is it takes this is the top score and then looks for the next highest value which is this permutation so the Delta score becomes one point seven four does that help dr. Allman no I'm really confused now because there's it's not just it shouldn't happen except there's no chemical site the phosphorylation is Bailey loose so how do you get computing about the spectrum well you have to remember that there's that apart from the true Peaks that represent fragment ions in a spectrum you also have noise Peaks which are not valid or just are present by chance so that's those Peaks are still eligible to be matched be they to real Pete fragment ions for the for the real permutations or for any of the decoyed permutations okay and the dullest score here on the right case - I would expect it would be - well it's it's the difference between 3.38 and once explore because it's always the algorithm always takes the difference so it always takes the difference between the top hit and the next best hit it's always that it's always a positive value it's a help you have to speak up because I can't see you if you raise your hand actually above your decoy repetition is it possible that both of them are correct or like let's say you have to phosphorylate sites and the both of them codes into your second phase of country well usually based upon the mass of the peptide you know how many phosphorylation events are present so I'm showing the simplistic example in which we know from the beginning from the mass spec output that the peptide only contains one modification so we only you know given that from the beginning then we only consider that the possible condition in which there is only one modification and each of the possible permutations if there were more phosphorylation events then there would be more permutations obviously or fewer in this case let's say is it possible a single peptide contained two potentially sides and both of them get scurry ability into your second phase of mass spectrometry yes those are that's a common biological event so you do get peptides that are phosphorylated both of them get stuck because they have the same mass so they both get selected and they both come up in the spectrum highest-scoring permutation sixty-eight while two of your target invitations have high school at their is it possible that the actual spectra is a combination of two different kind of phosphorylation here yes that that is possible but and when that does and that does happen in in practice I haven't demonstrated that here just to keep things simple but you do get examples where to basically to two possible two possible peptides end up in the spectrum and it's very confusing and very difficult but the general result is the Delta scores are very small because you have Peaks that can match to both cases and so it's an ambiguous situation and you can't tell them apart so once we have the decoy information we use it to construct an after log so the first thing is we plot out the distribution of Delta scores for both the decoy the non decoys or the real data and the decoy cases the decoys we expect them to be few and infrequent and if they're not some go back and look at your data something's wrong and once we have that we fit a mixture model to both distributions from this we then pick a score threshold and the false localization rate is the proportion in the third panel of the decoys at that threshold to the number of non decoys at that threshold and that's how we estimate the flr so all of this is very nice but you actually got to put it in practice and try it out so fortunately cue stirs lab in Belgium was very generous to provide us with a synthetic library of known phosphorylation sites they published a paper on it in which they described the mascot delta score method back in 2011 and they were kind enough to provide us the raw data they used along with the correct box correlation events in their synthetic library this library was composed of 180 synthetic peptides in which we knew where the site of phosphorylation should have occurred the library can be further broken down into 164 singly phosphorylate events and 16 doubly phosphorylated events at the time you know the the field had a mixture of both high mass accuracy data which CID and Lola and HCD and then low mass accuracy data which is called CID I think I could be wrong I've been out of it for a while but I think that the industry is going primarily HCD right at the time the the data we had low mass accuracy and high my sector team aspects and I'm pretty sure people still use both so fortunately the library was run in both ways was analyzed using both types of mass spectrometers so we got the data we searched it using our search tools and then we compared Lucifer's performance to two other methods both a score and the mascot delta scarf represented here as empty scores so along the wire the the y axis you have the fraction of sites that we identify correctly and then the x axis is the false localization rate the numbers in parentheses tell you how many PSMs were matched by each of the search tools so in the cid data the low mass accuracy the at the critical flr of 0.01 lucifer you know came out ahead and in the a CD we also came out ahead although you know as the flr goes out you know we don't do is you know mascot Delta square outperformed us but you know we like to stick to the point oh one if I'm conservative with my estimates 0.01 is the is the critical cutoff them that we use because we need the truth the true phosphorylation sites we could we could look at our estimate for the flr versus the joyful are with this dataset that we're doing quite well for the cid flr accuracies and we had a bit of a hiccup here in the ACD and it looked like we were under reporting the flr so this was a bit of a problem and on further examination we thought that the big issue here was simply the size of the database we're using the size of the data we're using we're only talking about a thousand PSMs which any master chromatin will tell you isn't a lot to work with and it's only one date 80 peptides so we couldn't really go any further until we found a larger dataset and hughster came to our rescue yet again back in 2013 he published another paper in which he made a much larger high mass accuracy HCD live library and again he was kind enough to provide it to us this library consisted of fifty seven thousand possible peptides and they were all singly phosphorylated and they were all done in high mass accuracy which was the technology that we were having issues with so once we had gotten the data we ran Lucifer through it again and compared to the mascot Delta scores and here you can see we did a lot better we we did better than mascot delta score again but more importantly for us at you know we seemed we we corrected the underestimation of the flr so that made us feel good and we were able to continue with software development to lead to publication the so in conclusion i guess lucifer you implements a novel scoring algorithm based on probability model using the peak intensities and the mass act the mass accuracy of the M over Z and unlike many of the other methods out there Lucifer provides a false localization estimate for the at the peptide level for the PIAT PTM assignments it makes and like I said Luther for one was originally released only to work with its primarily with the TPP so you had to use TPP and then you can use a Lucifer Lucifer too though has had that restriction removed it can now as long as you can get your data in the right format which is pretty easy it's just tab delimited you can use it and also it's now written in Java so you can just download the jar to run it so I would like to first I'd like to be great like thank you for your attention that I would like to thank dr. Brewster who you know provided us with those two synthetic libraries and without them we wouldn't have been able to test our algorithm and verify the results we were getting at U of M of course I want to thank dr. Lexington's Mishti was my my boss when I was working on this project and to me three on the table if he was a great job a programmer who helped us find a lot of bugs and speed up the program immensely dr. Hulme along joy over net at the national university of singapore was a statistician and who helped you know a friend of mine in this project he was the one who developed the FDR model that was used to score the to estimate the flr and in the program and of course I would like to thank Alex because without him you wouldn't be seeing this this presentation in my lovely face so this work was supported with work money from the NIH and from the Singapore Institute of Science so if you want to download the software you can find it at that website that's for the latest version loose for two we can still get booster for one as well if you won't want that so there's any questions that's it thank you for your attention [Applause] questions yeah let's see can I see you guys hang on yeah but they mean of course so one of the big problems is to go in general to go for the peptide the right protein merge right I'm going to go to the protein now you can have multiple many more multiple sites with less correlation there's also a literature about alternative glycosylation versus phosphorylation at some sites right you have advice or experience about those steps we played I mean I've gotten contact about Lucifer to to try and look at multiple modification events and I haven't heard back from them but from what I would I understand is as long if the same residues being fussed for it is being modified you're gonna have low scores overall because the the peak shift for example with constellation bus versus phosphorylation is very different right constellation only shifts the mass by one dalton approximately and phosphorylation shifts it by a lot more so when you have a mixture of potential PTMs on a peptide if they're on the same site you you end up one of the two modifications predominates over all and that's not very helpful in general but if you have a modification as I say I track and phosphorylation that the I track is fixed so there's no ambiguity there and that seems to work through work fine through the program but if you're trying to find multiple modifications in a peptide or in a search fortunately there aren't that many that are labile so you could focus you can you can do a search with the clock oscillation and phosphorylation and run Lucifer on the phosphorylation site which is going to be more ambiguous there's the question about aster qiyamah tree yes maybe I'm out of date but I believe there's quite a lot of items to to switch protein kinase phosphorylation in a pathway don't have to have a hundred percent occupancy oversight sometimes twenty or thirty percent would be sufficient to achieve the switch so this means that in your peptide analysis even though that peak is so hard even for us I'm like yay it made the only minority of the molecules of a peptide that actually have a phosphorylation with in some way now lucifer doesn't deal with that if you're talking about a quant from a quantitative point of view if you want to know how often a particular site is modified in a peptide versus another site I have seen people who will count out you know do spectral counting on a particular you know Lucifer output and look at how often they have evidence for site a versus site B and the peptide sequence although I don't know of anyone just follow that up with actually looking at the chemistry of the stoichiometry they're not sure if that answers your question or not well I think it might be important maybe it's not that's a hard one that that's a biochemist problem which right I turned it in my problems we had a really nice workshop back on the second third March all of our proteomics informatics students as Alexey of course anybody is there from group today so they're lost and this is tremendous what you're doing you're the other come but you want to give it no I mean thank you for arranging this I mean I know it's actually I don't go to a lot of trouble to have me speak from this far away see it anytime the other come thank you I liked you reporter credits on the whole design of the project you got credit for getting this off off the ground because you know I the IT part of this is the hardest part getting it be able to present to you guys was not is probably the hard part part in my opinion because anyone who's trying to make a connection across Skype can will tell you it's knit it never works out that what you think it's going to work ok that's my best to you and your colleagues there and thank you for connecting with us and doing this as a plate presentation very good thank you [Applause]
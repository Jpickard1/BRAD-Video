so that I'll introduce our speaker today we have David North Sutton who is associate professor in biomedical engineering and cardiac surgery uh thanks Marcy it's a pleasure to be here with you with you all today and it's interesting getting uh the invitation here to have a tech talk normally that's not what we talk about we usually try to hide a lot of the details so I want to I'll talk a little bit about our work so generally speaking I'll introduce kind of what the lab is all about and then I'm going to focus on the kind of key tools that we use and share some of those that that might be interesting for for you um so basically um I'm sure that's important see if this is yeah okay cool um yeah so our lab is really interested in in studying heart failure um and this is a big uh clinical Challenge and part of the challenge really with heart failure is that the disease is really complex um so the etiology of diseases is very variable um uh and the disease really spans multiple scales really so you can see kind of features of disease all the way down at the sort of level of sarcomeres the main units that cause your heart to contract all the way up to the whole organ so changes in how the shape of the heart looks and how it functions um and my team is really interested looking at I'm going to drop using this it's not working my team is really interested in uh the sort of tissue to whole organ scale this is kind of where we tend to work and specifically what we're interested in is ways in which we can take medical imaging and computation and bring them together and specifically we're we're interested in um biomechanics so ways in which we can embed biomechanics use it with imaging to better understand what's happening in the human heart um so what I wanted to talk about uh today is some of the tools that we use and have developed um and it's really on the side of Imaging image analysis and modeling and so I'm going to kind of talk through these three areas so I'm going to talk a little bit about medical imaging and how we uh use that to visualize what's happening in the heart then I'll talk a little bit about machine learning I am not a machine learning expert I'll say that up front I'm a modeler by training but we do use machine learning increasingly more and more and then I'll talk a little bit about biomechanics and how we leverage this and I'm going to talk about it in two different contexts one which is sort of physics-based image analysis and the other one which is what we call patient-specific modeling so looking at Medical Imaging um it's pretty amazing what you can do with medical imaging and what you can see it really gives you a lot of perspective of what's going on and specifically in disease um and so one of the things the tools that we use a lot is magnetic resonance imaging this is really a technique I don't know how many how many people work with medical imaging data in the room one okay so a few of you um so apologies if it's simplified but um just to give everybody else an idea basically this technique uses magnetic fields to really probe what's happening in the body so you sort of excite areas uh in the body what you're exciting really is water molecules you're basically giving them some excitation and walking the relaxation and you can from that develop images of what is happening or what uh the the heart actually looks like so this is an example here this is just a fly through showing you um uh the heart and we can see it maybe in a second here it'll loop back but this is the Torso here down here is the the liver uh and now we're coming back through here you'll start to see the heart coming through here this is the the left ventricle coming through here and you can see actually here's some of the great vessels um going through there's the aorta shooting down so you can get a lot of detail about what the actual heart looks like within a patient from these images the other nice thing is you can look at it over time so you can use gated sequences for MRI where you get sort of movies that show exactly how the heart beats um over time and with MRI there's a lot of Versatility with how you excite in the body and this gives you a a large amount of Versatility in what you're actually Imaging so another cool example that we use is what they call Tag MRI so this is 3D tagging and what you can do is you can basically excite only in in regions of the tissue and you these sort of unexcised bands and then you are not on excited bands and you can see those Bands then move through time so this is really interesting if you're looking at mechanics of the heart because you can watch how the tissue is actually deforming and moving uh in in space so you can extract uh displacements but there's a lot more that you can look at and it's specifically in the heart there's a bunch of different sequences that you can leverage to start understanding disease and I won't go through all of these but this is just sort of an overview of what it looks like so we have different ways in which you can look at relaxation so how once you excite the water molecules relax back to their sort of uh initial State and so then these are sort of T1 T2 weighted sequences that can give you information about an anatomy or fat or edema there's something called late gadolinium enhancement which is something we use a lot this gives you an idea of regional fibrosis so what you do is you give a contrast and you look at washout and you can see areas in where the heart is really not getting refused right or has a lot of fibrotic uh buildup in the muscle um and then there's a huge number of other things that people are probing into as well um and there's uh pet Mr as well so you can really start to dig into what's happening in regions of the heart and see it uh in the anatomy another uh technique that we use in the lab is um 40 flow MRI so this is face contrast Imaging and this is three different examples so here we have the heart this is a dissected aorta in the middle here so if you're seeing this little region here is is where there's a tear in the aorta and it goes into a false Lumen I mean this this this Lumen here is the true Lumen and then over here we have uh space contrast in the brain so you can start to look at blood flow in 3D over time and you can utilize this information to start better understanding what's happening to the cardiovascular function in these in these conditions um and we've been using this data a lot to try to help with Diagnostics and risk um another technique which we've been using in the lab is a technique called magnetic resonance elastography and this uses the same kind of uh sequence as what I showed for flow but instead what you do is you put a transducer on the body which is represented by this little block here and it vibrates so similar to your cell phone where you get this sort of like high frequency low amplitude vibration that tells you someone's trying to ring you we put these transducers onto the Torso and you strap it down to them it vibrates and sends waves through the body and what you do is you establish some periodic steady States and you can then image that with MRI and so why would you do this what's the point of that well the relationship between how these waves move is directly related to the stiffness of the tissue so it gives you a way in which you can try to probe what's the actual stiffness of that tissue in Vivo without having to cut somebody open and actually poke at their tissues um and so this is a technique it's predominantly used for liver but it's been used a lot for cancer breast Imaging brain Imaging and also some in the heart as well in the heart it's much more challenging but it's something that people are trying so what's that technique called I mean what's the name of this this is Mr elastography mrls photography yes yeah okay so the other technique are the other Imaging that we use a lot in the lab is CT um and this is using a completely different technique so instead of using magnetic fields to try to excite regions of the body you're using X-ray and you're looking at attenuation as as x-rays pass through the body so the downside here is that you're sending x-rays to the body whereas the other one doesn't have uh any any uh x-rays that you're using um but the advantages that you can get really detailed and anatomical pictures so MRI to get the fine scale images like you could get in CT is possible but this sequence takes a long time so you know the person who will have to lay quietly in a scanner for a very long period of time to get this kind of resolution and Clarity um but in CT you can get it in seconds so it's very fast and you can get these beautiful images of the heart it's a lot you know a lot of the times you use this for coronaries or if you're looking really at the details of valves or anatomy of the aortic Roots this is a common Imaging technique that we use but we can we can also you know get a lot of detailed information about the muscle of the heart and the anatomy the shape of the ventricles and also um with CT you can make them dynamic as well so you can make movies uh showing how the heart's beating over time and this is really helpful if you're trying to understand cardiac onion so you can look at these these sort of movies of how the Heart Is We Do so these images are great you're getting a lot of detail from the images but the question is how do you actually leverage that detail so still what we typically do clinically is just take those images and do fairly crude measurements from those images um to get some idea and those those are um actually you know helping us to understand how to treat patients but we're leaving a lot out right we're just sort of neglecting a lot of the detail that these images actually provide and so one of the real tricks with this is how do we leverage it and machine learning has really become a way in which we can do this really effectively so that's kind of what I'll talk about um machine learning neural networks AI I don't know how many people do anything with that AI neural networks raise handsome everybody yeah everybody yeah yeah it's everywhere right and in my world in computational modeling and imaging uh even for doing kind of reconstruction of images from raw data coming from these scanner systems they're starting to use machine learning so it's it's really coming up everywhere as a technique um and it's evolving fast right so there's a lot of different techniques that we can use uh a lot of different new ideas that keep coming out and getting published um and my group we're really focused mostly on how we can use machine learning for doing what I would say our interpolation tasks so things that uh we can train a network to understand and then it's just basically probing a very similar space again and again so it's tasks that for us are very difficult but for uh neural network algorithm it's it's easy so I'll just talk about a couple ways in which we do this um so the first one is on heart segmentation okay so what we get as I said is we get a lot of movies like this uh where we see the heart beating over time and what we'd like to be able to do is to actually extract the anatomy of this part so I want to be able to see where is the ventricles these two parts here uh here's the septum here's the the other LV uh freewall I want to be able to capture the this anatomy and and say say how it moves over time so the way that we've classically did this was very very painstaking basically you you get a tool like this is itk snap and you go in with a paintbrush and you fill in the areas of the muscle right so that's what we're doing here and it's not that you do this once and you're done you have to somehow make it Dynamic over time so either you have to try to use some sort of image analysis tool to say how do I move this mask as it's going through time or you literally go in by yourself and every time step you go through and you segment again right uh I can say during my PhD I actually did this every time step for a whole thing and there we didn't have a nice tool we had to do dots we clicked dots into the image and we had a point clouds right um so this is this is something that you know we talked about wanting to do modeling to leverage this information but this is a big bottleneck right if somebody has to go in and do this and so this is really where um machine learning has has helped us so essentially what what we use now is is a unit um which is um using just a convolutional neural network and we trained this on about 10 000 segmented images so some of these were segmented from other people and we pooled our resources together so we have it from different scanners different data sets different diseases um and then we could train this unit to give us these segmentations instantly basically so we can pass that information patch the image in and we get back these segmentations here we can see the The ventricle and red the ventricular wall in green and then the right ventricle here in blue we can't see the right ventricular wall because it's too thin but we do get most of the segmentations coming from this so similarly another thing that we we're interested in is finding valves in our images so there's two clinical quantities there's maps and Taps they're related to how valves move and the reason this is important is because it tells us how well your heart can function during the the contraction phase where it's trying to pump blood to the lungs into the body right and so this these two metrics are kind of a way in which you can tell if there's some sort of systolic dysfunction in the heart and so what we wanted to be able to do is to actually identify these these valve points and how they move over time and of course we could just do this this is much simpler than doing the segmentation right now I just need two dots per valve but if you're wanting to do this automatically uh this is a is going to be a painstaking process if you have many many images that you have to get through this gets quite tedious um so again we thought okay can we use neural networks to do this for us uh and we trained this again we used a convolutional neural net when we trained this on uh 8 500 segmented images and really what we're looking at in here is 10 landmarks so we have different image types so this thing that says two two CH this is two chamber you're seeing The ventricle and the the left Atria and then we have three chamber and four chamber so here you can see all four chambers of the heart um so we have these different views they give us different views of the valves right so then in this case we're seeing mitral valve here we can see mitral and triphosphate valve so you're getting different perspectives on uh where the belts are what they're doing and what we wanted to do was to say I'm going to give this neural network an image and I wanted to figure out what valve is looking at where the valve is and how that valve is moving over time right and actually what you can see here this is a tracking it does a very good job of actually identifying this and identifying which valve it's actually looking at so it can figure out from the image which one of these views it has and it can track those those points the relevant points for that view um and then of course it's interesting to compare how well this works and this is a little bit small so I apologize but basically what we can see here are different plots for different valves or for different views here you can see two chamber three chamber four chamber uh these are different views of the mitral valve then we have aortic valve and tricuspid um and this o here is some inter-observer variability so what we had is two people actually for a sample set segment these Valves and how they move and we computed the error between their predictions so how far apart were they uh and then we compared with two image tracking techniques so in that case what we did is we set two points then we used image analysis to track those points over time to see where they would go and we compared that with the neural network and what you can see is that basically the Observer error is on par with the network error and the network another nice thing is it didn't get anything to start with so the the image analysis techniques we actually had the seed where the points should start and that was something that we had to be very careful about because if we put them into the blood pool then they might just track to nowhere so it really had to be pretty specific in order to get a good result with the image tracking but with the neural net it just knew where the points were from the beginning and would track those all the time so this actually is very effective for for really finding these points uh efficiently uh okay so the other thing that we're we've been using this for is for enhancing flow so I told you guys about this face contrast Imaging data one of the challenges that you have is like any image you have noise you have for flow you have something called partial volumeing effects which basically give you some uh inaccuracies near sort of borders of your vessels or borders of the heart um and you can get aliasing as well right this is something where basically you exceed the maximum velocity that the image is allowing and it will wrap so it'll just go to the most negative and loop back right so you get this sort of wraps that appear in the phase of the image um and so what we wanted to be able to do was to clean this up the other thing is is that we're Limited in the resolution because you're trying to get these scans done quickly you you try to minimize the time but that also means that usually we have uh voxels that are too big and so what we've said was okay maybe what we can do is we can train a network to look at low resolution images and give us higher resolution images so it's a pretty simple idea uh we basically took cfd simulations and we generated uh artificial MRI data for these cfd images or for these cfd simulations and we rendered them at one millimeter and at half a millimeter and then we trained a neural network to basically look at one millimeter data and try to learn the physics in terms of how it could up-sample that to a finer scale right and so from that you can basically go through and you can uh train it to have a finer scale resolution here um this will just fly throughs through a stack of this this uh artificial cfd and what's cool is you can apply this to then uh actual patient images so this is not the heart this is the brain but we're using this in a number of different areas um and what you can see here kind of nicely is is these this up sampling so this is an example of what the original resolution was in the brain scan and then this is the upsampled resolution and here again you see the original scan this is a little bit better resolution than here but you can get even higher as you go to this low res with the super resolution and what we've seen or should I don't I'm not showing you here but what we've seen is the things that we're interested in calculating from these flows are more accurate when you use this kind of up sampling and filtering that that you get from Super resolvent um so again it's another area in which neural networks are kind of helping us to figure out a Smart Way in terms of how do we interpret these images and get a better quality image in the end okay so I'm going to talk a little bit then about how we use this though so we have images we have ways in which we can extract information from these images using uh machine learning and now what do we do with all of that so there's certain uh like I said our lab is interested in biomechanics generally and there's sort of two ways that we look at this one way is to say can we just take the images and use biomechanics ideas to directly infer something from an image so then we're not really modeling anything per se we're just using physics principles the other way is to say that we're going to actually try to simulate what's happening in Vivo using computational techniques like finite elements okay so I'm going to first just quickly talk about the physics-based image analysis and then I'll jump into how we do modeling so the big thing that we're doing here there's a number of different um areas that we're doing this but I'll just talk about one so the the one that I'll talk about is about using phase contrast images um and really what you're interested when you're looking at Phase contrast images uh the the most important I would say clinical tool that you can get from this is what is the drop in pressure that's required to get the flow that you see this is used in a lot of different cardiovascular conditions to determine whether or not somebody should go for a procedure so for example if you have a valve stenosis so your aortic valve for example if it can't open properly it leads to a constriction that blood has to go through and this adds to the work that the heart has to do so it increases the amount of pressure the heart has to generate in order to drive blood flow and so if you can look at the drop in pressure that gives you an idea of how severe is that disease right and so what we'd like to be able to do is to actually derive that pressure drop from images and you can do this with this is something that's been done in the case of aortic stenosis a lot with Echo because you can Echo is another Imaging technique you can put a probe on the body and you can quickly get images um but you Echo can't get everywhere right so it needs to be somewhere that is easy for the probe to actually see and aortic valve is is one that's fairly easy for the probe to see but if we want to think more broadly of cardiovascular conditions then we need a tool of how we could first look at flow throughout the whole body and then a way of extracting what that flow means in terms of pressure and that's what we've done here so this is a simple formula up here what we've done I'm not going into all the details but basically what we've done is we've taken navier Stokes equations which governs fluid flow for a Newtonian fluid and we treat blood at this this scale is Newtonian and what you can do is you can sort of rearrange that equation to get a simple scalar relationship between a drop in pressure and different quantities that you can calculate directly from the flow field so looking at changes in kinetic energy how much um blood you're actually injecting through the system and then any sort of viscous dissipation that might be might be occurring and so what this plot here shows um is uh the correlation between our estimates using this technique we call the work it's a virtual work energy relative pressure that's what this formula is and the actual invasive catheter measurements that were taken and you can see that this correlation uh shows a nice kind of relationship between the non-invasive measure and the measure that is acquired basically sticking a catheter in somebody and measuring pressure directly that's great the idea you're trying to get away from putting in the Gap exactly yeah yeah trying to trying to avoid that if possible um another cool thing that we've been doing in this space is is looking at uh flows that go turbulent so turbulence is basically where flow kind of breaks down usually what happens is when flow breaks down it amps up the amount of pressure that's required all right so in severe disease usually you'll get some development of turbulent blood flow where it's just very chaotic um and what's cool about MRI is not only can you sample the velocity you can sample it multiple times so what you can do from an MRI image is you can get the flow uh and also the covariance in the flow so how much variability do you see if I measure the same point at the same time in the cardiac cycle do I get the same value right or if I don't how much does it vary and that gives you flow covariance which is directly related to turbulence and so again you can basically image this covariance and if you plug it into this formula you can again recover a nice relationship between pressure drop and and the flow and we've been uh I showed an example of dissection in one of the slides and we've been doing this uh for dissection as well this is actually a phantom that was developed at Stanford it's really beautiful model um but what we're looking at here is an aortic Phantom uh whereas has a dissection so there's a little tear that's up here and then it has a a re-entry to what we call re-entry tear at the bottom so you can have flow that goes through one channel that's kind of outside here or in this bigger channel that kind of wraps behind the small channel here and they reconnect at the bottom so these two images up here are showing velocity measurements that were taken within the MRI so this is a magnitude of the Velocity field so you can see what's happening in the flow and then these are actual maps of pressure that we derive directly from this data so again using these techniques we can basically come up with pressure maps and what's really interesting here is showing how changes in the morphology of how these entry and exit tears occur in the model changes the the pressure that you see within this artificial chamber that's torn open right and this is really important because what we think is happening in these diseases where you get a dissection and you get a rupture which is the worst outcome that you can get that basically means your aorta ruptured in the body and you're bleeding out into your into your chest um we think that this is largely occurring when you have abnormal pressurization in that in that additional chamber what we call false movement and you can actually see this here we just changed in these two models the size of the exit pair and it basically fundamentally changed how much pressure gets generated in that oral chamber all right um so next I want to talk about how we can use these things for patient-specific modeling and the tools that we use there so in this case what we're trying to do is we're trying to basically use image data together with some of these metrics we can extract from machine learning and re recreate what's happening in in the in the heart um and we do this in two different ways I'm going to talk about biomechanics and fluid mechanics okay so these are two different areas that we use this um so I'm going to walk through how we do this in our pipeline so basically what we get is those images that I showed you earlier of the of the heart and usually you get them in 2D so you have to first figure out how they all align in in space and so we use a registration toolkit in order to get all those images to really align well with each other and then after that we can use this neural network that I I showed you before to get segmentations of the heart so again now we have the left ventricle the the blood pool and the right ventricle and then from that we can also track the valve motion so we can see exactly where the valves are moving over time so it gives us an idea of of where the the ventricular Chambers are are moving relative to the Atria and from this then we can we can actually uh create a computational model like an anatomical version of that heart right and what we use for this is a different amorphic mapping algorithm and so essentially we take a template heart we take these segmentations and we morph them to match each other right so we morph the template heart into the patient heart that we observe and this is actually uh really helpful because it helps with a lot of the artifacts that you get in images so these are examples of some of the images that we get I showed you first the nice clean ones but you don't always get clean images right so here you can see we're getting a big artifact that's streaking across the heart here it's quite noisy um and the neural network does a decent job of actually still extracting where the heart is but you can see here for example there's a hole there's a little hole in the middle of the heart there and it's we don't want to have to always go in and manually adjust adjust these things right so a way to get around this problem is to actually use template models that try to fit the data but have some inherent restrictions to them in this case it's that it has to stay a heart right it can't all of a sudden be a heart with a hole unless that's our template model right so basically we can end up getting a good Recreation of this geometry even though there's some some errors in the in the segmentation okay another important thing with the heart the heart is a muscle right just like your your muscles and your body we know that the muscle acts in a specific direction right if you contract your bicep it's going to pull your arm up your heart is also a muscle it also has a directionality to it and that's really important for how it actually pumps and in the hardest you get this complex uh what we we call fiber structure right so it's telling you how the muscle is oriented throughout the whole tissue of the heart and we need to be able to recreate that in order to represent what's happening uh in in the images and so what you can do is you can use rule-based methods for basically taking this anatomy and generating what the fiber field looks like based on some idea of what it should be and this idea of what it should be is based on DTI data so again it's another MRI technique where you can look at diffusion tensor Imaging to understand exactly what the fiber structure is throughout the whole heart and what we've done recently is to look at not only the ventricles but also uh or not on the the left ventricle but the right ventricle and up to the valve so looking at exactly what does this Anatomy look like and how does it compare with these DTI images and the actual angles of fibrous muscle fibers within these hearts right so that we can get all of this data from MRI and we can actually basically come up with good rules that recapture that that sort of structure and embed that in our hearts all right so with the anatomy we can come up with boundary conditions and from the valves we can also create how the valves move we can plug that into uh physics-based models and run basic physics on this heart to make it contract and here what we're solving is is simple f equals m a for a for a whole heart right so we're solving kaushi's equation of of motion so what does that look like so define an element problem that we end up solving for people who like finite elements is this uh and it's quite long but it incorporates incorporates everything that we have here so we have basically a pde that governs how uh stress balance it occurs within the muscle we have constraints on on exactly how the valves should move we have pressure that's exerted on the the heart walls itself and these can either come from data that we're given or it can come from what we call Zero D models so these are simple models that recreate the cardiovascular system uh and how pressure and volume are are interrelated uh and then we have constraints that try to basically keep um the heart in place as we see it in the images and and constrain the volumes of the chambers as well to match what we see in the image data so the nice thing about this setup the way that we have it is that we can assimilate data in one go as we simulate so a lot of times what what tends to be done in patient-specific modeling is you do some iterative process where you try to run the model look at its results correct it run it again see how it looks to the data correct it and you just go through in an iterative process but here we can actually do one simulation where we are solving for some of these parameters that are unknown as we as we step forward in time and so what this gives us is nice simulations like this of cardiac functions so here we have the right ventricle in red and the left or sorry the right ventricle and blue and the left ventricle in red uh you can see the these heartbeats and what's cool is you can then start to uh look at things that you can't see in images like the active stress that's being generated within that muscle to get that heart function that you see and plot that over space and time you can also look at strains in different regions of the heart and how these are varying in different diseases so it gives you some idea of function uh and how it's kind of comparable between healthy and diseased hearts um and you can also start to look at things like fibrosis so this is something where we can use fibrosis Imaging and embed that into these this computational Pipeline and basically try to account for the physics that are happening there so the nice thing is once you have this personalized part you can start to change things and see how it would interface or change how the heart actually beats so you can do sort of virtual procedures on these Hearts to try to look at how they might be able to predict how that patient's heart will respond and this is something that we're also interested in and working on okay so I'll also touch base on on how we do this for um this hemodynamics modeling so stepping away from solid mechanics and we'll look at fluid mechanics um and the process is very similar in the case of fluids we often are starting with CT data and again in this case we have a neural network that we trained on 3000 CTS to give us segmentations in this case we get the ventricles uh and also the Atria and the great vessels so you get a few other different compartments that you can kind of get automatically nice thing again is that you can apply this to a dynamic CT to see the anatomy or you can apply it to it uh sorry a static CT or a dynamic CT so you can either see just the anatomy or the anatomy and how it changes over time and once you have that you can basically create a computational mesh this is a mesh of the left heart so you have the left ventricle here the left Atria and this is the aortic outflow tract and then you can use what we use is uh image tracking uh to basically take these segmentations over time and morph this mesh to match what you see in the images right so then we have a moving domain that moves exactly like the heart from the images and then we can start to look at solving uh blood flow through that and again the nice thing about using this with the neural net if we try to do this uh by hand it would be a disaster so the CT images are very very fine so it would you know this the number of slices that you have to go through if you were going to do something like painting it would be just disastrous right but with neural Nets you can get these segmentations in Hearts very quickly and then you can throw these into tracking algorithms and then get these um morphing models of how the heart beats and how the chambers move um with with much more ease than we could before all right so then once we have this we can plug this left heart into some sort of lump parameter circulatory model again representing the cardiovascular system so in this case what we do is we have our ventricle which has an aortic outflow and that plugs into uh systemic wind Castle model and that wind Castle model goes then through capillaries into veins pops back to the right heart and we have in this case a right heart lumped parameter model and then that goes through to the uh the pulmonary system and then Loops all the way back into the left atrium so the nice thing about this is you have a closed loop system that's that's basically able to kind of give you how cardiovascular function will change and will feedback through the whole cycle so through the whole system so if you change output that's going to eventually circulate through and it's going to come back into the input that you get um into the left atrial which is what happens physiologically in our bodies right and so we can utilize these to run simulations of blood flow this is a a case of blood flow and mitral regurgitation so what you're seeing here is this is actually maps of vorticity so it kind of gives you a better idea of what the flow is doing but what happens here is you get inflow and then you're getting regurgitant jets that that form in the left Atria and that jet is caused by the fact that the valve that's supposed to close between those two Chambers is not closing so it's leaving a gap and allowing blood to flow backwards and why this is a problem is basically it's fighting the the other side of the heart so you have the left heart pumping blood to the body but also pumping blood against the right heart which is trying to pump blood to the left heart right so this is a big problem but we don't really understand how how these hemodynamics really relate to the risk of uh impact on the right ventricle so how does that maybe apply to the right ventricle it's a fail and that's kind of what we're trying to study with these kind computational models another case we're using this for is looking at tavr so this is transcatheter aortic valve replacement so in this case sort of a new technique well it's not too new it's been around for a while but basically it's a technique where you can implant a bowel the new valve into a patient without having to open them up so you use a catheter to put the valve in place and then you expand the valve and then you can see or you can fix the valve that might be dysfunctional either through insufficiency where it basically allows blood to go backwards or where it's stenotic so it doesn't allow blood to flow out and what we're interested in here is really how how do we get the best outcomes for patients and how do we make sure that there's a good long-term plan so what they've been seeing with these uh tabber valves is that in patients uh they're often living much longer than was expected and these valve they're hitting the end of life for these valves where the valves are now starting to become uh regurgitant themselves right and the challenges is that you put in this this valve which is a big stent with the valve in it and now you have that valve not working right and you can't easily go in and rip that stent out because it basically gets grown into the tissue yeah and you need to figure out what you're going to do right and so what we're trying to think of is you know when you're doing this procedure how do you think long term right knowing that you're going to maybe have to replace this and how what's your strategy for doing that right because uh if you look at images of this it's kind of nasty when they do this what they call a tab and tab they put a new tab inside this this original one it it's missing also the last person uh so they're supposed to last 10 years but it's 5 to 10. yeah yeah so that's that's very good yeah yeah exactly let's put the number on it you know I mean yeah exactly yeah yeah um okay so that was pretty much all I wanted to go through walking through kind of what we do how we use uh Imaging machine learning and biomechanics to start looking at the heart and uh this is just my group who does all the work that I talk about um and I'm happy to take any questions that people have all right as a reminder for those who are online if you have any questions you can put them in chat or raise your Zoom chat hand and put in hand or you can call on YouTube um just two questions first the first one is uh of course I don't have experience in my experience is my time in neural Imaging so when we place patients in Vietnam artist all the time so how can you make sure you can get a quality uh images uh when the house continues to grow yeah yeah yeah so what we usually do um when you're doing cardiac imaging there's two ways that you go about it depends on which kind of scan you're doing and how long it is so one way is that you have two different sources of motion right you have the heart motion but you also have breathing right which is changing where the heart is so your diaphragm goes up and down changes where your heart is so if you image in a plane what you're actually Imaging is changing if the heart is Shifting with breathing um so one way that that it's done is to do breath holds and then what you're doing is you have an ECG that's measuring the heart cycle and then you can basically trigger and bend data according to where in the heart cycle it occurred so if you hold your breath then you can sort of trigger and get bins of of data that you can reconstruct the hard cycle the problem is you can you really only get like one slice in that in a breath hold right um and if you want to have 15 slices like I was showing there that's typically what you get when you get a stack through the heart you have to do multiple breath holds right and the problem is is that you're now relying that every time the person is going to hold their breath exactly the same which is why we have to do this registration because it's never perfect right the other way is using free breathing and there what you typically do is you use a navigator so what you'll do is you'll have a very low weight quick sequence that pulses a line through the diaphragm and you look at where the diaphragm is and you only allow collecting data if the diaphragm is in a certain window right so then the patient can sit there and breathe and then if they fall into the window you acquire data and then you try to figure out you also have the ECG so you have to try to figure out where did that data where should It Go which bin does it belong to Nets takes longer because it depends on how well you set this up right and how well the patient breathes so if you're a good breather you hold a position for a long time and then you do an exhale inhale and then you hold the position for a while but sometimes you'll get people who breathe really weird like they have this sort of Sawtooth pattern and you're like you only acquire data for like a brief snapshot in time so the efficiency that you have can be a variable and that can change how long these scans go packages so uh you'll get the whole segmentation much easier but I think that in Kentucky and I wonder is that because there's no like a reliable template so far that's why you had to develop like with the new uh motion learning to do the segmentation so the the the um I'll say that so it the ct1 that we're using is actually based on um a template that it tries to fit it doesn't fit a template but it basically the the data that it's using as training data was based on a template so where it did template fitting so it had an anatomy that it would morph into place um but for the MRI note we don't have a template and it's mainly um because of the views that we get um you know where you get these stacks of images it's not always reliable and sometimes especially near the base of the heart you'll have images where you'll see the whole Ring Of The ventricle for example and then because the ventricle moves longitudinally it moves up and down it sort of will pull in the belt so all of a sudden The myocardium will disappear but you still want to segment that image so you have this sort of partial Crescent that you're supposed to try to recreate so doing a template doesn't work as well in that case we don't have 3D data that you'd have in the brain so in that case it's it's easier to use these um these straight up neural Nets and then use a template fit at the end to basically say what should the anatomy look like based on the segment thing that I see from the neural net yeah if I make one final question actually because opportunity to everyone so data online after a great talk thank you a question about the CNN training the segmentation are there any known or potential variation in parts of that term that correlate or patient demographics such as sex DNA race and how is your trainings evaluated is impossible or unintended biases that's a great question and I'll say that we didn't do anything to look at that we we kind of in this case we we had data and we used the data that we had um so we did we didn't have you know a choice of three thousands or you know up to ten thousand segmented images that covered all demographics so we just had the ones that we had um just a great answer but it's the true answer um I don't know how it biases I've seen this gun actually looking at how some of these neural net segmentations are biased um there was a paper I can't remember off the top of my head that was about this specifically um and it did show that there was a bias um but I don't know in our case what that looks like um certainly there is variation in anatomy um and that seems to be okay so one of the big areas we see this the most is in the left Atria how many veins pulmonary veins come into the left Atria varies between all of us right so it's not like you're going to always seem the same morphology whereas the ventricles are they're going to be you're going to have unless you have a congenital condition where you have a single ventricle 99 of us will have uh two ventricles and they'll be kind of the same shape they'll be wrapped in the same way so there's a similarity so you can imagine that you could easily warp a shape into that to make it match but with the Atria it's not as easy because you had fundamentally different topology to the structure than um what you from one patient to a next potentially so there there is it seems to be able to cope with that relatively well um but um again I don't know about the sort of the bias for gender or race or um thanks for this wonderful talks absolutely great uh my question is about you know the economics of this from a personalized medicine yeah you know now I think one thing that we have going for us is that these are procedures are generally pretty classic anyway so you know but just in terms of rolling it out there so that people can equitably have access to the personalized you know modeling of the heart yeah you know going forward yeah you know how much would this cost to do and who could have access to it and what's the potential cost savings that would uh offset the cost of doing it yeah yeah these are great questions and and really important to think about as you like develop technology right how what state where are you going to get the impact clinically um I would say um there's multiple answers and it kind of depends on what you're trying to do yeah um so I'll say one area that we're maybe even closer to doing something clinically and then I'll talk maybe about the modeling so one area where we're utilizing this um or we're trying to utilize this is is in aortic dissection I showed you guys some of that data right where you get this dissected aorta a challenge that we had at the moment is how do you predict this this risk of rupture so if it doesn't patient the patients are already going to rupture imminently and so you should do something or is it going to be stable and can you wait for a while the reason why you might want to wait is because there's other complications to the procedures that you do to try to intervene right so you don't have to intervene then it's kind of better just to let it be um and so there we're trying to use this Medical Imaging data we've shown that that some of these relative pressure measurements seem to correlate with the risk of growth of that that new chamber that's sort of torn open on the aorta on this false Lumen and that growth rate is a real predictor of rupture risk right if the thing keeps ballooning then you you know that this is maybe closer to rupturing um and so the idea here is we don't have anything right now we already get a lot of Imaging for these patients anyway so what you had to do was to put them in an MRI scanner and you could get an answer about their risk over the next year or two then this would be better than what we were doing currently because right now we just look at the diameter that's the best core that we have but it's weakly correlated it's not very good um so that's something where I think the cost would be minimal how we treat the patients it wouldn't be a big change to what they are doing um and so the bar would be pretty low right of course you'd need to have a CT and an MRI scanner so you know if we're talking about you know maybe other countries that don't have as much access to these systems in a place like this yeah on the biomechanical modeling the patient-specific modeling this is really more kind of long longer term vision of how this could come in it's not something I would say is ready to be implemented right now there's a lot of things in these pipelines that I showed you that are still not automated that we need to come in so for example I say we get the segmentation but the mesh we have to make the mesh right so somebody has to go in and make it it's not like we can get this directly so there's a lot of steps in that process that need to be refined need to understand the uncertainties how that impacts the actual results but the idea would be to to essentially try to wrap these up and two two ways you could do that one is to try to automize the holes the process the other way is to try to use model order reduction on these to basically do a more direct link between the image and an output that we care about clinically because we can maybe we don't need to have all of the physics to answer an important physics question about what's happening and so that's another route that we're looking at um in terms of utilizing these tools the one area that is an exception to this is if you're looking at response to maybe a treatment like uh intervention surgical intervention so for example I showed you that that video flow with a mitral stenosis where you had sort of blood flowing backwards in the heart the wrong way so what we can do in that case is we can do sort of virtual clipping this is a technique that they use to try to solve this problem and we can look at how that would impact the human announce right so this is a pretty easy thing that's again we don't need any other data than what's getting collected clinically anyway and we could basically give a surgeon an idea of where should you put the clip and how many Clips are you going to need to really stop the regurgitant jet that you're seeing patients um and and this is something that we're working on at the moment I think again that's a low energy but just the broad biomechanical model where it has everything you want and you can poke it in every which way and it works I think that's that's still a ways away for in use clinicals yeah but I mean being sold is to going to classes way back in graduate school before there was MRI we were still calling an MMR and we were the first 3D system foreign you know and then the IDK you mentioned that I was involved in helping to develop that with Bill Laurence and those kind of people were back in the day you know fast forward to now I mean you know what will happen in 20 years will be quite amazing and I I would predict that a lot of the meshing you'll figure out how to do all this is going to fall and it's going to be a consumable on the back end of the system that's going to be hooked and scanned yeah this is where this is going absolutely yeah yeah I mean the medical um Medical Imaging companies already have teams exactly things and um I think their goal will be to either develop an in-house or buy a company that's doing it yeah yeah that's usually so we have a project on the elastography that we've been um we should we've done some work with Siemens on that and they basically told us like yeah that sounds great make a company will buy you off yeah exactly yeah so yeah this is I think where they're going as well is to try to as much as possible have it on the console when you get the image you just say I want this assessment report and then it just runs it for you yeah so I would say given you know what we're talking about you know seeing this General Life and so on 15 years yeah I think they'll be much closer if not already in there yeah 15 years and then maybe you could even do the virtual procedures on the scanner too that would be super cool I could definitely see that yeah that'd be a big uh so it's it's it's it's yeah so your challenge is what are you going to do next well I've got a few beers that's awesome yeah that's really interesting did you have a question you wanted to ask you know we're good I'm happy with it um my question is about ETI yeah because usually DTI the resolutions it's not worth it you want so I wonder uh if you want to like be more sure about the anatomy uh from PTI would you usually like for register to the T1 or yeah so we usually co-register with with uh uh like a ssfp image yeah to get to get that so we it is lower risk so there's two ways that we are kind of working with DTI one is with X Vivo Hearts the nice thing there is that you can basically put the heart in a bucket and you can leave for 12 hours to come back and you can scan to your heart's desire right so you can get really buying resolution images from that um obviously you can't do that in people right so um in Vivo there's totally different scans usually instead of getting a whole heart and getting DTI images through the whole heart you're getting three slices and they're coarse right and so you're getting only three slices and that still takes quite a long time and but this is also kind of a little bit amazing that they can get the data that is coherent right so you're trying to measure diffusion in a heart that's beating and moving in time right it's the heart is actually moving much more than the diffusion that you're trying to image right so it's it's a lot of tricks that they need to do in the sequence development to make that actually work um but the results look coherence I mean it doesn't look like it's totally nonsense so it is it is in Indigo it's a challenge you're limited to the data and we have to do registration with other higher residencies foreign applications um not just predictive accuracy is the most important but the uncertainty quantification um and I'm curious if you're wrapping like informal prediction around some of these model outputs or ways that you're um saying uh we're going to fall back to manual segmentation or or alternative strategies or collect more data or you know other sort of decision points that that may be important yeah we of course we we need to for I mean so there's two answers right so the the one is on the sort of physics-based image analysis there it's it's a little bit easier because we can what we've been doing is essentially a sensitivity analysis so we look at altering the circulation and how does it change the the output and how much variation the other thing that we do is we add noise to the images and we look at how much so you can get an estimate of what the SNR is the signal to noise in the image and then you can basically pollute your image with the same SNR and you can see how much it changes your result right so it gives you an idea of how much confidence you have and those are pretty good to give you kind of an understanding of how much you can sway what you're predicting but on the patient-specific modeling side I mean that pipeline there's there's a lot of different places where um they're kind of pumping in data and that that could maybe change what your outputs are and I think you know we've gotten to the point where we have pipelines that work pretty reliably but we need to kind of go through and start to look more at the uncertainty so there we haven't done as much we still do some basic things like changing the segmentation a little bit but um that's not the only thing that we're plugging into the model there's a lot of data that's going in so we need to take a little bit more into that but we haven't those people in the community who have looked at this but we haven't started yet on that subject yeah I think we are at the hours I think we should probably wrap up that was really good so yeah thanks word
people get their pizza so welcome to the first talk of the semester of tools and technologies seminar series hopefully you saw on the least email I sent out we did add a talk on for the first Thursday in May so we are gonna go through first Thursday of May as of right now so I'll make sure everyone's aware of that and I think most of you have all been here before I'm so familiar with the seminar series but since this is the first one of the semester I'll just give a brief introduction it's basically just a venue to talk about tools technologies methodologies they can be currently in development so it doesn't have to be a final product it could be something that you've used for a long time but maybe you're using an innovative or novel way or source of interest to researchers so anyway yeah so today's speaker I'd like to introduce Adrienne tan from biostatistics I believe and he's going to talk to us about BT there is a sign and she hopefully going around please sign up Thank You Marci so again I'm Adrienne and I'm a PhD student from this department bio stats in the School of Public Health I'm working on genetic variant calling on next-generation sequencing data and I work for my supervisors hire Yoon Kang just to get a rough idea I know if there's anyone here was working on variant calling what car variants are you guys working on looking so it's nice and small okay anyone else works with in those or tandem repeats not really okay assume that most of you use VCF files and VCF files okay I wasn't too sure about the audience so I tried to structure such that you might be relevant to you guys but guys jumped okay so VT is actually a suite of tools returned by me for most of my dissertation work and it consists of three major portions variant calling itself maven analysis evaluating the set of earrings you should get from it and VCF and VCF manipulation so together this tree allows me to make the pipeline to do the evaluation and do all the analysis such that it is accessible to people it's actually available on github so it's more about in terms of reproducible research so so the focus today I'll be talking about this something called the unified representation variance which which is actually an aspect of variant calling itself because we are calling a very end you'll be represented and it has to be in a consistent fashion another part about is about variable number tandem repeat detection which also includes short tandem repeats okay and also some useful tips for dealing with VCFs and VCFs using VT itself okay so Oh first part here no unified representation of genetic variance this was published last year and the problem is actually this okay a variant in the VCF file can be represented in many different ways so this is actually this is the reference sequence okay and this is the alternate sequence okay so the variant is basically or CA decision okay um when you present it in a variant call format okay you can achieve multiple representations given by this for here where the positions are six tree to tree and they have different lengths and the representation of it and mine you this is all looking at the same variant okay so it's an important issue and you study variance because if you look at it and you don't really make sure that you are clear about it you might be studying for variants which are actually the same thing so that is an issue so um what we wanna do here I used to be able to represent it in a consistent fashion and we call this variant normalization so this problem was actually presented to me like around I think three years ago when I was working in a thousand genomes project we were comparing the variant concepts of like eight or nine callers and the problem is there amongst the windows there was lots of discordance and to a certain extent that this Collins is cheat due to representation so we set that in try and figure out so how do we want to represent in a consistent fashion so we want to talk about it we want it to be parsimonious in length that's one requirement another thing is left alignment okay so level imal is something which I think's a Chekhov introduced by the people in two thousand genomes I think people are working with the HGVs representation they use right alignment I think some guys won't okay but the thing is that with these two ideas right it's not really easy to translate into the sequence so what makes it past Moniz and what is left-aligned so if you were to look at it carefully and we work it out it could be worked out mathematically you can just show that the corollary of this is that a variant is normalized if and only if the first these two conditions are met the first was at a loose end with at least two different equal tiles and the earliest start with at least two different nucleotides all the shuttles Alou has length one it's just a very very simple rule and this really helped things a lot um so when I was working on this originally we actually tried lots of different solutions and looking at what other people did you use another hidden Markov model or a liner to realign it with different scores just left align things but apparently then you can just do it before a simple algorithm to make sure that this properties are actually are satisfied okay so oh let's look at the four variants which we had earlier and we based on those two rules that we have right I want to classify what's wrong with each of them so for the first one is at position six okay and a loose right and with the same base C and C are n so this means it is not left lying very simple rules okay and then the second one again there's a a and a at n that means is not left aligned and in this game is also not parsimonious because you can to truncate both the two A's cas or n to make it shorter okay the one is just the pass ammonius because as extra G on the left side okay and then finally the last one satisfy both properties where the n bases are not the same a and G and the front basis is one of them is length one which is G here even though they are both the same so this satisfy those two properties and that gives you the Tamil eyes variant so this can also be proved to be a unique representation and if you look to the paper you can see the mathematical details for it it's a simple thing with a really okay so the variant normalization algorithm is just this um we just apply this algorithm if all the abuse and the same in contact and truncate the right moves and if any of you is lying is you road and extend all use by one you could cut to the left so this portion here does what we call right trimming of the lieu of the variant and left lining at is in time and then after that is done okay we do left trimming if necessary okay so the algorithm turns out to be something really simple to solve a problem which no one was able to define previously and that's why I have this this stop was actually on the wiki pitch from our genome we chief since I think 2013 so we only just publish it recently or say because people want it okay uh so this is an impact of what normalize it causes on topic resources so let me focus on the first column place so before normalization you have nine thousand 1996 in the house here oh this in dowry is actually from data set from dr. Ryan Mills I think he wrote it in 2011 they chose I think ten thousand or so in those two analyzed from the origin onset and their chair so the Walsh I had wasn't funny sup self at 9,000 1996 so it turns out right the after normalization actually they're eight thousand nine hundred and four okay most of them were not laugh alone and and this second row here shows you the overlap with the thousand genome in Dow so if I did not normalize it only five four nine percent remove the left with it but when you normalize it eighty percent overlap with it okay and then off all the night of the ninety nine six forty percent of them need normalization and after normalization realized that eleven percent of them are actually representing the same in downs so yeah this are the car things which we need to resolve when you study in downs and make those changes so I think to date I think most callers you're doing really do it company probably like platypus and freebase so you still have to apply this okay and another example for public resource is the DB snip one for one VCF file you can fire online and it turns out that 14 percent them either normalization and at four point six percent of them will actually done so if you look at in terms of pure numbers it's around three hundred thousand in Dells so this is okay so implementation wise is actually flowing VT normalize so VT actually has the program is called VT but has a lot of some commands that normalize I'll show you the wiki pitch about it this you have to accept also implemented our algorithm you so I can also use it from VCF Cruz Scott norm and this too has been used in quite a few other pipelines out there it's using German line some online tool for variant clearing and data exploration and some variant calling partner use in Harvard called PC bio next-gen and also a pipeline which G mr. Copsey key I know is in Utah from you stop so if you are working in the house please have a look at this just to make sure they are working within dowse correct fashion okay so links to the second father talking what about the detection of variable number of tendon repeats okay but before we start just one your why is this off interest then we're working with this so usually when we are talking about genetic variance we should we discover from next-generation sequencing data will be looking of course at steps which is the most common and in those the short ones which are the second moves common cell variants and structural variants well focus on the first two categories for the next few slides okay what I wanna show our state here first okay this is finding which people were armed and which was discovered by Haley I think one year or so ago is that in dows are highly and rich in repeat rich regions so do you know what are the nature of this in those they all love them a cheese shop tendon repeats and I'll give you some evidence here okay so this repeat rich regions right are define right by short tandem repeats discovered by the tandem repeat finder okay that's around 1.5 to pass our genome and a lot of program called M does which is used in the NCBI pipeline to mass up low-complexity regions which also consists around 2.17 percent of the genome and combined M is around two point three so this two point three percent genome is rapidly is mostly repetitious this is based on grch37 and the percentage of snips and in those in repeat rich regions as shown in this table so this is the thousand genomes space sieve pastry corset which is unfiltered and when you look at the snips okay 162 million of them and 4 percent of them lie in the repeat which region and nine six percent them line and non-routine which region what does stop I watched stuck about this race therefore in those the numbers are to 66 percent versus 34 percent so in that was a highly enriching repeat which regions okay and question even if they have the same correct I'll talk more about that shortly so that's the point I'm trying bring up next okay and that's why we want to handle it properly okay Steam's it's not such a big issue we notice it's around the same proportion so anyway the next step is that photo filter data gave false names right is 2% and like 8% which is proportional to the repeat which regions in the genome but when were in those is 25% and 35% so one thing we should notice from here right is that there was a cough over filtered the short tandem repeats from these regions okay so this is the impact of it on concordance between concepts so let me is Sonny involve this slight mouse so the left side here is the Venn diagram for a repeat rich region okay and this is our four snips okay and I compared it between three colors one is Hamilton color Sam tools and platypus okay the snips here I form 6.7% of these three concepts okay and the and concordance in the sense right is represented by the okay it's around 46 percent overall okay on the other hand when you look at the non repeat rich region I'll use this when you let a non repeat rich region okay the concordance rate amongst our tree cause it is 99 percent so this four stems okay it's not such a big problem for sense because only 6.7% of them cause all these issues so this is not the big problem okay oh yeah this causes for a cheap produce on na12878 PC our free data the high coverage and this was actually reported by Henry in 2014 and I'm reproducing the graph from an asset on a different dataset with different colors okay so the next hour we'll look at will be the endow cosets so again you see a similar that that's very low concordance here for every previous region and similarly it's better in a normal P which we join but is still an issue okay between these three concepts so over here it's also related to the way they actually reassemble the weeds cause hepatech column that was reassembled original something differently and Santos is the valuation basic alignment key but the key thing to note here is this proportion here is that in dollars in this repeat which region is around 66% which causes all this discordance so another way of looking at it is that most of these columns between concepts are all again caused by this repeat wish which any issues okay okay so I'm going to explain what he tried to mention just now actually is that the world problems are is that this tandem repeats where I can actually induce errors so example of this right is this is that that tendon repeat okay is because the copies are all replicated in that fashion so there are fixed time of acs okay and the position of this is at 7 and is TAC is a deletion of one easy copy okay and in as a tender repeat will be the case where let's say the alternate sequence has a different base here so this might be do blah do to sequencing error or it can be a real mutation of some sort okay and when you have this okay suddenly the presentation and VCF right ubermensch normalize it's now a position 19 okay with the reference and CAC duration of AC replaced by a G okay and then we have another one where let's say the reference itself has a bit of knowledge there so they replace a Cu gene and then again you get a different position okay so when you look at it as a whole thing right is that when you're interested in a very when you want to have a variant which is which are able to as say consistently from different individuals so they should be divined by the flange getting stop this a little bit of toys and this are things which cause the discordance between in those because they are actually tandem repeats okay so the question is is then I do wait to actually represent this in as a vntr so we have a suggestion here is that instead of focusing too much on the little pieces here we should actually as a tandem repeat okay and I just represent it as such so they all have a consistent representation in this fashion and this is actually done so far for tender in the colors except for tenderly because they don't really care about the evidence which is actually shown and they like but lobster repeat sick right this is a main next-gen sequencing no they're coming for tendon repeat programs what do you do is that they'll take the reference sequence and they'll discover the repeats there and then the only genotype those which are discovered within they do actually use next-gen sequencing data evidence sense okay so okay that's that okay so this is a wrap which shows the repeat which region being a factor and in down so the shows is a check histogram is the count the frequency of variants the exist represents the length of the in del so positive numbers for insertions negative numbers for deletions so the whole I represent in the repeat which we Jane and the rate one shows the index in the repeat which we J okay and [Music] you notice the key thing here is that the red line has a lot of spikes okay and if you look more closely at the even number like two four six eight this positions this actually thanks to repeat units right we shall a see just two motives are two length long to base long so that's an indicator of it but if you were the blue one also some Kings here so even for the Norwich region they are actually called like this repeats hanging around there so something which you see in many cosets and this is how it's being explained actually okay so okay okay so now we expect is that we need to find we right to do variable number kind of detection not just on a sequence data but on the index you should check it from there so the key thing about this is that the input here is actually not the reference sequence tree risk it's actually the VCF files within those we should get from next-gen sequencing and then you try to figure out what is the tandem repeat which is associative so um again let's break down make up tandem repeat and repeat will have to repeat tract and you also have a left flank and a right flank they have a repeat unit of AC in this case and in this case is the deleted sequence of this so the key thing here to figure out what is the V end here is actually simply a problem of detecting the flanks okay and this will actually be a bit noisy right a Messier when the repeat Trek has some noise in it and we have ways to go around it but first about the easy one where is exact so to deter vntr we just need to get the candidate variants from aligned bands in the VCF file okay and then we do left and right alignment on it so this it's actually based on algorithm which I described earlier for normalization where you have left alignment if you have both the same at the end you just move one step to the left so you can do the same thing for right if it's on the right there are two bases the same on the left you just move one step right okay after you get the left and right alignment you've gotten the repeat track cause I'm assuming it's a actual definite get a full track okay and you do a cheat okay what interesting thing here is that you do not need to know the motive this is you do not need to know the half the motive looks like okay you know alignment and you detective repeat track dan you detect repeat Union it must work because it is si okay and this is how it works okay is that you have a reference sequence and out of that sequence I have the flanks and variable portion and if I do a lineman hour shift the entire thing over here and I'll detect the line actually aligned against so when your line gets to the left you are detecting the flanks on the left this and then when you do the right alignment you're hoping the gaps to the right and you are detecting the flanks here and voila you get the repeat track and of course the flanks at the same time and then once you have this right keep the repeat track okay we use a repeat tree but there's a chip prefix - you shall not gonna describe here takes a bit of time to describe and you can use that to actually figure out what's the most common motif here okay so very simple for exact VN - yes that's how it works okay the problem is when it comes to image that VNTRs rise that how do you do it really get stung if there's a bit of knowledge there so we know the first three steps again okay addition of offset is that we allow for fuzzy left and right alignment which allows for noise okay to obtain flanks and then we pick three steps - and for if the property of the repeat track sequence is low and to do this we actually worked up a hidden Markov model we could repeat away hidden Markov model okay and we actually extended from the description of a local hidden Markov model described in the book magical sequence analysis is written by richard durbin at all in 1998 so this is the graphical representation of it and this is the model with the flanks and repeat unit and right flying so in a way you can treat it as regular it's a robust regular expressions ends okay and we of course this is the full model we achieve more I find it such that you can be using my bow ways to Detective Lang's so how does this work okay so we have won the first step became we have the left and right alignment okay but actually because of this little change here the G here okay that's an addition of a G okay we only extract a little portion of the repeat track which is a T here okay assuming that we did manage to get the basic motive okay we should go at Chaffey drop down okay we'll try and do a fancy left alignment so this is how it works again we look at the two sequences again okay and this time we say that based on what we found earlier we'll set this portion temporarily as the right flank and then based on the 80 motif which we detected earlier we'll try and align this with this sequence and then the diamond will be like this where there's a full match here and then it will generate the robust laughs alignment here with the repeats and then this part here is on the line so this giving our right flank our left language sorry okay can we use that left leg again to put in another model here and generate the 80 copies again and then we get this alignment here and then we get back the right flank and so when you put all this together we get the two flanks and repeat train okay so this is how the model looks and all the time in particular for cases where it's actually not tandem repeat so and you sure about this is that we are trying to order in those not all them are kind of repeat so a lot of them will work but that's what we want to do in the sense that we want to figure out what is not as a key attendant repeat and what is a simple endow that's actually a lot of noise in between is that your spectrum so when you look at tandem repeats from like repeat finder everything actually very nice looking it's pretty pure okay but I actually love indoors right where is a big master and is she filtered out by tandem repeat finder and monster and but we can't get around this when were working with the index itself here so one of the issues that you have nice and being able to systematically classify this spectrum okay but this is the one that allows us to move in that direction okay so the impact of having this vntr this tandem repeat representation is that let's say we have two concepts between RPL purpose and VT okay the okay and the repeat which we joined the concordance is just 55.9% when we normalize it goes up to 60.2% but wearing gold to the techno repeat representation it goes up to 75% so that's how it improves the thing so all the concord dis columns you see right now Mouse collars which people keep trying solve like you have to realize that let's actually no solution for something we just intractable so you want to find you for with representing representing it to make it consistent and you want to do that also because when you're studying genetic variance you're not interested most of time to just study one part so you want to study a population so you wanna find a systematic way to be able to get the information from many individuals so you always do find the lowest common denominator which makes it the same okay so the definitions we winds up is what is different from the reference so we should be thinking in terms of getting the right flanks rather than just picking up everything so this is what what what we were trying to solve soft so that extend but we need to be able to rip out a spectrum on how to actually presented in a systematic fashion okay so this is that okay some other results is that an interesting thing is that for vntr adjacent which overlap VNTRs okay over there right we have something called the tea iced tea B ratio this is transition versus transversion so usually right um a good concept right we have a transverse this ratio of around two point one to point two or more okay we'll find Steve's a chef of pretty low txt beware as overlapping new PNTR and the high one when it's not overlapping the end swish cough suggest that having being able detect this vntr also helps improve your snake calls cause this might be something we should do only one you would want sticks that you cannot consistently genotype and finally because we work with the in down parently itself lobster actually depends only on short tandem repeats of length 6 and below we actually detect more than that so this is some value in being able process in those after in stop depending strictly on a reference set off in downs I'm sorry tandem repeats ok this is implemented in the program annotate in the house you can see this in a wiki data oh sure I can show it to you now hold on [Music] I know tails so when you run this ok this are the industry she observe in the coset this is that in the house these are the tandem repeats me she gets extracted using the algorithm and then it shares more information here on what is the motive the repeat units the concordance values and whatnot ok so this is a perfect one so that was an easy one to detect that's one which is a polity but with two c's in between there okay so it was detected in this fashion okay yeah so this is an example of output in this arch it shows also the trace of the algorithm okay when you and when you extract candidate repeat trackers then you use the prefix tree to detect which are the possible repeat units so it goes to a whole ways of things candidate motives and then it does the left and right for the alignment okay which you can see here the alignments are all done here and then finally outputs the actual repeat track the so you'll see over here that's also nice one extra see here so I think a proportion of this right reported by lobsters around fifty percent of all gender would be tend to be ten will tend to have a little bit of noise in it but I think we're finding quite a bit more actually okay okay okay manipulation and analysis Oh a quick question your so how many of you use VCF files here CMOS you do any of you use VCF files not one okay so um there's a PCI project raid a binary version of easier know many people use it now as you can see but I'd like to try and get you stuck consider using it cause this actually helps speed up your advances in your tools when you write okay so the main thing here is this the VCF aura is a binary representation of VCF hours that means if you have a float in it is that you represent in the computer but two-bit version of the number so you do I try to pass it the pump stream itself actually takes up a lot of time in general the compression between VCF and VCO is that if your data fields are reach priority be service actually be good a VCF GZ okay that's something which I don't think they talked much about but that's the truth of it um this has to do I think with the fact that the by fausto really compress that well on the gzip library actually but if you have genotype data right VCF tends to be smaller by around five to ten percent okay again the biggest thing we sure you have to be aware of is that we're working with like I think 10,000 individuals phonics generation sequencing saving time like 40 percent 50 percent right just due to the processing of per passing of all this text right into mumbles right it takes up around them all the time and it's a smart thing properly to use BCF and that's what I would suggest here so basically it's just much much much faster for analysis I use it all the time now actually and your business records you can also use it to stream records between programs so impact program from one to another you save a lot of time there so those are the users you can think about because in view of the fact that this guy I think when we're getting a lot more data and our classes probably won't grow as fast in most cases okay so um the problems about this is really about I think people don't use BCF house in the first place is that VCF files are extreme opposite permiss if they allow for he does start to fully describe the fields BCI requires all the fuse to be describing that I guess gives a little bit of impediment and people trying to move over PCF and I don't think they realize how useful it is at this point in time and usually you're very large VCF files with income taquitos so so for you to do that you need to write up your VCF from well again with the correct leaders so you have to reproduce and I think then you can convert it using something like VCF to s or VT okay so we actually have a special mechanism and VT that comes go around this is that you produce and this how it works okay you extract the here then just a top part you just modify it Sasha is complete and now you win him as the the name of the VCF VCF file doc Peter and then he just converted with VT view course you Rick the alternate Heda so you'd have to rewrite Intermountain so this is a useful little hat for you to move over VCF files easily so the other thing is that actually reading the PCF files right okay are requires something called HDS lit okay it's actually fairly mature now and you can find it on github is returned by the folks in Sangha ok and that will be a very useful librarian Sleepless in see you write for you to use to process this information yes it takes a bit of time to get into it but the savings are really huge ok ok this chasm camp is discussed and wikis I can go to and check it out in okay and now you're shooting wish I found 4vt is Saudi optimism so how many of you are tree and come to this where people soft their chromosomes is one ten eleven all the time right so this guy issue because in many cases I assume ordered nurse of a variant fouls and I process them in order fashion so in whatever order well then is the order in this fashion I lose a lot of Overland variance so again you want them to be listed and order according to the context listed in the header so that's a little trick here for V T I have a program which starts it by chromosome based on the index so that's a useful thing to do okay and this again is described in the wiki actually that's a few extra things local sorting the chromosome how much I just described and the full sort we should still assume anything the local saw occurs right when the variance is not sorted in only little stretches so you don't have to be sort everything right you just stream it and then you just sort locally within the window so this is so very fast solution for many things here this is something I encountered when we do normalization of variance because when you left align then suddenly it goes out of order so you use this little tool to sort everything so this is something which is useful which some of you might fight um and another thing is that for VCF found sometimes you won't know what's in that in it especially when you get it from the new variant callers and I have a tool called peak and summarizes Auto variance stamps MMPs in those and a whole bunch of artists um I will show you a little bit more there oh there okay so there's a full list it shows you all the genetic variants in all the different categories there might be in the house those who are next to each other mmm peace within the house a mixture of this tree where it's multi a little like then it also looks true structural variants so you can see all these things yet dilution Parliament's everything so just I trade thousand genomes with theta release which you can't you forget it okay and then yeah so this is why you can do okay so another useful thing is the subset of variance so I also implement a whole bunch of filter expressions which I can apply to many VD tools and the first expression series I want to have public in those that are passed okay the second one says that I wanted bollix things which are common because the do frequencies greater than half a percent and in the house that are rare and all them must have a called the score greater than 100 so this is actually really useful and I'm trying to look for problems in my collar set and you might find useful to avoid and to use this right in many of the tools like for example at my view you just use the minus F option to put in the filter expression then you can get one big one and it's described McCain Haider filters just have a look at it I also do a lot of evaluation of my variance which we do power analysis which is comparison with known good data sets and comparisons with known bad data sets which is down type one error analysis and I have it implemented in the program profile in the house there's a reference text to give you all the different reference data to check from a dataset which you want compare against and this is how it looks yeah okay so it gives you for example okay well you are companions DB snip so thirty four percent of the overlaps there then you have the mills data set a and other this here gives you the insertion deletion ratios and a frameshift non friendship proportion ratio proportion and the ratio and then this is the sample reference for which contains all the information which you want so all these false this is so available in our resource bundle in VT where you can just download it from the wiki page actually vsauce bundle here so these are all the reference files you can use thousand genomes anyone to itself a from the Platinum dataset Janko annotations tender obtains yeah okay and finally also does mandolin error analysis so now this this is actually really really powerful way of doing things when you have experiments always good to have families there because this is actually independent of many other factors and it's just a very useful tool to be able to check for errors in your gene typing okay so again you can find it there and I think that's the end of talk okay so a lot of time my boss Arkansas all and Mike and Bryan Mills so are there any questions [Applause] because if that's not
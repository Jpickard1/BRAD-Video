right great yeah thank you for having us so so today we'll be uh talking about uh showing some bayesian models and accompanying software with a brief uh you know high-level demo of some um methods we've been developing in our group over at the school of public health as well as you know dcmb it's on panomic data integration uh integrating different types of data that's sort of the common theme here and so i'm vira baladin utapani i'm a professor of biostatistics and we'll be tag teaming with rupambattacharya who's now a third year phd student in the department of biostatistics and has now led one of the one of the topics here that we'll be talking about and chinmay is a first-year phd student in the department of biostatistics who's going to be talking about some implementation of one of the softwares that we've been looking at for the past few months and so uh just like i'll start with a very high level almost a 70 000 you know high level overview of you know what why we are doing things and also how we are doing things to just set some context and and draw some connections with the with the methods you know more you know the formulation of the methods rather you know um that that we've been we've been sort of working on so uh i mean this is an off repeated figure you know uh data integration across across multiple modalities that that encompasses not only genomics uh but also other types of data and there's a growing interest in this uh in this area especially over the last few years and the key goal being how to extract biological or clinically implementable knowledge from these data sets right and and i usually say this in in in some of my talks that i've given you know for the last few years just assimilating it together i think i think this might not be an understatement to say that you know data integration may be the key quantitative challenge that could drive modern science and just just the availability of this data you know in in various you know scales formats you know sizes uh makes it makes it really interesting as well as challenging right so uh so in part of my role i also work with the cancer center so most of my research has been focused on using cancer as a disease system there are many bad things about cancer but you know one of the good things from an analysis perspective is is it's one of the most well characterized physiological path biological disease systems especially at different molecular levels and that makes it sort of an uh if not an ideal but at least a very amenable playground to try these different kinds of uh you know integrative methods and motivate these different kinds of integrated methods so these high throughput data you know now are available uh um not only on tumor samples but also other kinds of model systems that includes patients cell lines uh patient derived xenografts organized and and that's growing by day growing day by day and uh and these include not only like you know big consortium national and international consortiums uh but also uh accompanying consortiums like the cancer imaging archive uh and as well as within our own institution with the precision health and the michigan genomics initiative being some case examples right so uh so what what what what at a high level what what sort of our goal in in developing methods and what sort of questions do we answer so to to contextualize that a little bit more in the context of precision oncology um i'll probably uh you know uh give a brief you know a quick summary of what what precision oncology is and and where it's possibly heading and i found this nice uh review paper by schreger and tenenbaum that sort of uh you know has this whole life cycle of precision oncology broken up by you know sort of three you know what what's precision oncology 1.0 which is probably what was you know 5-10 years ago you know depending on small number of molecular abnormalities and always constrained by the tissue of origin or by the by the organ now and a 2.0 version that's sort of where we are right now where uh then the number of possible actionable or clinical uh markers is probably the dozens or even hundreds and and could be tissue agnostic and 3.0 is probably uh you know in works on the slope for for future implementation is is how do we you know get to uh you know uh panoramic analysis and and then more more quantitative statistical reverse engineering and network analysis and that sort of you know completes this lifecycle all the way from bench to bedside right so within this this this framework that's where our group sits in in developing methods uh that not only uh looks at different kinds of mechanism biomarker or mechanism driven discovery that's shown in this quadrant and also look at network-based models but also uh keeping in mind clinical translational applications but how do we you know keep that as a as a frame to uh you know to contextualize these models and and of course our final product in terms of software visualization and tools right so for today's talk uh that we'll be covering two methods that that we've been involved in over the last few years one is on on targeted discovery and specifically a class of models called the ibag models which stands for integrative bayesian analysis of genomics model and then briefly hit upon some generalization extensions but uh that's uh that's the part that chidmay will be showing uh towards the end of the talk uh about uh a shiny app and a demo of that and then uh andrupam uh but acharya will be talking about uh a sort of a complimentary as well as an orthogonal uh stream of work in data integration it was how to use uh network models and and this concept of personalized networks in cancer what does it mean and then how how how do we develop those so basically covering the whole uh discovery to translation cycle and and also looking at how do we calibrate drug responses uh integrating data across patients cell lines and uh and human tumors all right so uh so i briefly hit upon the eye bag formulation uh to set the context of uh of the methods that uh now we'll be showing some uh demos for uh so uh so the ibac conceptual framework if if we arrange you know we have multi so the basic setting here is that we have this multi-ohmic data at different levels that includes genomics epigenomic micro rna transcriptomic and then we have the outcomes so if we organize it this way and the key principle behind this is that expression you know uh is sort of like a you know coalescing of these upstream molecular profiling data and and everything is goes through this conduit to eventually uh you know uh affect the clinical outcomes so that that serves as an intermediary you know and and and and have two sets of models one that you know looks at the upstream uh molecular profiling data and how it affects transcriptomic the uh which is basically the gene expression and how that gets tied in with the with the clinical component of the model that ties in with the clinical uh outcomes and the phenotypes and basically put the two two together and that's that sort of is the conceptual uh schema of combining these two so in terms of the formal mathematical construction i won't go too deep into it but the key idea here is now so if you think about each of these data matrices have been high dimensional data matrices you have gene by patient for mrna you have gene by dn dna level you have the micrornas the methylation and you if you have clinical outcomes which you know could be anything conceptually you know it could be a scalars you know simple like uh survival times or it could be multivariate you know or even image you know and that's something that we worked on actually some of it in partnership with arvind rao you know in extending these models to imaging phenotypes uh so what we eventually from a probabilistic perspective what we want to actually get to is sort of like a joint distribution on all the data types and and this this deconvolution of these two components into a mechanistic and a clinical model uh uh using expression as a common uh you know as defining that conditional representation and and having two sets of models one driving the mechanism and other driving the clinical responses and with some parameters that link the two models to incorporate the shared dependency and that's that's the idea here now and uh and and this formulation is pretty general so one can use any type of models now so we look at regression models because they they they accord great flexibility and we're bringing in different types of uh structures now especially if there is uh regression models are value utilized you know in a variety of ways and there's a lot of structure one can incorporate in terms of pathway information abrara information uh in these modules but but but the formulation could be no for example you could have any model here no that that could that could as long as this conditional representation is assumed right so uh the the exact formulation of the mechanistic model this was uh our original ibag paper back in 2012 just done work done by uh wenting wong and my phd student elizabeth jennings since uh and we have we have different iterations of this just uh improving upon the the formulation of the models making it more flexible but the key idea here is now the first level is just a regression model that breaks the expression you know into multiple components driven by the upstream factors so it's basically it's partitioning these partitioning the the cumulative expression and it can be sort of thought of as a denoising step for the for the uh gene expression and with the added uh uh benefit that it can identify what is sort of called driver gene so if this if one of the components of the dna is significant then and that could be a potentially dna driven gene or a methylation driven gene and and once and in terms of parameterization again we uh we keep these parameters pretty general so we made it as a non-linear function so that could be a non-linear dependent potential non-linear dependency between the dna and the mrna or methylation and the mrna and and the interpretation of these components is part of the mrna that's explained by upstream platforms now so what is what what the ibac does is basically on a gene by gene basis so if you have a you know gene by a number of samples so for each gene separately you know this is one although it could be done jointly but that makes it easier to run into a gene by gene and then extract these components the f1 f2 and f3 which are the different components and that components actually feed into the clinical model before i come to that uh just to caveat that this error term right here that i'm showing so this term is not the true error as in a regression model so it's it can be construed as a you know uh the s the estimate of the percentage mrna that's not explained so that could be many things that drive the expression you know that we have not accounted for here like transcriptional factors or or any other upstream platform so anything that's not explained by these factors now gets collapsed into that into that episode on term which is hey vera can i ask a quick question can you add additional uh covariates to this like age or if you know the major subtypes of tumors can you add that that's a great question so you can theoretically you can but that actually comes in you know that's actually a perfect segue to my next one so the that those factors we added for the clinical model rather than the magnetic model so the belief here is that the mechanism if we have a sample of patients the mechanism should be pretty homogeneous we don't have to adjust on that level but when we want to find association with clinical phenotypes that might become a factor like how well does genomics do accounting for others these factors the clinical and the demographic factors no yeah well i'm surprised by your statement because everything we've learned in the last decades is that tumors and patients with tumors are highly heterogeneous so somehow we have to account for this marked intra-tumor on inter-tumor heterogeneity in all of these molecular features in fact as you know very well i think the cptac project is about taking subcategories of organ described tumors of origin and identifying multiple subtypes and even then they're highly heterogeneous that's right yeah how do you address that or do you even have a way to think about that here uh so in theory that's easy to adjust like it will be adding in the covariates at this level you know and then basically having a term in here no but that's a really good question now that that we don't do it with this this formulation that we have here uh we don't actually so this is we can only account for inter-tumor heterogeneity because we have only you know sort of one observation per tumor here but but that's a really good no it is it's not explicitly getting adjusted for but implicitly like these terms right here uh are individual specific no so these terms when we do it on a gene by gene basis so it gives me an individual specific uh metric or a number that can be used to translate to the clinical model so we are implicitly doing we're not explicitly in the mechanistic model accounting for the heterogeneity but that's something yeah that's a really good point to think about to not only incorporate in the clinical model but in the mechanism model itself right and we could could differ by stage and and when i get to the second part i think we're doing it in a different manner but not here thanks for the great questions that's maureen and yeah i was just thinking that you know it's very rare that you'd have all of the different omics in the mechanistic model that actually make a difference so like if you have more information on you know subtypes that could help make up for some of the missing mechanistic data yep yeah that's a great idea then the first item we didn't think about that but that's something moving forward you know so uh yeah so just uh carrying on we basically the the components from the mechanistic model feed into the clinical model and and that's also a standard regression model that we have but i want to just briefly comment on the on the what is the interpretation of this model because that's that's uh you know that sort of was the genesis of this work and and the way we think about these regression coefficients it's it's not the actual uh dna or the mrna or the um methylation we are bringing in so the easiest uh conceptualization is thinking about genomic switches so uh you know if there is some circuitry in the in in the uh the cancer genome you know that could be conferring a positive prognostic or a negative prognostic effect on the clinical outcomes of this think about prognosis so there could be multiple switches that can be turned on and on it can be the epigenomic switch it could be the genomic switch or it could be just the possibly the transcriptomic switch so these these parameters right here corresponds to those switches and it doesn't have to be mutually exclusive it could be that the both the genomic switch gets turned on that drives the expression and hence the survival or it could be the genomic switch that you know that's that's modulated that that's the effect is modulated by so so these regression coefficients have a very specific meaning in this context of connecting it uh with the clinical outcomes right so uh so this sits on a on a on a bayesian model which which sort of builds on a prior you know set of price that borrows strength not only across the variables but across the genes as uh not only across the genes but but also um you know um a hierarchical prior formulation and and and this as i said you know hit upon earlier this this accounts a lot of flexibility in terms of incorporating a lot of different types of uh shrinkage properties not only pathway-based but also graphical correlations and that's some work we've been doing to incorporate that so essentially you know after all this you know complex model building like what exactly goes in and comes out so in terms of the model fitting um no so this is the mechanistic version of the model the clinical version and what we get is now a few outputs that are interpretable one would be this integrative heat maps that tell us the percentage uh explained by the upstream factors so that could be genes that are driven by these different you know what percentage of upstream factors uh drive this gene expression and and plots like these manhattan plots which tells you for each gene not only uh now these are the you know sort of the uh plots of the posterior probability similar to p value plots and what is the mechanism of action was this green gene driven by methylation was it by copy number or was there some other mechanism and and a list of genes based on different thresholds on those posterior probabilities right so as i said there are various extensions of this that we worked on uh the ibac that will show a demo we have a pathway-based version that takes into account different pathway level information the external pathway level information and a functional ibag gil you might be interested that we're working on maybe we can chat some time about it that includes uh you know rppa and mass spec proteomics data so it adds in one more level of proteomics to the expression and then so it becomes a hierarchy of upstream flat force platforms expression and then proteins and then clinical outcomes yes of course as you know we have the cptac data sets that would be very useful in uh applying your methods yeah and both the global proteomics and the phosphate proteome right sometimes even other modifications right and and rupam is actually that he's working on a project exactly that that's character then we can now we'll be showing some proteomics data as part of his talk and but uh you know we can circle back on that and then finally shout out to arvind who's who's who's been a collaborator on radio that sort of you know jigged our uh you know extended this to you know extend to radiological biomarkers as well right so uh so in in terms of network-based approaches this is actually has been a sort of a pet project of mine over the last few years on this concept of personalized networks so when when someone thinks about networks it's usually a population level quantity that means it's across samples and and and how do we from static data from static molecular data how do we get networks that could change across patients and not only the the edges which might be the connectivity between the genes but also their strength and how does that change across the across the across the samples and in this case the patients and and that trajectory might be anything but could be disease evolution types of cancer or or different aspects and that's something we've been working on and and that leads to uh you know rupaul's part where he will show some you know uh some uh background and work in this regard rupam you wanna right so uh i hope everyone can see my slides and hear me okay let me know if there's an issue and i will continue from wherever uh vira left it for me so uh i'll just wait for a few seconds on this slide so this is what the overall project is about this is sort of the uh overarching figure that describes everything that we are doing in this so as you can see like from an inputs perspective there are three things going on here there are patient proteomic data there's a lot of proteomic data and then also there's a land drug sensitivity data and it's about how we combine them how we utilize the network information uh among the pathway proteomics how we use that to do a drug sensitivity prediction and then how do those predictions fair uh how do we validate and evaluate those kind of things so that would be sort of the overall summary of this project so what i will be doing is that i'll show you a couple of slides on the background of this so why we are doing this what are the questions we are trying to answer and what are our strategies and then i'll show you a demo of the results that we presented in our shiny dashboard uh regarding this so let me start with the big background that we have been using so the problem that we are trying to answer is again as we are described in the context of decision oncology and we are trying to optimize treatment to each individual patient so we are not saying that okay whoever has this cancer in this organ at this stage gets treated by this we are trying to say that everyone should be characterized at a more granular level and that granular information should inform uh how they are being treated using certain therapeutics or drugs or anything so uh it's a relatively simpler problem from a simple data analysis perspective if you have the right kind of data because if you have the right kind of training data for fitting your models uh which could look something like this you have different levels of omics you have clinical data and all and essentially you could make whatever model you want to make here using say uh some drug response or clinical information as your response and these things are your covariates you could also add in demographics or whatever you want to and then once you have fitted that training model over a fairly represented example you could just use that to spit out predictive numbers for future patients that are working in and that's what really the problem is because it's not really that simple to have say for one drug a lot of drug responses from a lot of patients because you cannot just go ahead and treat patients with drug and see what how they're responding to those things there's usually a clinical regime involved in that and all sorts of other things so essentially this is the bit where we cannot have everything that we want to have in scenarios so what do we do we bring in another level of information and that information is moral systems so things that represent a tumor as it behaves in a cellular environment but that are outside the body that we can apply whatever we want on and then see how they respond to certain things so of course there have been different model systems discussed in biological literature over the years there have been cell lines organized and other things as vira mentioned and of course there are all these databases available nowadays where you can have a lot of uh multi-platform data for each of these things so what our idea here is that we connect these two sources so we connect the pharmacological data that we have for cell lines to the large skeletons that we have for both patients and cell lines and while doing that we utilize also the individuality the heterogeneity of the patients when we find make the final decisions or predictions and there are a few things that we need to take care of here uh that we need to account for in the model and that's where the network part comes in so first of all the genes are not really acting independently and their accumulation of effects is not really simple or linear there are interactions and cascades going on in between them in biological functional pathways uh there are also variations between and possibly within cancer lineages so depending on what site you were looking at you could see different behaviors and also there are variation across modern systems because even though uh these cell lines are supposed to represent the patient tumors uh they are in a completely different environment they're outside the body and it can be pretty different from how a cellular environment behaves so we need to account for all of that inside our model somehow so what do we do so first uh we just lay out what kind of data we have so if you look at a simple two by two table uh if i simply talk about uh just for proteomics for a while this could be multi-omics as well but uh if i just focus on proteomics for a while this is roughly what you look at and the part is this is the one that's missing so you have these you have these you also have these but then this is the one that you don't really have so how do you fill up that gap that's the question and we say that we take a two-step approach so first we just look at the patient and the cell line proteomics and somehow and i'm being very vague here we try to compare the proteomic activities uh cellular similarities between these patient samples and the cell line samples so your approach here be saying that suppose i give you a number of patients which are the top matching cell lines that are similar in terms of proteomic activity with those patients so those cell lights are what we call avatars for these patients once we have done that then we go to the cell lines so whatever top matching cell lines great cell lines that we have for these patients we build a training model for them because we have both of this data now and once we have built that training model now we use those to predict whatever missing response we have here among the patients so that's sort of how this is supposed to work in a combined two-step manner and this part where we talk about connecting the patient proteomics and the sunlight proteomics and computing sort of a similarity matrix that's where the network comes in because we do it first of all we do it cancer by cancer so we look at uh one patient cancer type we look at all the samples and we try to create a set of uh try to identify a set of cell lines that are similar to those patients and to do that we do our analysis pathway by pathway so for each cancer and each pathway you fit one uh global network model and that sort of informs your population level and sample level networks so i'm not really going to the math of that how exactly you're doing that i have mentioned other references down the line uh where you can go into it and if you have questions about that i can talk about that more but roughly these are what we get so we get first of all for each sample our pathway or network aberration score which sort of tells us that how a non-neutral activated or repressed pathway is for a sample and then using those we compute the similarity between the patients and cell life and that can be done in multiple ways once you have those force uh you could either uh just compare the network that instead of having this force uh you could also compare the correlation between these fours or you could do something like a unsupervised hierarchical clustering that would tell you that okay these cell lines are in the same cluster as these patients so uh these are possibly similar something like that so that completes the step one in step two we build the response models so we have particularly used these bart models that are known to have good selection as well as with prediction so our response is essentially the sensitivity to a drug or compound and then our covariates are these pathways scores that we have already computed so that's how we train our model and then use them to predict uh and there's an existing literature and our packages and everything for that so i've just borrowed it from there uh so then i'll go into the demo but before that i just want to list a few resources so this is our published paper uh this is the data page of our project so we have all the codes and everything we haven't really made it a formal package yet but we have all the codes up there and we can recreate all the figures in the paper you can also run it on your own data as long as we have the format and everything correct so give this a visit if you are interested and then comes the demo part so this is the uh shiny dashboard that i am going to talk about for the rest of my time here and we also have another demo video on our youtube channel so if you miss anything or if you would like to listen to any of the parts in a bit more detail you can head over there so now change the share and just go to the dashboard and spend the rest of my time there right so let me just uh this so can you see my browser like it should be loading we can just see it it's processing a request right yeah okay let me just stop the sharing and do it like this yeah it should be okay now is it yes okay great right so this is our shiny dashboard this is the first page is essentially just an overview so it talks about what things we are doing it uh tells you what are the different uh functionalities that you have available here on this dashboard and then what are the contents we have and all that so let me first go to the very most granular level of results that we have here so uh remember how we talked about uh fitting one model for each cancer and pathway combination so we do that for both uh the tcga samples and also the ncopal lines and uh this is where you can just look at those networks so essentially what you see in these networks is that for each pathway the nodes are essentially the proteins that are in this network and then the connections are determined by the posterior probabilities of those edges so essentially if you uh think of that age sort of like a binary switch like one or zero then it's essentially in the fitted bayesian model what is the probability of that being a one that's what it's determining right strength here and we have done this across 31 different cancers from tcga and also uh 16 different cancer tissues or sites from mclt so you can interact with this you can look at the different models that we have fit and also we have looked at 12 different functional pathways and that was more uh relied on base identified based on previous literature so you can have all those sorts of networks you can also like uh click on these things and uh look at certain subsets of these networks and stuff but then this is a lot of information to process right so what exactly do you get out of this uh how exactly do you use this so that's where the summary is coming so we do two level of summarizing first of all we do a fan cancel summarizing sort of uh when we say that for each pathway we'll just be looking at each age so essentially if i just zoom in a bit what you see here in the rows are the different edges that you could possibly have so these are the different protein protein pairs and we're looking at undirected edges so there's no ordering here uh so across all the cancers we first of all see if we can see any sort of patterns in low bridges so for example if you see a banded line across a row that could tell you that that's something that's present at the time cancer pattern similarly if you see something like this as a column then those areas are possibly uh turned out to be important in your model uh for that cancer and things like that and also we plot network and the network h strengths and weights and things like that and then we go into another final level of summary and that's when we bring in the comparison of the patient proteomics and the cell line proteomics so the first summary is really simple we say that uh two uh sets of cancers one's a line one patient are connected fire pathway if they have and again i'm being a bit fake here if they have similar level of network activity so we have certain matrix and cutoffs for that how you would see this figure is essentially saying that these cancers and these cancers have similar level of activity in these sets of pathways that sort of look at it and we also did a subset of that uh just looking at the issue specific matches so you have a kidney cancer here and kidney cancer here and so on and subsetting of that figure gives you this uh you can also do a simple correlation as i mentioned before while showing my slides so if you do a simple correlation this is how it would look like so you have all the the line tensors here all the patient cancers here and then the edge colors are telling you where the edges are originating from and ending in and depending on what the how thick the edges are you are knowing how strength of that connection varies and then comes the hierarchical clustering that i also mentioned so this would be just simply looking at all your patients audio cell lines together having all the pathways course now and just running an unsupervised clustering on them and seeing who ends up on where so you have three bars here as you can see on the rows so this one tells you which uh source is the sample from this one tells you if it's a patient sample or a line sample so this darker dots are essentially the cell lines and then this tells you the clustering and what's interesting here that if you do this there will be patient some cell lines will be sharing features so for example if you look at cluster 4 here there are patients and there's a landscape and what we can say from this is that those patients have similar proteomic activity as these the life that are present so that sort of goes into our identification about our cell lines so this is at a global scale this is doing it for all patients and cell lines what you'd rather do if i had given you say one set of patients and told you to identify matching sunlight for them you'll be taking those patients you'll be taking all the cell lines run a clustering like this and see which lines end up together with those patients and then that would be sort of your matching site that goes into the next step so now comes the final step now comes ask about these heat maps i'm trying to see if any of these which of these tumor types by anatomy so look backs are more more homogeneous than others so maybe c8 is a good example right what is c8 i don't know what that is this and c8 is breast cancer so this is right here a breast cancer that's very surprising because we know there are at least three major different categories of breast cancers right so you can see here like c8 is this color and the same color appears here in a different cluster as well so roughly speaking and then there are a few of them that are hanging around here at c18 so uh this is sort of like the larger subset of the braca samples that we have this is another and then we have a few here [Music] so the breast is dark blue is that what is that color is all right yeah if you would call that so yeah that's essentially this right here so these numbered clusters are not by anatomy these are by pathways these are just by the pathways course that we have identified so uh when we're running the clustering no information about where the samples come from going to there it's completely unsupervised yeah and and gil to your point actually we also did an analysis not in this paper but a previous iteration of this where we looked at the uh classifications of the breast cancer by the different subtypes i think is the peru subtypes they are positive and and looking at pathways scores and how well they are prognostic now uh if we had known subtitles that was a more supervised analysis now and uh and we did find some some differences you know between between the different subtypes using the pathways course right so on the vertical here um some of these pathways are big processes like apoptosis and cell cycle and so forth the one that jumps off the page i guess is ras which is in great many different tumors but still a little bit heterogeneous uh there are only a few like that ras rtk of course rtk has a lot of different kinds of receptor kinases isn't it right so these were the pathways that map from the rppa data so the under the hood this is using that antibody panel that's a real problem i think i i've never done too much with that data set because i didn't trust the method and it doesn't capture quantitation of very many proteins so the cp tech is the new generation of data i would say easily i mean that's those are sort of like for lack of a better word cherry-picked proteins and and which are clinically actionable so it's only around 200 to 400 antibodies i think they've increased it to 400 now so the set we worked with is i think is around 200 300 and that's that's the limited set of proteins i think the version that i use for our ppa was like 200 odd proteins and then when you subset it map it to these pathways i think we had like 75 or 80 something like that and also like going back to the point of like subtyping and stuff we also did one small supplementary analysis here which i didn't mention but so for the hidden examples these hnsc samples we saw that they were sort of like broken up into two different groups like one here and then one here what we did was we just did uh so this is unsupervised clustering and that breakup is completely unsupervised as well what we simply did is just we compared those two subgroups of patients in terms of their survival which is also available from dcga and we saw that there was a clear separation uh by doing a simple uh comparison or simple testing so how how else are those two subgroups different uh so these two sub groups that we saw uh here uh so for example if you look at h and see here this color then uh these are the subsets that are identified by the clustering so the clustering doesn't know about where these patients come from but it only knows about this pathway activities what we compared uh between them was the survival we didn't go as much into like their other information that might be available like clinically how different they were and things like that but yeah possibly that could be one other investigation that would be well the two big variables for head and neck i think one is hpv the human papillomavirus positive versus hpv negative we've done them separately in the cp tag very different the other is anatomical because head and neck covers a lot of different structures from the tongue to the larynx and the pharynx and so forth and there are different subsets depending on which combinations of anatomy and that information is often available that's part of your clinical parameters i hope yeah i think we did have the hpv i don't think we had the anatomy as much right we did the hpv it was also present in the previous paper that vida mentioned as well and there also we did something similar just as a survival and again there the difference was pretty significant but i don't think we did that right well our cp tech paper on hpv negative head and neck squamous is out in cancer cell if you want to look for it it's a it's good paper okay so let me go into the last bit of this demo so now we come to how we chain this model so we've sort of looked at uh this into two different subsets of information so of course like for a given set of cancer patients uh you can identify different sets of massive sunlights and then you can train models on those so we sort of try to train models on the different tissues that we had for the cell lines and tried to see uh what pathways were turning up to be higher uh important predictors in the bark models that we were fitting so the first few plots that we'll see here including the spider plot and then these uh pathway networks they are mostly summarizing those things so you are essentially trying to sort of rank that in which tissue which pathway is becoming a more important predictor and again we are doing it across all layers of information so you can look at the different the lines that we have you can also look at the different uh drugs that we have been using and things like that and then accordingly uh you can go into the final drug response prediction now here comes the tricky part that after you predict drug responses for patients this was a question that we spent a bit of time with that how do you validate those how do you really know that you are actually uh doing something sensible so we sort of did two things one that's presented here is that we ranked this patient cancers uh corresponding to drugs depending on how much predicted sensitivity we had for this drug so these percentages that you see is the percentage of patients who have greater than 0.5 predicted sensitivity because we are talking about a 01 scale here and what we found that the top ranking drugs corresponding to the different patient cancers are actually some that are quite well known in the literature and they are actually used in a true clinical setting to treat those cancers so that was sort of like one literary service validation that we did we also did some other validation with uh some drugs a sensitivity data that we had from pcga and they're also the typical metrics that you use like a use even stuff turned out to be really good so these percentages for cell lines are for patients these are for patients so for a patient cancer suppose you have n number of samples what proportion of that uh and number of samples are predicted to have higher sensitivity this is quite astonishing there are very few drugs that for anything they work in 100 of patients or 90 percent of patients yeah so that really depends on the cutoff here so because this was on a one scale that we were predicting uh we decided that because of having a greater than 0.5 sensitivity so depending on how you are tuning this uh from your final model these numbers may be changing but i guess what's more important than these absolute numbers here is that is this relative sort of ranking of drugs that's sort of the message that we try to be from here so and then there's this final page where you can uh look into our github page you can also download all the codes and everything so that's where i will finish with my part and hand it over to chiang mai and well china is loading up guilt to your point so this was sort of you have to take this with a pinch of salt the reason being that this is from the tcga data so the tcga clinical files have what drugs the patient actually got and as part of that treatment so this was like a alexa i would say a mini validation so do we at least get that right no well they say they got to does it mean that they responded well to it or just recently prescription we don't know they just got it we don't know if they responded or not all we know is they got it but this word sensitivity implies more than that right so yeah i i don't think that's the interpretation here it's just like you know like a backwards validation say okay they got it you know did we get that right no yeah i mean a true validation would be on a clinical trial where we know that this drug was given and we know the sensitivity you know for all those drugs nearly all those drugs have been through a lot of clinical trials actually and and corresponding genomics data at baseline right the proteomics are or you know maybe run this through with an expression yeah proteomics less now right all right uh well thank you for that presentation and i'll go on to talk about kind of what vera was touching upon earlier regarding the ibeg framework and what we've done to sort of make it more accessible for people so i've been working on a shiny application to sort of introduce the ipad framework and allow people to fit their own models and identify driver gene so this is our shiny application and you can access it and then actually input your own data so we have a data input page where we take in csv files for copy number variant data methylation data and mrna expression data now this is used to build a mechanistic model and then you can also input clinical response so i've already inputted a bunch of data in just to speed up the process and the data i've imploded in is a glioblastoma dataset so this will be genes associated with glioblastoma and then survival times of cases of glioblastoma and after running the analysis what the ibeg framework will produce for you is a bunch of posterior probability plots for the coefficients of the various different genes along with their corresponding genomic data source a methylation copy number variant and this will tell you the probability that the gene that the data source associated with a given gene results in a certain percentage of increased survival time for the top plot and decreased survival time for the bottom plot and this slider you can actually change so if you're looking for any genes with a 20 increase obviously that's going to be very rare but you can adjust the slider as you will to identify these genes at least through the posterior probability plots then you can use the gene tables and this will actually just give you the list of genes which pass through the thresholding that you selected through the posterior probability plots so in this case um gene pik 3 r2 is known to be significant at least regarding its methylation data for positive effect on the outcome and then it'll also find the genes which are associated with negative effects and their corresponding data source and then the final plot that we produce for you is a heat map which tells you the proportion of variability explained by the various different data sources in the mechanistic model so you'll notice that most of the genes the methylation data doesn't really give too much information and give too much signal but for a couple genes at the bottom such as egfr the copy number is a lot of information about 75 into the values for the mrna data um this final column just lets you know like okay there's additional information that is not able to be captured by the mechanistic model but it's it still exists and this will help you identify which data source contributes to the effect of the certain genes so on this slide why is copy number on mrna why are they in opposite directions so in the mechanistic model you have the methylation copy number and other genomic sources explaining mrna so the reason why they're in opposite directions is because if a lot of variation is explained by copy number variant there's not much explained by the other sources so that's the leftover part gil i was talking in the construction of these models is what's left over is it pure like whatever is left over is it purely transcription or is it something else no if if the upstream platforms the methylation copy don't explain it then we can attribute it just you know uh to the gene expression so it's an artifact of the construction of the model because if copy number explains it takes it away from what's remaining okay i don't know if that's good or bad just uh it's one interpretation it's just from an interpretational perspective that so if you think about that the whole genes methylation is say you know 100 no so what this plot shows is you know is there any how much of that percentage is explained by methylation what percentage is attributable to copy number and what's left over no and then you can add in other other you know variables too so you can expand on the columns to get to you know other type of other upstream platform data as well for example mutation or transcription factor those kind of things as well so it's just basically a a sort of a deconvolution plot of that yeah okay that's the interpretation here i i was wondering if you could say a little bit about the uh recommended minimum sample size for for eye bag in order to get um you know useful results from because in my experience with these you know multi-omex integration methods they tend to require pretty large sample sizes and unfortunately it's usually larger than what we have um and um i suppose it probably depends on whether your outcome is survival or binary correct that's that's exactly right maureen so the good thing is for the mechanistic model i think it's okay to even go with a lower sample size so essentially we are fitting a model with three covariates right it's on a per gene basis so there actually we can have a lot of you know a reasonable sample size we work really well you know because it's it's running on a gene by gene basis i think that the the that the samples as requirements factor in much more importantly if it's in the you know for the clinical model because that's run across genes you know trying to find a signature and i totally agree i think i think you need at least a good enough sample size you know to have it's basically the same sort of argument for any regression model when you're doing you know variable selection or feature selection to have enough power you know to detect these and especially for survival it's even harder because then you have to you know because it's an effect on the prognosis and what percentage change do you want to see you know right so are you thinking like you would need hundreds for so that the data that we have test driven is on the tcga scale so usually hundreds to a few hundreds you know that would be a good good test case now anything below you know yeah you get something but you know how much confidence do you put in that yeah so the good thing here is you know what uh what we also didn't show is there's a multiplicity correction also going on with these posterior probabilities that we also do uh so that's another added level of you know at least statistical protection you know in terms of controlling multiplicities that one can do you know especially for smaller sample sizes i guess i'll stop and kind of conclude the presentation so these are all the links to our resources so if you want to view the transfer size signing out it's all on the bayes rx chinese io server yeah thank you for your attention thank you jim joint presentation thanks gail thank you you
thank you Marcy for the invitation uh good morning every good afternoon everyone uh sorry my name is Bon and I'm a PhD student in the chemical engineering department um and I'm presenting today a machine learning based method for metabolic thoughts analysis of patient tumors um so my today's presentation is a part of uh our work uh in the NR lab in collaboration with Dr Dan W St bioblast is the most common and the most aggressive brain cancer uh with the fiveyear survival rate of 6.9% and average survival rate of 15 months gbms account for half of primary brain tumors and they uh recur frequently in 80% of cases on the left you can see um the survival rate of different brain cancer uh and you can see that gasta or GBM has the worst survival rate among other brain cancers metabolic reprogramming is a Hallmark of cancer and uh in general we can Define metabolism as a set of chemical reactions that occur inside of the cell um and this uh reaction includes converting food or nutrients into energy um and macro molecules like RNA and DNA metabolism supports cell grow and uh other cell functions uh in cancer uh cancer cells accumulate metabolic alterations that allow them to gain access to Conventional and unconventional nutrient sources utilize these nutrients toward the creation of new biomass to sustain deregulated proliferation and take advantage of metabolic regulation on the cancer cells itself uh as well as on the other cell types in the tumor micro environment uh they take advantage of all these uh metabolic regulation for their proliferation um although metabolic rewiring is beneficial for cancer cells if we understand cancer metabolism it's a targetable liability with a traptic window um so uh 1 C glucose Tracer is a common way to study metabolism and you can think of it um think of metabolism as a set of um a steer tank uh reactors that are connected together and there is a flow between uh the tanks and if we add some ink to one tank based on the fluides uh the other tanks uh will be colored with some concentration of ink and if we measure the concentration of ink in different tanks uh we can write um balances for uh the ink concentration and we can um calculate the Flor between these things so this is a concept in chemical engineering and this is very similar when we use the 13c glucose Tracer so glucose at first it had six carbons and the atomic mass of carbon is 12 and when we use the Tracer uh instead of having uh carbon with 12 atomic mass we have it with 13 atomic mass so um the 13c glue cozer has six more um mass unit than the natural uh glucose so when we use a tracer this can be like ink it can be um spread into the down stream metabolites and we can see different patterns in um uh by running into different reactions and each of the patterns we call it a mass isotopomer so each uh pattern has uh um has 13 C carbon in one of the positions of the molecule and uh we can group these isotopomer into Mass isotopo where we have like similar number of 13 C carbon um in one group so this would be a mass isotop and with the mass spectrometry because these metabolites are heavier than the normal um metabolites uh it can be measured with mass spectrometry and we can find a distribution of these Mass isotopologs so we use this uh technique in um uh our study uh to find the uh metabolic reiring in GBM patients um and to do that we have uh some patients um and we Infuse them with 1C glucose um this um infusion um was during the uh surgery and after the surgery we had uh three samples from each tumor enhancing non-enhancing and adjacent cortex um and this classification is based on the histology um of these samples so enhancing and non non-enhancing are both tumor cortex is normal uh tissue um the difference between enhancing and non-enhancing is based on the penetration of blood vessels into the tissues so here you can see uh the um this part is a blood vessel so enhancing has more penetration of blood vessel um and U uh we have uh the 13c tracing in these tissues and we can measure the metabolites uh from different uh different uh samp and then uh also we have the GBM uh grow in the pedics OR P patient Drive xenograph Mouse models and uh again we have the 13c uh glucose tracing in mice and uh uh after the infusion we have the tumor cortex and some plasma samples uh from the pdxs and then again we measure the metabolites in uh mice um so glucose is metabolized through glycolysis uh this part and pentos fosfate pathway uh and its carbons are utilized in many Downstream metabolites as you can see tracking 1C incorporation into Downstream metabolize allow us to understand the more active pathway by comparing the metabolizes uh in Goma and cortex tissues uh so here for the glycolytic intermediates we saw a similar enrichment or the mass isotop distribution between the um between cortex and the tumor samples uh the S pyate and late have higher uh enrichment than other um glycolytic intermediates and you think that that lactate might be uh taken up by uh cortex and G uh was like at the same rate um with this we can conclude that uh glycolysis is is an important passway in both GBM and cortex uh because we don't see any difference between the uh the glycolytic intermediates and enrichments in these tissues then we looked at the TCA cycle intermediates and um this is important because TCA cycle is um a a hub that allows for both the oxid oxidation of glucose dried carbons and their conversion into other molecules such as neurotransmitters and amino acids um so when we looked at the TCA cycle intermediates we saw a decrease of uh in enrichment of these metabolites in the uh tumor samples and this means that the TCA cycle activity uh is reduced in the in the GBM then cortex and then we looked at um Gaba enrichment which is again a neurotransmitter uh we saw again a decrease uh in the tumor samples uh and also we looked at Serene enrichment in both gvm and cortex and we saw um almost similar levels of enrichment in both tissues but um when we look at the patterns of enrichment in um sering data we could see that M plus one pattern um has um higher levels in the GBM while M plus3 pattern has higher enrichment in the cortex and also we see the same thing this is for Mouse and this is for uh patients and we see again the similar Trend in the patient data as you can see m+ 3 is uh higher in the cortex and M m+ one is higher in the tumor samples so uh we would like to see what are the sources of searing and uh uh what is the reason that we see different uh patterns and in in GBM and cortex so we looked at um Serene in the plasma and the Tre phosphoglyceride which is the metabolite that produce Serene in the noal pathway uh when we looked at the enrichment patterns in plasma um we saw that M plus one um so like Serene in plasma is composed of only m plus1 m rement and uh the Tre phosphor glycerate is uh similar in both cortex and GBM and it it is composed of um M plus 3 majorly um so from this the hypothesize that uh GBM uh rely on Serene upate because we saw n plus one uh enrichment higher in GBM samples and also we see uh the plasma Serene has the M plus1 enrichment and then to confirm our hypothesis we uh design another experiment uh with the mouse and so here you can see the GBM uh patient Drive xenographs uh so we grow GBM in the brain of uh Mouse and uh you can see here this is the tumor part and then we uh restrict their diet the serin and dcine so these Mouse uh they have reduced level of serene in their plasma and um you can see the tumor size reduse um yeah and then um another metabolize that they looked at uh was the nucleotides uh in the purine metabolism and we see here that guanosine monophosphate guanosine diphosphate and guanosine have um all of them have higher enrichment in the tumor samples and this means that nucleotype synthesis is higher in the GBM uh to summarize all of these results um we can uh see that uh glucose because the enrichment of glycolytic intermediates was similar between cortex and Goma and we understand that uh glycolysis is important for both cortex and Goma uh we saw TCA cycle intermediates have lower enrichment in the Goma so TCA cycle activity is lower in the Goma um we saw higher enrichment of nucleotides in the Goma so um Gom needs to synthesize more nucleotides um and this is actually confirms the hypothesis that uh Gile cells want to proliferate and divide and they need more nucleotides for their divisions so they have they need some sources for nucleotide synthesis one of the one of these um sources uh to synthesize nucleotides in the NOA is Serene and uh by looking at the uh enrichment patterns in plasma we could see that uh Thea cells can uh uptake Serene uh from the plasma and um use it to synthesis of nuclear units and to confirm this hypothesis we did uh the experiment with sering glycin pre diod and we saw when we um uh do not have any sering in the plasma uh the uh it it will result in reduce grow and po um so all of these findings are based on 13 C cuse single time Point experiments however uh High 13c enrichment at a single time point doesn't necessarily imply increased biosynthetic uh flux um so you can see here uh these metabolizes can be produced from different sources and um one thing that um one thing we'd like to consider is that how um how much of these reactions can uh produce this like the ratio of syntheses through different sources and another uh thing that uh is uh um that when we have enrichment patterns in the sources we got enrichments in the in the product but when um when uh uh there is an unlabeled source to produce a metabolite the metabolite has lower enrichment so uh we can say like uh if um if a reaction is more active um in some cases because the source if if the source is unlabeled the product is also unlabeled and we don't see any enrichment pattern in it but the rate of that reaction might be high and that reaction might be important um but another reaction might be at low rate uh but the reactants have some enrichment so the product has higher enrichment and uh based on this it can be like some bias in uh just by looking at the data so we want to quantify the rate of the uh the reactions and one way to quantify the metabolism is to use metabolic flux analysis uh and with this tool we have um we have already the data from our enrichments and also we have a metabolic model uh consist of all the reactions and uh by using these two we can um we can write all the mass balances on these systems and find the uh rate of these reactions for fls of reactions and um so for uh to quantify purine metabolism they'd like to do another experiment because puring metabolism is very a slow and uh during the time of surgery the enrichment patterns are at on a steadiest state and we need multiple time points if we want to write the mass balance equation we need multiple time points to uh fit our data uh into the measured uh enrichments and uh so for that we again have the GBM uh PDX and we infus the 13c glucose into them but um after that we harvested the tumor uh in a tumor and normal tissue at multiple time points so uh the difference of this um experiment is that we have multiple time Point instead of just having one point um and uh then we measure the mass isotal of distributions and here I like to discuss um how I write the M isotop logs so here we have a metabolite guanosine monop phosphate with enrichment pattern of n+1 uh so GMP can produce from inp in noine monop phosphate or uh through gline and r5p Guan is non labeled but r5b has n plus1 labeling and um GMP also consumes through these two reaction gmp2 GTP and gmp2 guanosine so when we write the M balance on gmpm plus one it would be two terms uh producing and two terms uh cons consuming GMP and on the left we have the accumulation of GMP and plus one and um so to estimate the blocks the flux of reactions concentration of metabolites and the mids of uh input metabolizes uh we solved an optimization problem uh we already have the uh Ms from the experiments that's the enrichment patterns we have and uh we also have the concentrations of metabolis um so we want to minimize our error to be close to our experimental values and uh we have some constraint because we we have a metabolic model and those reactions are connected together so this one is shows the overall Mass balances on the system and uh we know that um the enrichments should be one for each of the metabolizes and uh we set a bond on flux values to be in a reasonable range and this one we this is the equation that I showed you in the previous live about generalizing the uh for the for all the metabolites and um this is the time dependent isotop massis uh so to optimize this problem we first initiate uh some mids and fluxes and concentration all of these parameters first initialize and then we solve the OD uh and find the Ms and concentrations and then we calculated the differences and find the objective value and with the nonlinear programming we adjust the parameters and it goes uh and it uh it runs uh until we find a minimum for this problem uh so using this method uh we can quantify the fluxes of pines and uh when we compare cortex and GBM we could see that uh inp um is uh produced uh mostly from the Salvage pathway um in both cortex and gbn uh the the in to GMP which is the which is called the noo GMP synthesis has higher rates in the GBM and uh also we found that inosine and guanosine production is higher in the GBM which uh compare terms that gbms need more nucleotides because they want to divide and proliferate um so uh then we want to focus on the GMP synthesis because uh we know there is a draw that Target enzyme in know monophosphate the hydrogenous or inph um and so we usually focus on the reactions that we have a drug for them um and here we have a a drug called mop phenolate mtil or M that targets the denovo GMP synthesis the GMP can also produce from the uh bline uh in the Salvage aspect um so uh beside having a drug for this reaction we also saw uh in our uh Dynamic model um analysis uh in then we have a radiation in GBM and cortex gbm's um G gbms uh re their metabolism to rely more on the denovo GMP synthesis as you can see here after the radiation uh the rate of uh the NOA GMP synthesis uh goes higher and uh the Salvage um is lower um so this is another reason that weing this drug can also be uh used in um it can be used after radiation uh we also looked at uh uh different metabolized and purine metabolism in patient data and we saw GNP is the only metabolite that has um higher enrichment uh in the um tumor samples in all of the patients we don't see this pattern uh in other metabolis and we think that GMP synthesis um is remark remarkable here um but in the patients we can solve uh the optimization problem to find the fluxes uh so we don't know how much did how much of the GMP synthesis is from the denal synthesis and how much of it is from the Salvage uh so we like to quantify that in the patient and um the reason that we can't uh use conventional metabolic flux analysis in patient is that we only have one time point and uh for the metabolic flux analysis we need multiple time points uh for that on aady estate problem to fit our um to Fed our data into into the measured mids uh we can we can solve the mfas with one time point if and only if it's if if it's at a steady state but the pine metabolism is is slow and we only have one time point at on steady estate so we can't use uh conventional mfas for uh prediction of fluxes and uh we think that we can use a machine learning model to predict the fluxes in patients and uh for that we need some simulated data because we have a low number of patients and mice and we can uh train the machine learning on a very limited source so we decided to simulate some data and then train a machine learning model uh and then uh use some experimental validation uh for our machine learning model and uh to simulate Ms we generate uniformly distributed uh fluxes and concentrations and uh the range of these uh distributions are from our previous um a study for with the metabolic box analysis uh and then we have the uh uniformly distributed ratio of the noval GMP synthesis to the overall GMP synthesis and this is um the value that we want to predict by our machine learning and we also have a metabolic model so all of these um we put it into a an optimization problem and we solve this to find the fluxes and for each of the simulation we find a a different set of luxes that are um constrained together and uh we use these box values and we solve a a system of Odes to find the mid and um so because our mids are at un aady State we uh have the accumulation term on the left and we find uh the mids uh from um by solving this system and uh so at the end we have the mids and the ratio of the Nova GMP syntheses to the overall synthesis and these are the values that we use in our machine learning model the MS would be the input data and the ratio is the output of the machine learning um so in our simulation we have different reactions I'd like to mention mostly most important reactions in the glycolysis and pentos phosphate past serine metabolism and purine metabolism we have um we have some reactions that we found important from our previous study like uh sering uh plasma uh which we found uh gbms rely mostly on Serene uptake so we add these reactions into this model and uh by solving the optimization problem we uh found um a distribution for the fluxes and so you can see that we first initiate this problem with the uniformly distributed fluxes but after going into this optimization and constraint based on the mass balances we uh for each of these bles we got uh a unique distribution and uh we use these boxes and put it into the system of Odes and we find uh the mids and the mids are at different time points um yeah so you can see here that we have different time points different abiz uh and um different mids as you can see here so with this simulated data we uh eslate the data into training test and validation data set and uh we centered an a scale data based on our training feature uh we think that would be beneficial for our uh input data because uh our mids are at on a steady EST State and by scale and center the data we reduce the effect of time on these mids the fluxes are at a stest St uh we we want to somehow um uh be at the same condition for both fluxes and Ms so with this configuration at the input data we have different uh metabolizes and different mids and with like to use a convolutional neural network uh to predict the ratio of the noo GMP synthesis to the overall synthesis and um the the two-dimensional convolution layer uh it captures the mass balances on each isotop so you can see that it's a column Vector uh the kernel is a column Vector that goes through different metabolites but it's uh it's fixed on one mid and uh then uh in the onedimensional convolution layer we have a kernel uh in a row shape that goes through different mids and uh this captures the some of isotopologs to be u in some value and uh then after these convolution layers we have a fully connected uh neural network that can capture the training parameters to uh predict the ratio of the noal GMP syntheses to the overall GMP syntheses and uh so we then evaluated our model on uh training validation and test data set and we saw the similar correct prediction rate uh in training data set and in test data set and this means that our model doesn't overfit and it it's uh generalizable on onsteen data then the uh dat and experiment on M uh so again we have GBM pdxs and some GBM pdes with the MMF treatment so these two condition uh we have the 13c glucose tracing in this mice and um the uh because this this drug Target the the noo GMP synthesis we expect to see uh a lower uh a lower rate of the noo GMP synthesis in the MMF treed mice and um our uh our uh prediction also U shows this because we can see that here the control condition has higher levels of the novog GMP synthesis but uh the MMF 3 one it predicts that with the with a lower uh levels of the noo GMP synthesis and then we use our model to predict the the noo GMP synthesis ratio in patients um and uh so here you can see that uh we have these two non-enhancing and enhancing tumor samples in patients and we can see um our model suggest a higher uh prediction of the noog GMP synthesis in non-enhancing tumors um and we think that might be correct because the enhancing has more blood vessels in it and it can um it can uh take up the nutrients from the blood and circulation but non-enhancing doesn't have any access to the nutrients in circulation so it needs to um uh it needs to synthesize by itself and um so that's why the denovo GMP synthesis is higher in the non-enhancing uh tumors and uh in future we'd like to further validate our model based on again M data but this time we like to have a Time course experiment uh and with multiple time points we again can use our previous uh metabolic flux analysis model to find different fles and the ratio of the NOA GMP syntheses and uh we can also use our machine learning model to predict uh the ratio and then we compare these two um and uh also we have a single cell RNA s data from these patient and we'd like to find the fluxes based on the flux balance analysis and the gene expression um and then compare it with our machine learning prediction and at the end we'd like to um use this as algorithm in the clinical study uh so it this algorithm can uh predict which patient should take this treatment and uh the MMF is uh work uh would be beneficial for them uh with that I'd like to thank my advisor Dr deas and uh Dr aneli n uh and all the people in uh my lab um and also our collaborator Dr Danel B and Dr Andrew es Scott um they did all these experiments and they uh gave us very uh very helpful feedback um yeah H this is the end of my presentation i' be happy to talk okay um this is more of a general question for nonsteady State model how many that you want to have model yeah so for time for experiment uh we have four time points um I think at 30 minutes 1 Hour 2 hour and 4 hour and the surgery uh of patients uh it takes about between two to four hours so we would like to design our experiment to be in that bran So it's b on the another thank you anyone has questions online you can put them in the Q&A box and anyone else in the room as questions of course please feel free to raise your hand yeah in the in the C model why why you use the two convolution layer you can yes uh the first layer you using the conion 2D and the why you like to using the convolution 1D or you just directly flat flatten it the the convolution and then Skip thetion and directly to the plat layer I see yeah um so um I think the plat layer doesn't have any train parameter but convolution layer has some and um I think by adding this I uh I could see like about like 30% increase in in our correct prediction rate so you know convolution layer has some trainable parameters but the flatten layer doesn't have any uh trainable parameter so yeah so if we just remove the convolution ond layer it uh we reduce the model in training size so we we eliminate some of the training parameters in convolution 1D layer right if the eliminate that layer okay thanks and the 1 d means that you you convolution it in the Y AIS and Y AIS yes here yeah no uh the X AIS x axis yes so I'm wondering the the the meanings about the convolution 1 how you [Music] convolution uh I see so it's like a it's like a row Vector um so when we want to define the kernel size we just have like one dimension for the Kel and that's why it's called convolution 1D um so we basically have like some of our some metabolites do not have any 13c carbon and them and the other metabolis may have like one carbon or two or or three four or five here I have it and plus one to five so this is the number of 13 C carbon in in in a in a molecule right so uh when we have like this convolution it actually captures all these uh 13 C carbons in these metabolites and the rest are uh the the carbon 12 and the are not interested in them because we just use the 1C glucose to find the enrichment patterns right did I answer your question okay okay there any other questions I don't see any questions online either so we can think our speaker moreing and hope to see you all next week
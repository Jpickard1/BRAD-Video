[
    {
        "start": 4.46,
        "text": "hello everyone I'm here presents today my name is Nicholas Wang I'm a member of my third-year PhD student in the bioinformatics department I'm a member of the Rao Lab and I wanted to present on some of the tools I've used for my research into medical imaging particularly a set of neuroimaging toolkits that have been helpful for wrangling some of the data reformatting stand the data and visualizing a lot of these radiology studies that I look at a lot so these these toolkits that I'm going to be talking about today are part of the type I and I pie ecosystem so the three toolkits I'm going to focus on today are nib the Bell and I learn and di-pi these are tools that all come out of kind of the community of packages that are focused on neuro imaging but I've also found them helpful for looking "
    },
    {
        "start": 65.1,
        "text": "at medical imaging in general from different types of radiology I've used them on prostate kind of studies because a lot of the underlying problems that come up in handling medical imaging data as volumes are also applicable to other applications of medical imaging so I'd like to talk to you about these kind of packages today and so roughly where some of the issues come in is when we're looking at medical imaging in general one of the medical imaging is generally stored as DICOM files and DICOM is a pretty good standard for certain things it's built for radiologists and it's how medical imaging is stored clinically so anything radiology related from MRI or CT ultrasound etc is generally stored in the DICOM format on a pack server and can be you'll see other things in there "
    },
    {
        "start": 127.649,
        "text": "that radiologists put in such as reports or derived images and basically all the DICOM pile is is an image and a header and these headers are standardized in a way that you can store a lot of very useful information on how to read the image how do you interpret the image and what the values are but essentially when you look at a MRI study you'll get a stack of anywhere from 20 to 500 or many more depending if it's a 4d volume of these daikons and you put them all together and that that makes up your MRI study and so all of this is great if you're a radiologist but if you're a bioinformatician and you want to do something more involved with these studies DICOM starts falling a little behind it does it does these headers contain everything from the where the image each image sits in the "
    },
    {
        "start": 188.19,
        "text": "volume they contain some oftentimes in the clinical setting they'll contain thi and basically these headers are useful but not always filled out and so that can sometimes cause an issue and I'll give you an example of what some of these icons might look like this is a head Mor for from these are examples from MATLAB and these are some this is not the same study but some of what the DICOM tags might look like on the right you'll see there's descriptions where it's taken this one has anonymized versions of the ID and that sort of thing but there may be anywhere from you know a hundred to there's tens of thousands of possible tags that are attached to headers and they're also depending on which scanner use these headers and so that becomes sort of an issue when you're looking at these this is a real example of some of the DICOM files I look at this is just 25 for a particular modality and they've been split out but each one of these files "
    },
    {
        "start": 252.049,
        "text": "contains an image and headers that are basically the same across all of the studies each time the patient's name doesn't change the scanner that is recorded on doesn't change and all of these other files don't but the position of each of these files does change and you need to put them together as far as a volume because MRI studies you're looking at the the point of an MRI studies to look at it in a 3d sense so you have to bring all this information together anonymize it if you want to be sensitive to the pH I and make sure you haven't lost any facts along the way because the filenames are not at all helpful and that brings us to give a bell I just wanted to does anyone have any questions on the DICOM standard I realized I should pause for a second and see if there's any questions and if not "
    },
    {
        "start": 315.61,
        "text": "I'll go on to end of a bell which is a package for handling a lot of these different imaging file formats and contains a lot of the utility functions for these neural imaging files and so you might say DICOM standard is great and it you could think of it as one of the image volume standards but the ohon DICOM and once people start thinking oh maybe I need to actually handle images and volume you start running into issues and there's a lot of different standards out there for how to handle files as you can tell by this xkcd volume so I'd recommend picking a particular one and this is the one from nuuma Bell can handle a number of different ways that people for intermediate files including DICOM but I've used nifty in the past there's an RD there's there's multiple different file formats that people use "
    },
    {
        "start": 377.11,
        "text": "in order to tour these MRI volumes in a consistent way for further processing but you know it doesn't really matter in the end as long as you're consistent across all of them and can handle different intermediate files and so what does the nib about one snippet Bell has taken in these miles from either daikon or nifty or however you're storing these image files treats them as an entire image volume plus an affine matrix in order to handle rotations sheering and kind of changes to the image matrix I mean this is important because daikon itself is is generally treats images of the stack and so they're aligned but they're they're basically uh the XYZ coordinate frame is only up and down and it can't handle any "
    },
    {
        "start": 437.54,
        "text": "rotations and this sort of thing which is why when you're looking at a single image volume but once you start looking at images as a set of them is particularly an MRI where everything is multi-modality where you're looking at a number of different aspects of the brain you'll and they're not always aligned properly having a Phi matrix gives you a little more flexibility than simply a Z coordinate holding all the information about the relative relative spatial positioning of these different slices so you can tell from this example on the right of you see that this is one slice out of them this is a one slice out of a brain DT and our sorry brain mr study where you take your original pixels which are in ijk coordinates and transform them into real space millimeters meanings so you go from so "
    },
    {
        "start": 501.68,
        "text": "this affine matrix tells you how to change those coordinates into something that can be properly aligned and and a Phi matrix what I'll be talking about later contains both scaling rotation translation and sharing and one important thing to note is that these are all invertible matrices which makes converting back and forth between these two or months between these two coordinate systems pretty straightforward simple next I'll talk a little bit about some of the different why this is important some of the different Bureau imaging have our sequences you might come across if you're working with MRI studies particularly in the brain this is you'll look at t1 images t1-weighted images - - weighted images they'll add contrast to an image to light up different you'll you in a clinical setting you may have a "
    },
    {
        "start": 562.61,
        "text": "patient be injected with gadolinium or another contrast agent to study where the blood flows and that kind of effect and see what changes are made when in contrast is added in flare is a t2 type image where you're lowering the where you're doing inversion recovery in order to increase the normal fluid and increase other aspects but it looks sort of like a teacher image you can kind of see these are I look at brain tumor images which is not necessarily what all these neural imaging packages are focused on but is a reasonable application of these packages as well and beyond these kind of standard MRI sequences you will also run into diffusion-weighted imaging such as apparent fusion there's also an apparent diffusion coefficient which is a secondary image where you've calculated how kind of a standardized scale of what "
    },
    {
        "start": 624.29,
        "text": "this diffusion coefficient is and there's many more including perfusion and I can go on and on and on about what type of sequences are you're capable of taking an M R which is something in distinguishes it from other modalities imaging modalities such as CT e or ultrasound which are generally one acquisition and at the same time all at once so that's part of why that's part of why your imaging has a lot of these kind of packages for integrating different modalities and so next I'll talk about and I learned but in case anyone had any questions about anti goodell nabob L my Pappy eight take them at this point as well and if not I'd be also be happy to talk "
    },
    {
        "start": 686.19,
        "text": "I can't see the questions unfortunately but I was hoping if maybe that could be raised but if and for the next I'd like to talk about and I learn which is a nice set of neural imaging packages beyond the kind of utility functions that Numa Bell provides which are also come with a nice what I found very helpful in kind of these relation tools and also other machine learning tools that are included in this is there's a lot of great documentation for this package there is some good documentation for Novell as well but it's it's less fully coded out in the way that and I learn is and so some of the things you have access to with these and I learn a package is a lot of brain atlas is there's a lot of research into brain MOR particularly because of work in functional magnetic resonance imaging fMRI so a lot of normal brains have been "
    },
    {
        "start": 747.24,
        "text": "atlest and there's a lot of other datasets that come along with it it provides a lot of good visualization tools for the brain and any kind of there's a number of image manipulation tools as well people have used these I don't use it as much but because there's a lot of work in functional matter breaking magnetic resonance imaging space on finding which areas of the brain are connected to each other and their interactions with each other it's kind of consuming connectome project comes up so there's a lot of tools in here I won't specifically talk too much about that because that's not for my research focuses but there are these kind of tools and an important thing to know about fMRI is because it's an MRI which looks at a 3d space but it also looks at this information and the change in blood flow over time you're looking at four-dimensional data which is always a little more tricky to two dimensional that is easier to handle the three-dimensional data which is again "
    },
    {
        "start": 807.269,
        "text": "easier to handle than four-dimensional data which is always hard to visualize so four dimensional data is and I learned provides a lot of these toolkits for handling this four-dimensional imaging data and so some of the standard brain atlases you might look at our how we map out different regions of the brain and our study over time of how these different areas of gray and white matter are what their functions are you have motor cortex that sort of thing but there's a I've done two examples on the right there's in the example they've provided this quiet-like and twenty different brain atlases you could pull down and map your brain images to and so you take the idea is you take a structural NR such as the t1 weighted imaging sequence and map it on to this brain atlas so you could use that to "
    },
    {
        "start": 868.28,
        "text": "identify different regions of the brain in your study of a particular subject as well and so a nice thing is there's a lot of visualization tools because it's difficult to take 3d volumes and present them as nice summary 2d images particularly when you have both structure and then further on you have features you may want to record about these different areas of the brain but you can see there's you know the standard kind of three cuts of you slice it down midline after adjusting for after mapping it to a particular atlas and you can kind of see axial coronal and sagittal these kind of three different ways to slice three different directions of slicing the brain but also their ways of plotting these different atlases or different features or Anatomy on top of that as heat maps and "
    },
    {
        "start": 931.07,
        "text": "different connections which I find very appealing and also good for quality control because it's important when you're looking at imaging tools to make sure you know what you're looking at it's easy to kind of assume that your pipeline worked correctly but sometimes you know if you forgot you align something correctly or it's it's the layers of the mask don't line up correctly it's just a nice sanity check to be able to take a look at a single image and say this is what I expected to be investigating and the values make sense to me and also further down the line if you need to present it to a clinician or in the paper these herbs and lights imaging visualization tools there's also a lot of image manipulation utilities I found for smoothing resampling masking oftentimes when you get in they when you're getting these different modalities there will be "
    },
    {
        "start": 992.6,
        "text": "at different resolutions because it has different costs to sample at different under different protocols so you'll need is map it if if you have a segmentation done in one resolution you'll need to resample it onto your different modality either perfusion or whatever it may be a diffusion mask in order to make them all aligned properly or smooth it or handle some of these masking issues and it does provide a lot of image manipulation tools as well and again these are all complemented by some nice jupiter notebooks which can give you some good examples on how to think about and handle this data which i found very useful as well and yeah i mentioned that there's some jupiter notebooks there's a lot of them this is just two of the sections and they provide but there's "
    },
    {
        "start": 1052.63,
        "text": "you know to this page where they provide their examples they have probably almost 100 examples of or at least 50 examples of jupiter notebooks with lots of different tools for fMRI and MRI and while it is focused on brain images in particular some of the visualizations and tools that's not you if you're doing other projects like I was looking at a prostate mor bill these kind of nice visualization tools can be utilized even if you're not doing the alignment or mapping it specifically to a brain structure LMR is or could it be CT or whatever you're using still could be handled using these nice blotting tools so that's even if you're not using specifically neural imaging I think this is worth taking a look at and so maybe I "
    },
    {
        "start": 1115.81,
        "text": "take another second to pause if anyone has any questions on and I learn I'd like to also talk a lot about the next package I'd like to talk about is the I pi which is diffusion imaging Python so if anyone has any questions I about and I learned at the ap2 here the beer and if you heard anyone having any questions in the chat you can bring them forward there's no questions yet okay it's all good so I'll go on further to the diffusion imaging Python and at the end maybe if anyone has any questions or not we can talk about that as well but di-pi so diffusion imaging is a different a different kind of imaging on top of MRI where a normal mi would you're trying to see where the water is moving within or the fluid is moving within a brain or "
    },
    {
        "start": 1177.0,
        "text": "subject in general a person in general by doing this kind of diffusion gradient as well where if it's you'll knock you'll knock the pulse you'll take a post to set the hydrogen spins processing and then in provide a gradient and then slip the gradient and so and then do an inverted gradient so the idea is if you are staying stationary these two gradients will cancel out but if you've moved between these two time periods if the water is moving at particularly a particular direction across these two time periods you'll see a difference in the signal after or after these two paired gradients and so you'll get out both diffusion-weighted imaging which is the kind of signal you get out and also an apparent diffusion coefficient which is "
    },
    {
        "start": 1237.55,
        "text": "a single number you get out a B value that you'd get out to quantify what the decision levels are as opposed to the rest of em are in general is not intensity based the intensity is all relative so apparent diffusion coefficient the intensity does have a meaning whereas most the other imaging including diffusion-weighted imaging the signal intensity values doesn't have an egg's a meaning that is consistent across different acquisitions so hundred and the diffusion weighted imaging on one time doesn't mean the same thing as a hundred on another image taken at a different time but yeah so what you get out from this movement of water is you get a gradient field for the direction and size of the movement of water and "
    },
    {
        "start": 1300.34,
        "text": "this diffusion across different time points or sorry across the sorry imaging sequence and so what di-pi is kind of focused on is these tracking these connections across these white matter bundles and seeing you know building out this kind of connection map across them building these streamlines I don't necessarily use it for this as much but these are some interesting approaches I may look at in the future but I use it more for some of the utilities that they provide but it's it's an interesting way of looking at these gradient fields in this alternative way of looking at MRI imaging and more information you can get out about the structure and functionality of these different brain structures and so what I use out of it the DI pack di di "
    },
    {
        "start": 1362.049,
        "text": "pack di PI package is mostly the image registration tools although they're again there are a lot of diffusion imaging tools that aren't accompanying us but in order to do this diffusion imaging kind of analysis you'd first definitely need to do image registration and so what what is image registration if you have two modal modalities of images that may be slow closely aligned but not quite aligned you you want to put them on top of each other so you can understand this multimodal imaging and really be for a particular area of the body what's happening in different non-invasive imaging metrics at the same time right so you might be looking at different contrast phases you might be looking at you could be looking at totally different time points or try to account for trying to account for trying "
    },
    {
        "start": 1426.25,
        "text": "to align it with a standard Atlas which is comparing it to a 12-lead different person or you may be looking at different modalities from t1 t2 I mentioned all these other imaging modalities before but if you can align them properly and MRR does some of it but it's not perfect and again you know there are some caveats with that but image registration helps bring all this together in a way that helps you can analyze it properly again for t imaging you also need to align it and so this kind of static or this kind of affine registration you can see on the bottom is a these are matlab tools this is not exclusively through di-pi but there are other tools that can do this as well but you're trying to put these into alignment so you can either extend the image or provide some consistency across them and so one of the ways that di-pi does this for a fine registration we talked about a little bit about f5 matrices before is "
    },
    {
        "start": 1487.95,
        "text": "you're trying to find the affine matrix that brings two images into alignment or two volumes into alignment that weren't in alignment before using that 4x4 matrix we talked about earlier that allows you to do translation rotation scaling and shearing and so the way Adi pine does this the example they provided and the way I'd recommend doing it is they go about it in different levels right so first you want to handle the gross miss restorations because then any options has an ending optimization problem the closer you are to the correct solution the better the fine-tuning and the your answers will be if you do they do this in steps so it basically does the way I recommend doing this is doing multiple sequential alignment and they provide a nice tutorial for how to handle this and the example they provided was you first align the center of mass so if you have "
    },
    {
        "start": 1551.19,
        "text": "two branes you want them to be roughly on top of each other first and then you do a little bit translation to make sure that you know you're trying to align them a little better than that and then doing a rigid registration which allows you to well not sheer it or change some of the structure of it allows you to do rotations scaling and translation and then finally allowing the now find registration at the end once you're pretty well in line in order to properly map it and again each of these again has you start at a low resolution a low resolution registration fine-tune a little more and then fine tune a little more in this kind of pyramid structure where you start off with the gross structure and then fine-tune it across these multiple steps and the metric that you use to align these two images is often mutual information you could "
    },
    {
        "start": 1612.81,
        "text": "that's helpful if they're not the same modality and not the same one there's other approaches you could use like you know squared error root mean squared error but mutual information is useful for cross modality registrations because you're not dependent on them having the exact same value across the different modalities and volumes that you're looking at and so here's this initial registration after center-of-mass registration and kind of see the shift I'm sorry let's decide this the initial alignment and then here's the center of mass where you just put them on top of each other and then you have a translation to do a little more alignment because just because the center of mass of the line doesn't mean it's properly aligned and then finally you can do rigid registration where you kind of tilt it a little bit and there in a little bit of a find registration where you get this nice you can see with "
    },
    {
        "start": 1672.81,
        "text": "the green green in the red are the two different sorry I didn't explain before but the de green in the red are the two different volumes and you're trying to properly align them on top of each other and you can see they're probably best aligned with this affine registration at the end as they're more closely on top of each other and so that's all well and good but some problems don't necessarily fit under the affine registration framework so in the brain which is it's nice because there's not much movement you're encased in the skull and so things don't move around or slosh around too much but in other problems that's not necessarily the case and you can't encapsulate all of these shifts with four by four matrix and that's where non rigid registration comes in and so non rigid registration kind of this is an example from MATLAB where you're this "
    },
    {
        "start": 1737.94,
        "text": "this example is trying to align two hands on top of each other it's the same rough structure but there's been some movement akin to say you know art B or move breathing artifact you might see in other in another modality but this allows for non rigid range station allows for individual shifts of individual pixels and you're creating a kind of a mapping of the entire volume and seeing where different pixels are moving across it instead of a generalized four by four half eye transformation where the entire where the entire volume is moving all that one and so the I PI provides some nice toolkits for doing so and you can see this kind of symmetric - few more edge registration which is useful because "
    },
    {
        "start": 1798.28,
        "text": "again it's invertible so you can have a forward and reverse kind of transform its last straightforward them in a Phi matrix but it's this the idea is similar we're kind of taking if you have on the left you have on the top row you have the original matrix and then you have on the right you have a moving image so you're going to shift it and you can see where there's there's some shift but not it's not proper that's not fully out there you can do a further better alignment and you can see that after you've worked it they align better but you can also using the inverted matrix inverse transform warp the original image back using to make and match with the secondary image say you can make the Redknapp look more like the green map with the adverse instead of making the green map look more like the red map with the direct transform and this uses a cross correlation matrix and use a similar idea but I think this kind of "
    },
    {
        "start": 1861.37,
        "text": "you can see the kind of shifting new coordinate system this is a 2d image and but it's course possible in 3d and shows how this this just happened and it to be honest I think it's helpful I would always make sure your for these kind of image mapping even if you did want to do an on reject registration if you wanted to do that I would also make sure you align them first in the kind of rigid sense make sure because the further you have to move it the more pressure you're putting on the system so you can always do this in sequential steps and do an affine transformation first and so other tools that are available in the beyond image registration they're available in the DI di-pi package our tissue classification "
    },
    {
        "start": 1922.1,
        "text": "which is another problem that comes up off and the agora mijung kind of setting when you want to know what if you have this is an example of you have a TI t1-weighted image and you want to know what the different parts of the brain are from the classical kind of parts are grave ladder white matter and cerebral spinal fluid CSF and you can kind of see this algorithm takes it t1-weighted image and kind of splits them into the different components and this is not exclusive to di-pi this one you always want to be careful because depending on what image modalities your input set has you can get different things with it some somehow algorithms require more information some algorithms and can get perhaps better results unclear but some some algorithms require less information and so depending on your problem you want to tailor your solution to the proper level of you want to only gonna "
    },
    {
        "start": 1985.07,
        "text": "tell you your tissue classification algorithm to what you have but there's also other things like algorithms they include like skull stripping to help clear out extraneous information about the skull and the other anatomy and also do some in an organization and this is these are all part of the di-pi package and so the things i've learned about from these packages and the NI pi ecosystem in my work in your imaging in general is that someone probably has built the tool out there it's not really worth reinventing the wheel these are pretty solved problems if you're looking for you don't you shouldn't be the one trying to you know unless you have a specific reason to if you only need something to strip the skull or if you only need something to segment a tumor or to do image registration or whatever "
    },
    {
        "start": 2046.09,
        "text": "it may be there's not a real reason for you to try and roll your own tool for a lot of these problems I try takes longer and it's probably less well supported so just take a look out there to see what kind of packages exist for image handling and pre processing and visualization it's there are some nicely documented packages out there as well and I will say that there's a caveat that some of their because everyone does things a different way and everyone has their own particular problem well you may have a stay my image data said may have you know standard mr sequences like t1 t2 you know layer and contrast other people may be looking only at t1 and t2 and there or they may expect you know diffusion-weighted imaging which i don't "
    },
    {
        "start": 2106.18,
        "text": "have or a proton density weighted method i don't have you have to be careful to make sure that your inputs match what their algorithm expects but it's worth at least looking around and seeing if you can find something that does a good enough job to get you the intermediate steps that you need and even though i've mostly work in the for at least for my thesis I mostly work in the brain mr space I've also used these kind of tools in in prostate mr or in liver CT for example a lot of these radiology radiological tools and I think for those of us who are working in imaging in general like their image registration is a good thing to think about for anyone who's working in multimodal imaging data and there's a lot of good tools out there and one of "
    },
    {
        "start": 2169.51,
        "text": "the things I've learned as well is that you got to look at the results you can't just trust that everything works out perfect and pretty and nice that's part of why there's these image registration tools to correct some of these issues that are relatively fixable what you have to be able to see first that things don't line up and you just take a quick look at your data and make sure things line up correctly you can because then you can save yourself a lot of hassle on the line too with with problems that are a lot harder to fix once you're looking only at numbers and matrices instead of the original images for example you know if you're trying to align brains to atlases in fMRI space there's there's you're mostly looking at people who have normal brains and brains are symmetric and affine transformations work pretty well and they work okay in the brain cancer "
    },
    {
        "start": 2231.79,
        "text": "space but because there's a big tumor on one side of the brain the brain is no longer symmetrical so sometimes these algorithms of trying to align a normal brain to an abnormal brain don't work out perfectly so taking a look at the images using image visualization tools for men I learned as proved helpful to me so I just wanted to thank you all for coming and listening tonight talk about my tools and tech presentation for about your imaging tool kits and part of these ni PI ecosystem there's a number of other packages if you're interested as well but like to thank you again and ask if anyone has any questions you no questions thank you very much for your talk okay thank you very much for "
    },
    {
        "start": 2294.009,
        "text": "listening I appreciate it everyone "
    }
]
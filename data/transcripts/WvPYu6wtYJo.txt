all right welcome everyone thanks for coming to today's tools and Technology seminar series um I think we've got some new faces um at the begin for this being the first one of the semester so for those who are not familiar with the seminar series it is a venue to discuss tools Technologies methodologies uh sometimes these are recently published but they don't have to be sometimes they're currently in development um and sometimes there things have been out here for a long time and are just being used by researchers and someone Community thinks that others may be interested in knowing how they're use or that they exist so keep that in mind I'm always looking for future um presenters uh we do have an online audience so if you're online and you have a question you can raise your well you can put it in the Q&A pod or if you really want to ask it verbally I think you can uh indicate to us that you would like to do that and we can unmute you um if you're in the room you got a question of course just raise your hand like you normally would um please try to speak up so that the camera sorry the microphone can pick you up your uh question for the online audience so with that um I would like to introduce our speaker today we have Kai Wong who is a postto in Moran sour lab in dcmb okay thank you yeah yeah yeah it's a great chance for me to talk about the uh project I'm currently working on so today I'm going to talk about the the title of my talk it's like the Gen Target prediction of environmental chemical using the couple Matrix Matrix completion or yes and uh so for inal exposers contains like a different type of like chemical physical biological but for here U most of the we only focus on chemical exposures and uh based on uh a news there's like a every year there's like a 2,000 new chemicals will be released to environment and uh uh some of the chemicals is not good to our health and U So based on this news is like every day we have seven new chemicals released to our environment so to do a comprehensive toxicology assessment of the of the new chemicals is impossible even in the pop cam they already have over a million chemicals registered in that database but the cor correlated the biological data is only around like 10 only 10% of them have like a biological data so which is like yeah and then so so traditionally we use like a lot of like inval or inval uh toxicity testings so inal which like we use a lot of sell lines to do the to add in different conentration of the chemical then to testing uh how the cell works but uh but uh the hard part is like for this type of method is like a uh it's hard to find a right cell type organal to mimic the real like inval environment and uh inval which is like a use a lot in the SP we use a lot of mouse to do the study but the the other problem for this method is like it's very expensive and the time consuming and also human amounts are different yes so it they cannot and also those are like aute animals so it's part yeah so yeah so in us actually the EPA and FDA they proposed this like a toxicity testing in the 21 of uh 21st century so which is like a based on this figure you can see in um 2042 so all of those like uh Personal Care stuff all those chemicals should be only used like the computational way or invidual way to testing the toxicity of the chemicals yeah so this is in us and uh actually in you in Europe they already uh uh set a law that is all the personal care stuff they can you can only use computational way to testing the the chemical used in Personal Care uh products and I met a guy in the PNG so they that guy actually is doing those type of psychology computational stuff in PNG and he told me like it's like in Europe because they want to sell the products in Europe so uh they can only use any like biological based data to support the idea the product is not not like toxic to human if that paper published before 2011 so any paper published after 2011 they cannot use that even as a reference to part okay this chemical is safe to to human yeah and also in the EPA and I have a figure here so in EPA they have a um another way to do the tox uh toxicity screening is like high throughput uh toxicity uh screening stuff uh so they have a team to do that is like they have a robber arm they have like four teams so the first team is like only to prepare all the all the cells and chemicals whatever they have like a huge huge like a rack to put all the stuff out there then they have a Rob arm to do the experiment like every day and not stopping so in that way uh they can testing like 1,000 chemical in like a two weeks to do but it's still like not passing enough to testing all the chemicals so that's why uh we need use like some U computational method to do the toxic in toxicology research so the first one so this is like the very most widely used method it's called R cross so this method is like a so logic is very simple so um similar chemicals they probably have similar biological activities so for this method so they just uh what they did is like they just to compare the chemical structure so for example if if this one we don't have the biological data for this chemical but we have like a bial data for those three chemicals then they just compare the chemical structure to say okay because that those chemic because are very similar to each other so so this this chemical in here probably have the similar biological activities so this is very fast so the model of this method is like very to easy to interpret it but the problem is like they don't include any like a biological data here so everything is just based on the chemical structure then to give a guess of the the the biological activities so then after that so this method is developed called a structure activity relationship or the quantitative structure uh uh activity relationship yeah for this one it's like a uh different from the r cross for this one they are the model will include the structure of the the structure of the chemical and also the biological data here so then use those two two type of different uh informations then they can train a model to to like predict the toxicity of the chemical then when you have a new chemical you can just the use the structure then get the like the numerical uh features of the chemical then to predict the uh biological activities and for yeah so for for the Qs AR methods you can use like a different type of machine learning algorithm to do this but for all of those methods the limitation is like a most of the time the only uh checking uh whether this chemical can activate a marker gene or or a certain marker gene or certain Pathways which is like a binary classification problem they cannot give like a over overview of the biological activities so then uh for for my study we use like the Matrix completion uh method to do this for Matrix completion uh method which is like um uh basically it's like imputing the uh missing values in a partially observe the Matrix yeah so in drug so this type of method is actually very widely used in drug repurposing and reposing and uh usually for the drug Target interaction um so they use a binary numbers and usually they just predict the the physical interaction between the chemical the drug and the the protein but for environmental chemicals uh so they probably have like a different type of the interactions and uh so a traditional way to do a matrix completion is called the SVD singular value decomposition so usually so basically something like you have OB parly observed The Matrix like here and then you can break down this Matrix into three other matrices here then when you multiple them together you can have a new Matrix so then when you do this you can initialize some values in those three new matrices and then you can adjust the values to make sure the existing value in the a can be recalculated after your modifcation of those three Mees then you can find it like a kind of like a missing Val uh but you can see from here um those part here and here is actually not used in the calculation that's why they have like the reduced SVD which is like a remove those two parts because there's not used for the calculation and uh after this they have another like a trunked SVD which is you can see the dimension here is different so so basically just Rings the size of the Matrix because the a smaller Matrix you you can uh use like less time to do the calculation otherwise it be spend a lot of time so a famous uh it's kind of like a famous problem that is fix uh solved by The Matrix uh comp decomposition is this one is called a netflex problem so this is like I think it's like more than 10 years ago they have Netflix they have this competition to ask people to develop algorithm to solve the problem so the problem is like uh they want to recommend movies to different users but not all the users will rent all the movies in in in in the system so that's why they have like a partially observed The Matrix then this type of method is called the fun SVD because it only Break Down The Matrix into two matrices and then you can initialize some values here and here then you can when you multiply them together you just to make sure that the existing value in this Matrix can be recalculated then the the other missing values can be used to uh to do the uh recommendation uh movies to the to other users uh yeah but uh but in a real problem so the the features so those two uh breakdown matrices probably do not have real meanings like the coordinates in PC and uh so for here so we actually uh have a new algorithm it's called the couple matri Matrix completion so the traditional way is like you you only use this par Matrix which is a here to break down into two matrices then do the calculation but for here what we did like we uh besid this one so we will also have two other coule matrices so uh for example for the in the for the drug Target in prediction what we have here is in the a matrix here is like the row probably can be the different drugs and the column can be different proteins and then the Matrix C here is actually the similarity between the the the genes and the r here is actually the similarity between the drugs so all the hypothesis of of this method is like a similar chemical probably have similar uh tget yeah that's the hypothy so the method for here is just like a all of those three uh information uh matrices here will be used to regenerate the three matrices then multiple those three Matrix together we can have a new Matrix that have most of the missing value is imputed and uh yeah so this method is actually uh developable four drug drug Target interaction prediction and then the paper is actually published yeah it's prob like in 20 uh uh 2020 and uh in drug uh Target prediction because drug is actually designed to Target a specific Protein that's why uh usually they use a binary interaction Matrix so that Matrix a have just zero one do kind of like a binary classification but for those uh environmental chemicals none of them are actually designed to Target human gen they just use the product so that's why we think uh a binary number probably not not good for this type of prediction so that's why we use a non-binary value here so the algorithm will looks like this so the input will be have like a a three matrices so for our study so the main Matrix which is Meg here it's a chemical G interaction Matrix the number in there is not binary it's just the a deal number there and then two compound matrices is the chemical similarity and Gene similarity and those so basically is like a uh the algorithm is something like we need to pre-process the two couple matrices it's kind of like the normalization so for for this step we we for each of the Matrix here we will have like a two hyper parameters to uh to adjust and then we will grab the existing value in this Matrix and the corresponding position of the exting value in this mg Matrix then initialize like two B1 B2 so the B1 B2 actually have the same size of the mg and me then we run this iteration and then we can regenerate the the final matrix by updating the B1 B2 uh numbers here and uh a good way for the good thing for this algorithm is like it convert very fast so for our data we only run iteration like a divion number is two so it's like we only updates B1 B2 like two times and convert finding a best output and uh the data we actually use for our study is from this database called the ctd database it's the a comparative toxical genomics database so this is the best database that uh have the environmental chemicals and uh as related biological activities and uh they contains like a different species like Mouse data Red Data human data or zra official data but for us we only uh grab the human data and uh uh this data set is actually those numbers here is actually downloaded three years ago so if you download new data the number probably different a little bit different yeah and for this uh data so after we fil out some drugs so they have like almost 5,000 chemical exposures and like 20 to uh thousand genes and the existing interaction number is only this so if we put into a huge matrix it's only like a less than one point of the huge Matrix is actually existing here thetion matter so that's why if we want to do a matrix decomposition on this type of Matrix because this is two spars so the number if you just only use the value in here then to do the decomposition so the it it's hard to control the the the the the the results because it's two SP yeah yeah so this is the interaction Matrix yeah so for for this for this data we actually have uh we calculate the interaction between the chemical in two ways and then we only use the first way so the first way is like we just count how many G and chemical pairs are in this database because a different publication they probably tested the chemical energy on different level probably one complication is on testing the chemical on RNA level one is on DNA level so we didn't actually differential those different type of interactions we just count how many times of the chemical and genes they have a interaction in the in the in the literature and the second way we we we count is like we count for each of chemical Gene pair we count how many unique publication for there but but the publication number is is not nice it's not performance is not good so we only focus on the chemical Gene pairs and then normalize that count into a number between the range zero to one then to do the calculation that's for the interaction values and then for the chemical similarities uh we only use the rdkit which is a python package to calculate the two type of the fingerprints one is a Morgan fingerprints one is like a topology to fingerprints those are like a very uh a normal way to do the uh chemical similarity then we calculate the uh chemical similarity based on those two fingerprints and those two figures actually the uh distribution of the chemical similarities of all those chemicals used in our study you can see it's very towards to zero which means it's like even for those two compound matrices it's also have some missing values because some chemicals cannot have like a finding good similarity numbers and for the Gen similarity here so we use r package called go same same so this package is actually um calculating the gene similarity based on the go term the gene assigned so because there's like a three type of the go term so we can calate three type of the gene similarities I think go BP is very well annotated so that's why you can see a lot of number here but for other to go GF and go CC they have a lot of a high bar in the one here yeah so yeah so those are the datas we have so we have the U uh the interaction Matrix and the two type of chemical similarity and three type of the gene similarities and then we can just wrong our method to predict the to test the performance uh so for here we actually compared our method to other three similar Matrix completion algorithm so all of them all of those three method is implemented in M lab and we CH those three because those three also needs the inter action Matrix and also the two compon matrices but the difference between our method to to their method is like so the two c matri the value from those cou matri in our method will be directly used to into the imputations but for other three methods they only use those two component matrices to adjust the value in the interaction Matrix then do a matrix decomposition and yeah to compare those uh three methods so in in their paper in this paper CF paper they also mentioned a pre-processed algorithm which is called the w k k so this method can improve a little bit the performance of those three methods so so in that way so we actually uh compared our method uh with this three methods and with and without the w k k so it's kind of like compared to like a six different uh methods and then we defined some like a true positive and true negative uh interactions from the the data set and then we just calculate the AOC uh to compare the performance and uh to get the true positive and true negative data set here uh so for the true U positive data set what we did is like we choose the top 20 most well studied environmental chemicals and then we choose the corresponding Target genes that most well studed Target gen of them use those as a a true positive and for the true negative we also use those like a top not most well studed top 20 gen and then use those genes and never been reported as the targeting of those chemicals as a true negative so the interaction meas will be something like this and then when we when we actually calculate the AOC what we did is like we just remove some like existing values and then we use those values to reproduct those values then calculate the AOC of the of the method then to compare the performance yeah so here uh yeah so here for uh for the performance comparison we actually uh like generate three different type size of the The Matrix which like a 200 by 400 400 by 600 and 600 800 and uh the first three row it's the for the other three methods it's like a without the w k k and for for here it's like a with the w k and uh uh you can see with the w King K uh it do can improve the performance of other three methods and when the size of the Matrix like increasing you can see clearly see that the performance of other three method is actually getting decreased a little bit but for our method it's very stable stable across different sides of the Matrix and uh also this is the WR time for the other method because other three method actually in my lab so it's a it's kind of slow so when they run actually run the 200 by 400 they probably need like a uh five minutes to run but for our method I Implement in the method in C++ so it's very fast it's only like a several seconds so that's why when I do the case study around 200 different uh 200 different data sets it only took like 20 minutes for all of them and after that uh we performed a case study so when we run a case study we run a case study on five different uh class of chemicals so the first one is BPA and it's analog so BPA is actually the chemical uh used to make those Plastics uh transparent all of those plastic like a cops they probably for now BPA is already banned in us but they probably not have BPA but they also have other similar chemicals yeah so if you bought the the buy the bottle water from Costco you see they are label non BPA but they probably have other like a similar chemicals and the second one is past so past is like a very uh a huge they have hundreds of PES there and uh those chemicals actually used in those nonsticky pan so if you go to Target or warmer some of the pan they will say non pfos because pfos and PFO is like the most like a very well studied but they probably have other similar chemical that's why it's not sticking here and then the third uh group is called the doxin so the the most the most famous one is called tcdd so tcdd is actually um during the vietman war so uh the US Army use a lot of chemical Called Agent agent orange so which is like a herbicide to kill the the the the grass but the tcdd is actually a byproduct of the agent orange but when they actually use this chemical they don't know tdd is there so after they find tdd is there so they already use a lot of those chemicals all the soldiers and people in Van they already exposed to this chemical and this chemical is actually very bad to human they can cause all type of cancers and stuff so yeah so we use like TD and other similar chemicals for the third group and then we use PCB PCB is actually a chemical also like a banned in us like many years ago in 1979 PCB is Bann in us but in some old like electricity devices still have these chemicals and the last group it's those uh Benz and methanol which is like used to keep those uh bio spacement yeah those two chemicals and uh for the case study uh because the ultimate goal of This research is to finding the potential Target genes of a chemical with any biological uh activity data so when we do the case study for all of those chemicals what we did is that we we actually removed all existing interaction values for each of those chemicals uh from this like a huge Matrix here and then we break down this Matrix into like a 200 data set with random chemical and genes for each of those uh small Matrix uh it contains the case study chemical and all the existing value is removed then we run the algorithm on all of those 200 different sets and then we can imput in the Target gen for all of those in all of those like 200 data set so in in this way uh each chemical G pairs can be U impus like 10 time averagely because if you use this one is not working because it's too huge spend a lot of time to do the calculation but for for for each of those here the size is 300 chemical and 500 uh genes so it only took like 20 minutes to run all of them and then we can find the results so uh for here uh for the case study so we for each of the chemical we generate a site uh 20 different 200 data sets for for them and then we run them then we can grab all the imputing values then we compare our results uh to two different uh data set so because all our data is actually from ctd but when we do the case study we remove all the existing value so then we compare our imputed value to the existing value in the ctd to see how it it looks so from this figure uh because in even in ctd uh not all those case study chemical they have a lot of like Target genes in there so we only compared those like six uh chemicals they have like a whole bunch of like Target gen in ctd so in here we actually because our algorithm will predict like a number it's like a bigger number means the chemical have a higher possibility can interact with that gen so we just order the results uh uh all the CFC our results and then we can check how many top Target genes from our calculation is actually also a a top Target Gene in ctd so in here actually it's like for BPA this is like the very uh well studied chemical we found 83 I think it's 83 chemical genes it's in our top 100 Gene is also in those gen is also like a top 100 Gene of the BPA in the ctd data so which means like our algorithm can predict the target genes of those chemicals and uh uh after the ctd comparison we also compared our result to the compx database so this is like the EPA uh generate this database so in this database uh it contains all the data is actually based on the um the biological like a inval invidual asses it's like a through something and then in this uh database uh also they only have like this 11 uh uh chemicals they have biological data on the com talkx then we compare them to similar comparison to see how many Target gen actually predict in our result is also Target gen in in the com talkx so for here you can see those numbers here is something like a uh in com talk they only tested like uh the have like 54 Target the BPA and we our result can predict 20 of them as a top 100 Target gen for BPA so those are numbers I mean yeah and after that uh we also checked the uh ac50 from the com tox because from in the com tox they uh they have the bio data so they have the H50 so F50 in to col is like the concentration at which 50 % of the maximum activity of that Gene is observed and so in our result a bigger number means a high possibility the target gen the Target and chemical can interact with each other and for the ac50 is like a lower ac50 means that that Gene is actually very sensitive to this chemical so in that way uh for all of those genes that uh included in our study also in the com talk what we did is like we just use the top 33% as a uh of sc50 let low sc50 you just order everything based on the sc50 and all the our prediction results and then we compare so if the in our result if they have like a higher imputed value and then we check if those ac50 is like a lower so which means um in here something like that yeah so from here you can see uh mostly it's like they have this pattern like the our result have a higher value which also have a lower ac50 in the comptox which is like a very nice result but but in our Uh u in our calculation we didn't have any ac50 information in our data so this is actually a surprising result we didn't expected this but actually for some of them for some of the chemicals actually they are like matching with with each other very well and after this uh we also compared the pathways so uh so Pathways of of the of those Target gen from our result and also the ctd data data uh Target gen so in here what we use is like uh because um we only use the chemicals that have more than 100 significant go term en reached with CDD Target genes in this comparison and for our method we use the top 1,000 Target genes from our prediction then run the divid to find the uh enr the go term then we do a COR ation between the results to see if if the target G from our result can be used to uh finding the similar enrich the goal terms from the real data so you can see uh for I think oh yeah only for this one so the correlation is not significant but for other chemicals so they have like um the significant correlations between each other so which means like our method can the gene that predict from our method can also be used to finding the pathway related to those chemicals and then we zoom into the BPA because BPA is like a hormone related chemical so uh so for here we actually um grab the all the uh hormone R the go terms from our uh results and to see so because those four chemicals you can see the structure they are very similar to each other so we we expect that uh those go terms will be like a very similar to each other but not exactly the same so we can see so most of the go terms of hormone R go terms is actually enriched for all of those four chemicals but there are some like a difference here and then here this comparison is actually uh we overlapped with our uh go significant go terms of those four chemicals and also the uh significant go terms from the uh ctd database then we found the overlap one so the all the over overlap go terms of all of those chemicals it's like a hormone related yeah so which means that our prediction result is not like a go away to other like a we results this is like like a our result can be used to find like a significant go terms um for from those genes and uh uh then there's another like a a result it's like for this Gene gpr1 Gene so in our prediction result we only found this Gene as a tar top Target Gene of the bpb chemical and then we found this this this paper so in this paper the authors found that uh the bpb actually have a uh ninefold binding Infinity than BPA to this Gene but in our result we also have found this Gene as a as a Target Gene top Target gen of BP so which is can so this Pap the result from this paper kind of like support our our results yeah so then uh yeah so so that's all for for the work for this talk and then for the future plans because everything for now it's it's cmmc which is coup The Matrix Matrix completion so even though we have like a different type of the gene similarity and chemical similarity when they when we actually do the calculation we only use three matrices to do the calculation for the Second Step here is like a we can use like a all different type of the chemical Sim and the Gen similarity together as a tensor so which is like a 3D Matrix to do the to do the uh couple the tensor Matrix completion and then after that the third step is actually to do a couple the tensor tensor completion so for here this tensor actually can be because for now everything is just the gene chemical interactions countes there but for in future we can add in the actual diagonal here so to have like a probably we can specificy the the different different Target tissues we can generate the different Target tissue specific interaction interaction Matrix then put them into a a tensor then to do a a tensor completion yeah yeah basically that's all and then uh uh so yeah so this acknowledgement is like my my three Mentor uh Marine Dena and justing and all the co-authors of this paper and this support this project is supported by my9 yeah that's all okay thank you for your nice presentation I'm wondering that uh if you develop your current model dmmc to ctmc or cttc then can you handle the I region lay because most present um models are not handling is well so you mean isopo right yeah yeah for the Gen as form so I mean uh even the structural structurally similar chemicals can have very different biological activity because of the I I mean tier sensors I mean is your model handling the or even Direction uh for now that part of information probably can be used to generate the chemical similarities yeah so after the chemical similarity is fixed so those algorithm is actually not really take that part into the calculation yeah yeah as matri similar [Music] one CH they have function no for here no for here we only use that package to actually it's a a is not using the go term you mean the similarity Matrix right so so for this that package is only calculating the Gen similarities based on how the go term is assigned is not actually have the go term information for the for the data we have there is like for G A and g& B there's a similarity number okay yes yes more yeah they probably have like a similar similar those two G probably have similar more similar yeah yeah that was a patient data right the SEC transcrip for the Matrix I'm sorry which Sor to know how much the G expression for the Matrix that was from paent oh there's no expression data no expression data for here uh uh fix the how do you yeah so the interaction is like a it's just from the database ctd so there's no expression data okay yeah just we just count how many chemical Gene pairs are actually in that database okay yeah yeah yeah so there's no expression yeah no expression just that counts the how many yeah yeah uh C++ yeah I I I also implemented this method in Python but uh with nonp and pandas but it's very slof yeah it's like a it works but yeah but the python is very slow so that's why I I I changeed to C++ but now I'm developing r R based this methods I'm develing r package for this but but the core confirmation calculation is still in C++ I use rcpp to to yeah to do that for the rcpp version uh uh for for Pure C++ uh for smaller like 200 by 400 is like a 3 seconds to the calculation but for the RCP version 200 400 matric it probably took like a 10 seconds yeah for the largest one for here is 10 seconds but for rcpp is like 30 seconds but but it's also that's why the original algorithm is actually in M that is Implement for the drug Target prediction but I'm not a map guy so I don't know that c appications could youlo it to a GPU or faster processing uh probably probably yes but I haven't tried user GPU yeah probably yeah yeah I another few seconds then other questions can
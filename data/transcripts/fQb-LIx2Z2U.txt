all right let's go ahead and get started welcome everybody to the dcmb seminar today's speaker is Dr Yun Lee from UNC Dr y Lee is an associate professor in the department of genetics and biostatistics at the University of North Carolina Chapel Hill she earned her PhD in biostatistics from here the University of Michigan and uh she had a very successful PhD career including the top score on the bio statistics qualifying exam which is quite an accomplishment a rackam fellowship and a dissertation Fellowship she started her position as assistant professor at UNCC immediately after graduation and she's been at Carolina ever since and Yun has published almost 200 peer-reviewed Publications and and was recently named a highly cited researcher by Thompson Reuters and in her research she develops and applies statistical approaches for genomic data including analysis methods for genomewide Association studies chromatin confirmation data and single cell data which I believe she's going to talk about today so Yun thanks very much for speaking with us today and we're excited for your talk thanks so much for the very nice introduction Josh and really appreciate the invitation you know as a Michigan uh alums I always feel extra honored to actually come back to share my research and thanks so much again for the opportunity uh so today you know as Josh uh mentioned I will share with you our recent Endeavors uh in the development of computational tools uh for single cell R seek uh data and as you know uh this is really an exciting highly competitive field uh I'm sure you know many of you have worked on you know such data uh one way or the other uh you know for example I know Josh has several you know seven pieces of work along this line of research uh so the title of my talk today is a clustering example and B effect correction methods for single cell are in seek data so as a title suggests I will talk about two important tasks uh in analyzing single cell and SE data uh clustering and batch effector correction uh for each my team actually has developed two methods and this is actually the first time you know attempt to talk about all four methods in one seminar uh likely a bad idea will see I'll try my best not to delay a dinner and I will deliberately skip some of the slides and uh for some others I'll will quickly scre uh over uh emphasizing only the keyal messages uh so my apologies in advance for those of you you like who try to read the slides carefully um but uh three of the three out of the four piece of work that I'm going to talk about are already published so feel free to read the corresponding papers and talk to me offline I would be more than happy to discuss with you um so uh here we go so uh as a um background uh you know like I'm sorry to interrupt um we're not seeing your slides oh oh I'm very sorry um okay yeah very sorry for [Music] that okay um so escaped the uh I just moveed to the um um background slide now you can see it yep okay good sorry um so as a very brief background uh you know single cell uh RC data empowers us to dive deep into the cellular uh you know heterogenity uh in complex tises and during various biological processes um for those reasons and because of the rapid uh you know technological advances we have been witnessing really explosion uh of single R data uh you know like the first study published you know barely a decade ago uh only started with eight cells and then eight years after in 2017 uh you know like a firm TX genomics alone uh you know it released over 1.3 million uh cells and the volume and the complexity of single cell R data will only explode even further uh with many of the larger scale efforts to create complete uh cell Atlas for both humans and other uh organisms uh so these are all very exciting U but as you know like many of us know analysis of single cell R data U poses many computational challenges and as briefly mentioned the previous SL focus on two and talk to you about our Solutions um so the two areas uh of uh single cell directions that will focus on uh first is like a classing of single cells uh so clustering is an essential step in defining cell types from trans transic profiles uh so the cell types are very important because you know they largely determine uh individual cells identities and functions um so we uh our group has published uh two papers in the past uh two years uh for emble clustering of single cell data so safe clustering and same classroom and the second direction is batch effect correction and it's very well known that batch in fact is a plaguing Asal in many omix data single cell data is no exception as a matter of fact you know as a single cell Technologies evolve so rapidly a lot of times you know we have a single cell RC data generated for multiple batches for example you know over a period of month or even years and using very different capturing uh single cell capturing or Library proposition procedures uh with samples obtained and different experimental protocols um um or data generated by different Labs different technici so all of those can result in unwanted you know batch effect uh that can OB obscure uh biological uh signals uh so for bat fact correction uh you know we have a proposed supervisor Mutual nearest neighbor uh based approaches we published the SM earlier this year and we have a iterative assment and is Method uh that ENT development uh that I will talk to you show some uh preliminary data uh on so as an outline I will cover all four methods uh two for U cluster example and the other tool for um um baty Factor correction and as mentioned I will um you know like focus on the key ideas and also focusing on the first method under each uh of the two series uh so those the first methods are inolved and under lined here uh so let's start with clustering example uh so as mentioned earlier uh clustering is such an important step in analysis of single cell RC data that many method that exist um for example common use method include Surat sc3 cider simler scan p uh uh sensor uh just a name of field and josia actually also have a a very widely used method called lier and provid an rather elegant solution to this cell ENT identification um problem VI transfer learning across multiple data sets um so there are many methods and then uh you may ask why do you even bother with yet another classroom method uh so we actually have very good reasons uh first of all although you know like there are many methods when applied to various data sets uh you know there are you know several method that tend to perform reasonably well but no method is a clear no-brainer type of winner uh so more importantly uh the existing methods uh differ and sometimes rather drastically in their Solutions um so the solutions are measured in terms of both of a cluster or celltime membership for the individual single cells and in terms of the number of um uh um clusters estimated uh so on the right hand uh side of the slide I show you results from Full popular clustering method that see3 cers dis plus K means U on one uh data set and the figure Quantified the similarities of each pair of methods using two Matrix nmi and AI so mi nmi showing on the upper triangle AI showing on the lower uh triangle here so both matrics measure similarity between uh two clustering uh Solutions and both range from zero to one with one indicating complete agreement and zero complete disagreement as you can see from the plot here uh you know this methods tend to agree you know rather badly you know with ar or nmi really range you from like a below even below 02 and to the you know best is only around the0 six and in addition this method tend to vary in their estimates of the number of clusters for example in this data set cider here says okay there are three clusters in this set as three by trust says okay there are 20 clusters um so an example uh has been long recognized for its ability to make a more robust and accurate inference um and has been used a lot in the classroom so-called more Art and Science clustering uh so that's why we decided to uh explore our building and both Solutions uh which uh you know combine strengthens of the existing methods so that's the reason we are doing this uh so we first uh uh build this uh safe uh classing uh algorithm and and here um just here's the overall workflow uh of the method uh we studed the results uh um from four individual uh clustering uh methods so again sc3 fers right uh t plus K means um so um so this is the first step uh so this table here um provides a summary uh of the uh contributing uh methods and we can see that they defer in how they deal with Dropout events and how they perform preclustering quality filtering uh how they quantify uh between cell distance or similarity and also in terms of their methods of choice uh for you know Dimension reduction for clustering per se and for estimating the number of uh clusters in a data set uh so uh you know like I won't go into the details of uh the table but want to point out that all those differences uh in all those aspects are largely responsible for different methods being the best choice for different data sets and also for the same reasons no method is a universal uh best choice across all the data sets uh so again that's why I would build an example so after we obtain uh you know like uh the solutions from uh these contributing methods our safe classroom uh build a uh uh you know like a builds a hyper graph uh so here's the hyper graph for this toy example showing on this slid we have seven different uh single cells and denoted by this XIs here X1 X2 X7 um and then we have four different methods here uh single uh contributing methods so uh the first uh uh method uh uh you know like a clusters uh the single cells into three uh groups or three clusters uh with the first three cells going into the first cluster and the uh the next two cells in the second cluster and the last two cells in the third cluster and similarly for the other three uh you know methods and with those uh you know like a clustering um results um Solutions um from the individual methods again showing four individual methods here and then we'll build this overall hyper graph on the right with the number of rows being the number of single cells so here again there are seven single cells and the number of columns being the sum of the number of clusters from the contributing methods U so in this two example you know the first three methods each uh generates three clusters and then the fourth method gener a two cluster so there's a total 11 hyper edges or 11 columns uh here and then the individual uh value the uh the value in this hyper graph are you know binary uh variables with one indicate okay this cell uh for example here uh this um the cell single cell number four uh is uh class classified into this second cluster of the first cluster method um so um this is how the hyper graph is constructed and after the construction of the hyper graph uh we attempted three different hypergraph partitioning methods uh hgpa mcla cspa which I will describe in a little bit detail um so uh the first and simplest one the hypergraph partitioning algorithm of hgpa um is a a class the single cells again you know indicated by those question oh sorry um so um so um um they are denoted by those axes here again X1 X2 through X7 for the seven uh single cells uh so hgpa clusters uh those single cells uh which is very intuitive and straightforward but this algorithm does not work very well in most of the data set with Benchmark as you will see later uh because this algorithm is very sensitive to unbalance sizes of individual clusters which is very common because there are uh some common cell types with lots of uh single cells that are relatively rare uh you know like a cell types for example you know in brain excited neurons uh you know like oo dundy asite all rather common U but like in contrast like a microa you know like parasite those are relatively uh rare cell types uh so U because of that reason you like hgpa does not really work that well so I'm not skiing the details of how exactly uh this is will uh this is done and we'll focus on this uh meta uh clustering algorithm of mcla um so uh we'll we used the matis uh package uh for the implementation of mcla and mcla is a rather interesting algorithm and it's uh you know like a unlike hgpa it is robust to unbalanced uh cluster sizes because it clusters it you know mcla clusters have edges uh all the columns shown here instead of clustering you know those single cells as hgpa does uh so uh here again you the hyper agis corresponds um the hyper ages correspond to the clusters from the contributing methods and well the uh vert you know uh vertices correspond to the um single cells so mcla clusters have edges well hgpa clusters the vertices so that's the main difference and that's actually uh one of the reason at least we believe mcla works well for uh single cell emble clustering U so and then finally uh we also attempted this cspa will escape the details because it didn't uh seem to work well uh either and also it's uh computationally more uh intensive and than the other two algorithms so finally uh you know like we uh after we get to the final clust example results uh we evaluated the quality using the adjusted rent index which we already showed so I'm showing you some of the detailed formula but again you know this is just a similarity index with one being uh you know like a uh indicating uh full agreeing um uh Solutions and zero meaning uh the two cluster labels completely disagree and we we uh when comparing with the truth uh true cluster labels true cell tab labels uh we prefer uh you know higher values uh oops and so um then we um benchmarked uh our methods uh in um quite a number of data sets we managed to assemble 12 data sets and uh uh they are of uh you know like a different number of clusters uh with them ranging from you know three clusters to more complex uh structure with 14 uh clusters and the number of single cells ranging from below 50 uh to over 30,000 and those data sets also you know cover a wide variety of sequencing Technologies T of orine data units you can see some of them are Quantified by Umi uh some by counts some PKM and the Technologies are very different so we deliberately pick data sets that are more representative uh of VAR uh various you know like aspects of single cell ryn data um so uh and the shown here uh you know like um are the again Aris for the different methods in each of the 12 different data set and from left to right we have H3 cider Disney plus came in the full individual contributing methods and the uh right most is our uh save methods so again for Ari the higher the better uh so you can see across all the data sets uh you know our safe clustering is either the best you know like uh and those cases clear best or you know like uh close to the best there's no data set where it seems to you know like perform very badly in contrast and you know each of the individual method seems to perform uh have one of one or some of dat set where it performs very poorly examp here uh you like here um you know here um things like that um S3 here um so uh it seems uh the by embling uh not very surprisingly it provide a um you know like a robust and accurate uh solution and achieves a uh very good balance uh so this is in terms of the uh cluster membership for individual single cells and we also uh evaluate the result in terms of the estimated number of clusters um so this a scatter plot comparing uh the estim estimated number of clusters to the uh true number of clusters uh in the order again at C3 side and also in corresponding colors um so the last panel maybe Focus only on the last panel which U compares the uh which shows absolute distance uh from the number of cluster uh uh you know like airm the true number of clustering and defined by the uh by the CH Bing papers and and here of course you know like talking about distance to the truth uh the smaller the better and you can see uh you know safe clustering seems to work uh the best um the other three methods seems to work reasonably well I mean although the variation seems to be a bit larger and C3 is worse uh because you know like I skiped the details but if you stared at the table earlier is three when infering number clusters used the distribution called the try Wim dist distribution that tended to end overestimate the number of clusters when you have a larg number of single cells um so yeah so as a quick conclusion um for uh the first method uh we presented a sa clustering which is n supervisor example method uh that uh you know like a provides a fast accurate and also flexible clustering for single hour un data it's has quite robust and accurate uh results across a wide range of real data sets with Benchmark and uh uh it was published last year and the software is freely available VI our uh GitHub um and then um this year we published the same classroom uh so we uh used a mixure model uh to perform this emble task uh so again for this one I will skip quite some slide just focusing on the main idea so the over uh in terms of the uh method workflow it's uh similar to uh our safe classroom and we added a new method called similar uh so skip the details here uh but again you know similar actually differs from other methods as well in terms of how it calculates the distance between Pairs of single cells and it actually use also a different dimension reduction uh technique and and also for clustering for estimating cluster membership and and then uh so this is a part that is uh distinguish uh same classroom from safe classroom uh so instead of hypergraph partitioning methods uh same adopts a multinomial mixture model approach uh so again those I will skip all the statistical uh you know like a heavy slides uh so I'm showing here uh just to show the method details and also you know like just sure I'm not a shot I'm not going to talk about other the for formuls like later in the afternoon um but like uh here I'm just skiing those but like we introduce a hidden variable uh which is the cluster membership in the emble solution of course we don't observe it's what we want to infert and we use uh you know like uh the EM algorithm U to specify the complete data likelihood um after introducing the auxiliary of the Hidden variable C and the e e step and M step are uh specified here uh so again like I said I'm not going to bother with all the uh statistical details is published so you can check out the details oh I'm happy to share the slides um so um compared to Safe classroom added a few more data sets when doing the benchmarking uh increased the total number of data sets to uh 15 again you know a wide range of Technologies you know like a organism of origin you know T show uh number of single cells a similar number of clusters and the uh you know quantification uh units and and just a quick Summer of the results and we added the similar and we also compared with our uh safe uh previous safe methods and uh this uh shows the rank um so and the uh the smaller the better uh so safe basically compared to the other method is a very clear winner with the uh lowest or best rank uh across the uh various methods so again this is talking about the cluster membership of for individual single cells and then we similarly uh look at the estimated number of clusters uh so you can see like uh you know like I didn't show the absolute deviation but like same again even visually you can clearly see like a same uh estimates um uh the number of clusters most closer to uh the truth which is the X AIS here and then uh interesting we also showed one uh you know like a interesting finding based on our uh same clustering results so when we applied uh same cluster into the uh 10x genomics um bbmc prefer blood nuclear uh cells uh we uh discovered a novel uh cluster um so um you know like the the CL uh as some of you know the tax genomics pbmc data have gold or silver standard s type label for each of the single cell or for most of the single cells and then you know like we basically you know look at the cells that are labeled by the 10x as B cell T cell and also as NK cell very interestingly it's for the NK cell by unsupervised clustering ignoring the uh cell type labels provided by the 10x same clustering identified a new cluster which is the red uh here um um you know like a uh separate from the uh the other ink cells labeled by 10x and then we look at the expression of two NK cell marker genes the nkg7 and gnl Y and you know as expected you know like the NK most of the enk cells have a very high expression of those two genes but the new cluster but the cells in the new cluster uh same identified seems to have a rather low you can see you know like the medium for example for the K G2 G7 marker Gene is actually zero uh in this new uh cluster of cells uh so and then uh we look at uh the the cells further so those are the uh single cells in identified in this new uh cluster and look at their um profiles so each row is a gene and we group the gene according to uh marker genes of each of the three cell types so the first the top uh genes are marker genes for B cells and the M genes are marker genes for regulatory T cells and the bottom genes are marker genes for NK cells and then on the left we're showing you know like a cells in quote unquote normal clusters uh meaning that and supervised clustering firm same uh generated uh you know like or cluster them um you know like a uh in concordance with their true labels so like those cells are clustered separately from those cells and from those cells so those B cells um seem to express largely you know like the B cell marker genes but not of the other uh you know like cell type marker jeans and similarly for T cells and similarly for the regular quote quote normal andk cells again those correspond to those blue uh cell uh green cells here but interesting if you look at the new uh the single cells in the new cluster and they seem roughly fall into like a uh groups uh like this the first groups left parts I mean some of them express some of the enk marker genes but like definitely not as much as those coo normal enk cells but you can see like they also Express the regular Tre T Cell genes and in a sense you know much more Express those much more than what they should have expressed and then for the second group I mean it's sort of like they don't express any of the marker any group marker genes very well and then last group you know express some of the enk cell markers but they also Express you know some you know like a regulatory tea but not as profound as in the first group so this seems very interesting I mean of course we haven't done any experiment to verify you know like a morphological or functionally what they are doing uh but like this is you know how I I think you know like a single cell clustering and those single cell data are useful uh for uh to generate you know new Mech uh new you know hypothesis uh for experimental testing uh so you know like um so here's the stop here for the uh same uh classroom uh so again you know like we used a more uh you know like a statistical more elegant way uh to perform clustering in B this mixture uh model based approach and it seems to work quite well and uh you know compared to uh same class uh you know like the the only drawback I would say is the computational cost is higher uh for same classroom than for safe classroom uh so again the work is published earlier this year with nuclear acid research and the software is freely available um so now I'm going to um you know like uh switch gears and talk about the second uh uh you know like a parts uh of um um the on the bat Factor correction um um so I mean if people have uh you know quick questions I'm happy to take but if not I will just keep going um so as we know you know like the presence of a batch effect is really prevalent and the batch effect are also known as you know technical biases across different samples and they pose great challenges uh when we uh you know integrate data uh across batches uh especially when the data are generated using different experimental protocols uh or from different uh uh Labs uh so Pat effect actually will not only uh obscure the true underlining U biology uh but it can also generate lots of false U positive findings um so uh in this toy example uh you know there are two batches batch one batch two uh and each of them with three different uh uh cell types uh indicated by the C1 C2 see3 here uh so again you know like here the different colors indicate different batches red is from batch one and science from batch two and the different clusters are uh are in those different ovals and you can see within each batch uh the the different sell types seems to Cluster rather nicely you know like the ovals are largely separated from each other however you know like when we naively you know like put the uh cells together although you know those cell types still seem to you know cluster uh together uh but like a you know like a if you say draw a line here uh the variation is driven more by Stell type by the color than by um sorry driven more by batch um indicated by power than by U cell types uh so this simple cuton illustration uh you know shows the importance of a performing batch effect uh correction U so U because of uh uh you know like uh for for those reasons you know like B fact uh you know like a correction has been realized to be super important and has become really an uh very essential PR prepressing step uh when performing analysis integrating single cell RC data across Badges and there's a a recently developed a bad effect correction strategy that leverages information of Mutual nearest neighbors or mnns U so this m&n or Mutual nearest neighbor based strategy has been adopted both by suret version three and another method proposed uh by uh ha um at all uh in a meth called am and mut neighbor um and so so this is a um you know like a a strategy that's realized that has been recently recognized for its potential um in terms of B effect correction so the idea of uh SM sorry M mut neighbor based approach is to identify uh you know like U uh mut neighbors or cross batches so in a cartoon illustration here for example you know like in batch one we have three uh cell types here and in badge two will have the same three cell types and yet a fourth uh cell type and M and basically uh tries to identify Mutual neighbors uh you know across the badges okay and use those information for batch effect correction and at the end uh you know like a generat a batch corrected uh gene expression profiles uh based on those Mutual near Mutual near neighbors uh so this is a you know very sensible approach um but like this um this approach makes a very important or rather strong assumption that the batch effect is actually orthogonal uh to biological uh differences uh or at a very minimum this strategy requires the variation due to batch effect are much smaller than those due to biological effects um however you know this assumption is not always true in real data I I'll show you some example in in quite a few of our own real data sets uh you know like a uh especially like when those different batches uh were produced using very different experimental protocols uh for example you know I worked with a Duke investigator who used you know like a smart seek for one batch and then the next uh you know for the second batch like a more than a year apart and also say when they are from different Labs um so and under the nonorthogonal scenario uh you know such a global uh Mutual near neighbor uh searching strategy actually may mismatch single cells from different uh you know clusters uh across the batches uh so as sh in the cartoon illustration here in batch one you know the cells in cluster two are mismatched uh to the cells uh belonging to Cluster one uh in in badge two uh so this is because you know like here's the bad effect Dimension and and those are the real biological effect effect when they are misaligned um and when the biolog when the batch effect is you know comparable to the biological effects you may face uh this type of uh dilemma and this mismatch U mut uh near neighbors with apparent lead to undesired correction results uh so to uh to solve this problem to accommodate this potential uh Asal uh we present SMN so supervised U Mutual neighbor uh method uh that directly incorporates the cell type information for cell type of sorry for batching Factor correction and with the help of the uh you know cell type information smnm restricts the uh mnn search within the same sell type instead of a performing Global search ignoring uh the cell type labels of course you know like a lot of time we don't have the cell type information handy um but with uh you know like clustering methods like the same safe and all the individual methods I mentioned in the first part of my talk uh those cell types can be inferred uh via classroom method there's many choices actually and here's a framework of SMN uh we started with the you know G expression uh matrices uh uh here across the different Badges and we first you know perform a single cell clustering uh within each batch and then to obtain uh you know like a uh accurate matching of the cluster labels or cross batches we have this cluster harmonization uh step here and I'm not going to the details uh but we have this step and then afterwards and we'll find uh Mutual neighbors within the corresponding clusters that's where the supervisor part uh KES in and with that you know we'll uh uh compute the Single Cell specific correction Vector based on which the corrected expression matrices of the two batches will be derived um so uh you know like we uh first perform the simulation studies uh to evaluate the performance of our SMN uh you know method in contrast to uh to other method particularly the original the the MN method which does not uh uh use um cell type uh information and in our uh so uh so we largely adopted the framework uh of simulation presented in the MN method uh but like we we actually all uh take a you know like a different approach where you know we introduced the batch effect uh we introduced the batch effect in the low dimensional biological space um so the low dimensional biological space in particular the three component uh ging uh um mixture uh so as shown here um so and then uh you know like we uh we project that into the high dimensional uh space MIM making the um you know like thousands or tens of thousands of genes uh in real single cell R data set so the p is a projection uh Matrix um and then uh like I said we introduce the batch effect in the lower dimensional space and then uh so here showing simulation data is uh you know like in orthogonal case uh where you know like um M and um actually you know like a conceptually should perform very similarly uh to uh SMN and and here you know we're showing the uh forbus Norm uh so the uh the smaller the better and you can see even in the orthogonal case SMN seems to do uh to do uh also uh you know slightly better uh uh but okay you know reasonably close but like uh for the nonorthogonal case it's clear like uh you know like SM and and um outperforms u m and by leveraging the um the cell type label information and then we also Benchmark the uh method in uh several real data sets uh it's summarized here uh different you know like a technical platforms different number of single cells and uh uh different uh show organism of origin um and then showing here is you know uh one data this is a u u umap plot uh for um for the um let's see I think it's for the pbmc yeah for the pbmc um data set um and then this is incorrect results so we have the three different uh cell types uh the common myo par genitor uh cells uh which can be differentiated into one of the two linear ages either granular micras paren cells or microsite uh rid progenitor cells so those are the uh sublineages Offspring lineages from CMP and you can see you like when we do an sorry and the solid field are batch one and the uh Enfield Fields uh the those unfield triangles are from badge two and as you see you know like uh in uncorrected results it's you know there's there clear bad effects you know like with the batch one cells really at the middle and then the B two cells at the outside Circle and uh you know like when M and after M correction you can clearly see you know like the uh the GMP cells and and the CMP FS are clustered together they are kind of mix so you cannot no longer seate them so does a reasonable uh job but like there's lot of uh mixing of the cell types lier actually performs reasonable as well it's just in a pretty weird shape um and The SMN visually seems to performs uh the best and then uh we used the you know like uh the from the manova 2way manova F statistic to quantify uh the the performance so for that it basically measures the within uh cell type across bades um the variation over the overall uh variation uh so here you know like the smaller the better because we wanted the uh cells from the same cell type regardless of which badge to be tightly cluster and separate from the other uh cells um so you know M SMN seems to uh perform uh the best uh on on this data set and just showing as a example and then uh you know like uh um the the date using uh you know like the M SMN U corrected results we also seem to identify uh uh differentially expressed genes that are truly uh you know like a um more representative or retain U biological uh features um pertaining to their uh genomic function uh for example showing here you know like a uh you know SMN and mnn seems to uh you know identify uh DG genes um with quite some overlap but there are some you know SMN specific dgs and some of the M specific uh differentially expressed genes and the go term analysis uh you know for the genes that are uh overexpressed in uh granular site you know microage uh you know progenitor cells are are enriched with the immune regulation so that makes uh you know good sense uh because this micro car it which eventually differentiate into plate Android differentiate into red blood cells so they are less involved in immune related functions well this granular s and you know neutral FS eal FS uh you know like a basal fs and also microf fases monocytes uh those are apparently you know involved in immune regulation and similarly for those genes different you know Upp regulated me versus GMP uh I didn't show the results for the Emma and specific genes but like it's less obvious terms that come up from the analysis so it's you know like a relatively small set of genes but like a go terms that came out seem to make a lot of sense uh so in the interest of time I will skip this slide we also look at the reproducibility uh because a lot of times you know like we don't know which ones are the truly uh differentially expressed genes so we look at the you know reproducibility uh identified U from the two batches and SM seems to work uh better I skip this slide so as a quick summary or ASN is a batch correction method for single cell ear SE data it's uh you know explicitly considers a cell type label information uh to help identify MERS neighbors um and then are more uh you know like a powerful in terms of extract uh the desired neighbors uh within the same cell type uh So based on the benchmarking real data sets it seems M and you know batter makes is cells of all cell types across multiple bages and also enhances detection of differentially expressed genes uh between different cell types and seems to to more accurately retains uh or recovers cell structures uh so it's published uh you know earlier this year in brief things in BIO informatics and again software is freely available uh so lastly I will probably spend you know two or three minutes on our ongoing work um it's the iterative assment refinement method for bat Factor correction uh so uh you know uh the one of the issues with MMA or with uh you know our SM it's like it it searches for mut Neighbors from the original expression uh matrices which may not be accurate particular when the batch effect is large uh so the alterative M SMN basically searches the uh mnn on the corrected data and then of course you know like it's iterative because you like we search mnn and then correct the data and then based on the correct dat data we identify uh new sets of m&n and here showing again it's log F statistics the lower the better and we show you know for different data sets when uh you know like the best uh U performance uh is achieved so for some of the data set you know particularly for this one which is you know um it's the most complex among uh the five attempted it needs like three rounds of U um MN search to reach the best performance and you can see actually the performance is uh much better than just using one round of M search um so you know we applied the data to sever you know like a real data sets and uh um so um skiing the uh the workflow and uh uh we apply the uh the the data to our cardiac uh single cell AR syn data where you know like we have uh two uh batches uh again the same uh you know like a legend you know like a solid from one batch and open from another batch and the different colors in indicate different uh cell types um uh so you know like when applying you know like uh and ISM and and you know like uh uh you can see you know like the sales seem to after you know s it it seems uh to Cluster reasonably well but like if you uh look at the cluster uh you know like batch membership you see you know like uh there's uh you know those places where so seems to not merging the sales well in contrast you know uh SM and seems to merge data from the two batches reasonably well uh so visually it's better mixing and then in terms of the uh qu quantitatively we again use the F statistic is substantially reduced uh F measure uh so again like I said we Quantified in several real data sets and iterative um assignment seems to perform uh you know very very well and then uh taking the data we also uh you know like a identify differentially expressed genes and the the gene um so compared with Surat uh you know like the genes that uh uh the DG identified by both methods of course they show very strong again this is cardiac single cell so we look at the cardiio Mite versus endothelial cells and uh um the two different types of cardial Mite it's not really two different types just a different in their mitochondria percentage um you know um anyways so the uh the common genes show very strong you know cell type specificity you know like with the cardiac specific genes or Express you know like a uh genes that are marker genes or are very consistently highly expressed in cardum Mite and in contrast you know uh the genes that are specific are specifically identified by uh iterative ISM and seems to work pretty well I mean like it's a little bit noisier than uh the shared genes but reasonably well uh in contrast if you look at the if you look at the Sur specific me uh you know only about 70% of those are found to be upregulated in cm in contrast to ours close to uh 95% and I would uh you know Point your attention to this particular like cry a gen uh which way uh you know like a followed up by imuno hiso C IHC validation and we performed the you IHC standing U for this CB a uh cry a gen that we identified uh based on I and um corrected results and also two marker genes one for cardioide the other for endothelial cells uh so this is the cardioide marker Gene this is an endothelial marker and this one is the uh the gene that we are trying to test the cryab and you can clearly see like this is indeed you know like a cardom myoy specific Gene um so um you know like how we U basically validated when results specifically identified by uh after ASM and correction U so in the interest of time I will skip this one as well and uh so as a summary you know like we updated this our previous MN uh supervised M uh approach uh to in into a iterative manner that seems to uh even further improve the performance so as a final words uh you know this is really a very exciting area of research and there's still lots of room for improvement for example you know like uh how to scill up with millions of single cells I think Josh has some very exciting work along this direction how to deal with multiple subjects U we have published just recently to published another paper uh that performs u a multi sample uh you know differential uh expression treating you know like the single cells for multiple individuals as repeated measures um and also how to do itative uh you know like analysis uh when incorporating other who makes data and Jos liger actually does a good job along this line of research uh so with that I'd like to thank many people you know contributed to the work uh specifically young uh former posto uh now faculty member at UNCC and a former student Ruth and current student G and lots of collaborators at UNC and other places and also uh folks in my lab and thank you very much for your attention great than for a great talk and uh please feel free to ask questions now either in the chat or you can unmute yourself and ask your question directly and I see we already have a question in the chat here okay see all right I'll go ahead and read the question in the chat from Dana King thank you for a compelling talk perhaps this is out of scope but I'm curious if simulations or test data sets for mnn or is mnn also investigate the impact of pre-filtering the data how much should we be considering aspects like percent mitochondrial Gene for our individual data sets especially if phenotypes like cell death can have technical sources from generation of single cell samples or be biologically relevant such as during developmental defects yeah this is excellent question so the short answer is no we have not uh uh you know like used the simulation in a sense very hard design simulations uh to answer uh you know like a questions of the impact of uh prefiltering uh of the data or different levels of QC on the data um but like particularly for our uh same and safe classroom uh in our software implementation we you know explicitly allow uh you know like users to trick uh you know like a various uh um you know like a um filtering criteria like the number of uh you transcripts of genes expressed in the in the cell to perform cell level filtering and also perent of mitochondrial Gene and in a sense you know like one of the reasons you know like I motivate motivated the development of this emble methods using by you know talking about the discrepancy of existing method but the other thing uh actually when I started Design This is like this inable method can totally be also applied uh to you know like a different filtering uh of the of the raw data and you can build example solutions from those you know like a various uh you know like um uh level of um QC on the on the data as well not to say like we should take take cells with only 20y genes expressed uh but there's a reasonable you know range whether you you know allow you know 5% mitochondrial genes or whether you allow 10% both are very reasonable and actually for uh you know like our cardiac single cell you may notice like as I explained quickly our cm1 and cm2 differ uh are different in terms of the percentage of mitochondria genes and we initially used for the cm2 uh where we actually used VAR stringent can remember 5% or 1% mitochondrial Gene maximum uh but then you know like since mides are actually very you know like a energy uh dependent so it's possible that you know like uh the they do Express a larger percentage of Mond so we ended up including um some more celles um uh by uh you know like uh losen the the the criteria um yeah this is a good question but like um no we haven't done any systematic uh evaluation of um of those prefiltering of the data any other questions for you I actually have a question um so one of the real challenges here is um determining what ground truth is when you're clustering cells and also experimentally validating those clusters do you have any thoughts about what are the best ways to find these gold standard labels or or validate your results experimentally yeah that that's X on the and actually you know like that's one of the places we struggled a lot with uh you know like with both manuscript I mean you know like even if we know the truth let's you know like in a lot of cases we're talking about gold standard or silver standard you know like based on marker jeans or based on you know fact sorting if we started with uh you know like a cells um uh where we sort of know uh which uh cell type they they come from uh but a lot of time even with you know say if we have a uh the true uh you know like uh uh uh Expressions you know not considering all the noise data from single cell R SE uh you know like if we apply you know classroom you know for example you know hierarchical there's really you know a line we need to draw are we talking about just helper T cells are we talking about you know like th you know 17 and th you know there's different types of helper T cells and there's different going up there's different you know tea cells there different immune cells so you know like whether uh you know for the pbmc data set I didn't you know like talk too much but like we have you know like a challenging case where we're looking at three different types of t- cells and we have a sample case we're just looking at you know B cell T cell and and NK cells so in a sense you know like where you draw the lines are you looking at the major uh you know cell types or are you making looking at subtypes I think that makes um a big difference so I I think uh you know like to answer your question more directly um I so yeah so I'm talking about those uh so um um so I you know there there are several ways first is you know like we uh you know should be a bit open-minded uh to accept you know like a silver standard or even you know like a you know bronze standard uh truth um so that you know we can have a rough idea uh regarding you know how well those method perform and but like we should also so you know like the the example I mentioned that in same classroom if we identify interesting um clusters so um seems simulate NE biology I think experimental followup would be uh useful and then similarly for the ismn you know we find this cry a gene that we didn't know uh as say you know like a cardiy specific Gene um so yeah so I think this uh single cell RC I mean has been really used more for hypothesis is generating uh rather than you know confirming um so so I think uh you know like we need to be careful use as much existing data uh to make sure that we don't dive into you know like expensive experiments uh without you know like a first checking to see uh the results might be consistent or you know conflicting what we know uh but like you know if if there's not enough data which is a lot of time the case like we we are observing you know like at least consistent uh you know evidences for multiple single cell RC data sets I think it's where you know like we prioritize our uh hypothesis generated from those single cell data we go from there um so I don't know I being a hand away I'm not sure directly answer your question yeah those are good thoughts it's definitely a hard a challenging aspect of single cell analysis yeah great well we are out of time so thanks again Yun for a great talk thank you thank you so much and yeah and so everybody hope to see many of you back next week for next week's seminar take care bye